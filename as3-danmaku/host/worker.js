import worker from '@jsc/danmaku/worker-loader/inline';

// 运行在work中的弹幕解析器，须提前构建
export default function () {
  return worker(`(()=>{var zt=Object.defineProperty;var Te=(n,t,e)=>t in n?zt(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var a=(n,t)=>zt(n,"name",{value:t,configurable:!0});var o=(n,t,e)=>(Te(n,typeof t!="symbol"?t+"":t,e),e);var mt=class{channels={};constructor(){self.addEventListener("message",t=>{if(t)try{let e=JSON.parse(t.data);e.hasOwnProperty("channel")&&typeof e.channel=="string"?this.dispatchMessage(e):h(e,"warn")}catch(e){h(e,"err")}})}dispatchMessage(t){t.channel in this.channels?this.channels[t.channel]?.listeners.forEach(e=>{try{e(t.payload)}catch(r){r.stack?h(r.stack?.toString(),"err"):h(r.toString(),"err")}}):h('Got message on channel "'+t.channel+'" but channel does not exist.',"warn")}listChannels=()=>{let t={};for(let e in this.channels)t[e]={max:this.channels[e].max,listeners:this.channels[e].listeners.length};return t};deleteChannel=(t,e)=>t in this.channels?e||this.channels[t].auth?e===this.channels[t].auth?(delete this.channels[t],!0):!1:(delete this.channels[t],!0):!0;createChannel=(t,e,r)=>t in this.channels?!1:(this.channels[t]={max:e||0,auth:r,listeners:[]},!0);addListenerChannel=(t,e)=>(t in this.channels||(this.channels[t]={max:0,listeners:[]}),this.channels[t].max>0&&this.channels[t].listeners.length>=this.channels[t].max?!1:(this.channels[t].listeners.push(e),!0))};a(mt,"OOAPI");var Q=new mt;function h(n,t){self.postMessage(JSON.stringify({channel:"",obj:n,mode:t||"log"}))}a(h,"__trace");function jt(n,t,e){self.postMessage(JSON.stringify({channel:n,payload:t,callback:!0})),Q.addListenerChannel(n,e)}a(jt,"__channel");function A(n,t){Q.addListenerChannel(n,t)}a(A,"__schannel");function g(n,t){self.postMessage(JSON.stringify({channel:n,payload:t,callback:!1}))}a(g,"__pchannel");function D(n,t,e){self.postMessage(JSON.stringify({channel:n,auth:t,payload:e,callback:!1}))}a(D,"__achannel");var q=class{static xorshift128p(){var t=this._rngState[1],e=this._rngState[0];this._rngState[0]=t,e^=e<<23,e^=e>>17,e^=t,e^=t>>26,this._rngState[1]=e}static random(t=16){if(t===void 0&&(t=16),t>32)throw new Error("NotCrypto.random expects 32 bits or less");if(Math&&Math.random){for(var e=0,r=0;r<t;r++)e=(e<<1)+(Math.random()<.5?0:1);return e}else return this.fallbackRandom(Date.now()%1024,t)}static fallbackRandom(t,e=16){if(e===void 0&&(e=16),e>32)throw new Error("NotCrypto.fallbackRandom expects 32 bits or less");for(var r=0;r<t;r++)this.xorshift128p();for(var i=0,r=0;r<e;r++)i=(i<<1)+1;return this._rngState[0]+this._rngState[1]&i}static toHex(t,e){if(e===void 0&&(e=0),e<=0)return t.toString(16);for(var r=t.toString(16);r.length<e;)r="0"+r;return r}};a(q,"NotCrypto"),o(q,"_rngState",[Math.floor(Date.now()/1024)%1024,Date.now()%1024]);var H=class{name;listeners={};constructor(t){if(t.slice(0,2)!=="__")throw new Error("MetaObject names must start with two underscores.");this.name=t}addEventListener(t,e,r=!1,i=0){t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push(e)}removeEventListener(t,e,r=!1){if(!(t in this.listeners))return;let i=this.listeners[t].indexOf(e);i>=0&&this.listeners[t].splice(i,1)}hasEventListener(t){return t in this.listeners&&this.listeners[t].length>0}dispatchEvent(t,e){if(t in this.listeners)for(let r=0;r<this.listeners[t].length;r++)this.listeners[t][r](e)}getId(){return this.name}serialize(){return{class:this.name}}unload(){throw new Error("Meta objects should not be unloaded!")}};a(H,"MetaObject");var pt={};function Rt(n,t){jt("Runtime:RequestPermission",{name:n},e=>{e===!0?pt[n]=!0:pt[n]=!1,typeof t=="function"&&t(e)})}a(Rt,"requestPermission");function Vt(n){return!!(pt.hasOwnProperty(n)&&pt[n])}a(Vt,"hasPermission");function Ut(n,t,e){jt("Runtime:PrivilegedAPI",{method:"openWindow",params:[n,t]},function(r){e?.({moveTo:function(s,l){g("Runtime:PrivilegedAPI",{method:"window",params:[r,"moveTo",[s,l]]})},resizeTo:function(s,l){g("Runtime:PrivilegedAPI",{method:"window",params:[r,"resizeTo",[s,l]]})},focus:function(){g("Runtime:PrivilegedAPI",{method:"window",params:[r,"focus"]})},close:function(){g("Runtime:PrivilegedAPI",{method:"window",params:[r,"close"]})}})})}a(Ut,"openWindow");function Lt(n,t){g("Runtime:PrivilegedAPI",{method:"injectStyle",params:[n,t]})}a(Lt,"injectStyle");function Gt(){h("Runtime.privilegedCode not available.","warn")}a(Gt,"privilegedCode");var rt=class{managedElements={};_registerElement(t,e){this.managedElements[t]=e}clearTimer(){c.getTimer().clearAll("interval")}clearEl(){h("ScriptManager.clearEl may not be properly implemented.","warn"),c.clear()}clearTrigger(){h("ScriptManager.clearTrigger not implemented.","warn")}pushEl(t){h("ScriptManager.pushEl is not properly implemented.","warn"),t.motionManager&&t.motionManager.start(),t.visible=!0}popEl(t){h("ScriptManager.popEl is not properly implemented.","warn"),t.motionManager&&t.motionManager.play(),t.visible=!1}pushTimer(t){h("ScriptManager.pushTimer not implemented.","warn")}popTimer(t){h("ScriptManager.popTimer not implemented.","warn")}toString(){return"[scriptManager ScriptManager]"}};a(rt,"ScriptManager");var Nt={js:["*"],Runtime:["*","openWindow","injectStyle"],Display:["*"],Player:["*"],Tween:["*"],Utils:["*"]};function Yt(n,t="*"){if(Nt.hasOwnProperty(n)){if(Nt[n].indexOf(t)>=0)return!0}else return!1;return!1}a(Yt,"supports");function Xt(n,t){n==="libBitmap"?t(null,{type:"noop"}):t(new Error("Could not load unknown library ["+n+"]"),null)}a(Xt,"requestLibrary");var it=class{constructor(t,e,r,i){this.type=t;this.dur=e;this.key=r;this.callback=i}get ttl(){return this.dur}set ttl(t){this.dur=t}};a(it,"RuntimeTimer");var nt=class{constructor(t=10){this.precision=t}timer=-1;timers=[];lastToken=0;key=0;set isRunning(t){t==!1?this.stop():this.start()}get isRunning(){return this.timer>-1}start(){this.timer<0&&(this.lastToken=Date.now(),this.timer=setInterval(()=>{let t=Date.now()-this.lastToken;for(let e=0;e<this.timers.length;e++){let r=this.timers[e];if(r.type==="timeout"){if(r.ttl-=t,r.ttl<=0){try{r.callback()}catch(i){h(i.stack?.toString(),"err")}this.timers.splice(e,1),e--}}else if(r.type==="interval"&&(r.ttl-=t,r.ttl<=0)){try{r.callback()}catch(i){h(i.stack?.toString(),"err")}r.ttl+=r.dur}}this.lastToken=Date.now()},this.precision))}stop(){this.timer>-1&&(clearInterval(this.timer),this.timer=-1)}setInterval(t,e){let r=this.key++;return this.timers.push(new it("interval",e,r,t)),r}setTimeout(t,e){let r=this.key++;return this.timers.push(new it("timeout",e,r,t)),r}clearInterval(t){for(let e=0;e<this.timers.length;e++)if(this.timers[e].type==="interval"&&this.timers[e].key===t){this.timers.splice(e,1);return}}clearTimeout(t){for(let e=0;e<this.timers.length;e++)if(this.timers[e].type==="timeout"&&this.timers[e].key===t){this.timers.splice(e,1);return}}clearAll(t="all"){t==="timer"?this.timers=this.timers.filter(e=>e.type!=="timer"):t==="interval"?this.timers=this.timers.filter(e=>e.type!=="interval"):this.timers=[]}};a(nt,"TimerRuntime");var E=class{constructor(t,e=0){this.delay=t;this.repeatCount=e}microtime=0;timer=-1;listeners=[];complete=[];currentCount=0;set isRunning(t){h("Timer.isRunning is read-only","warn")}get isRunning(){return this.timer>=0}start(){if(!this.isRunning){let t=Date.now(),e=this;this.timer=setInterval(()=>{let r=Date.now()-t;e.microtime+=r,e.microtime>e.delay&&(e.microtime-=e.delay,e.currentCount++,e.dispatchEvent("timer")),t=Date.now(),e.repeatCount>0&&e.repeatCount<=e.currentCount&&(e.stop(),e.dispatchEvent("timerComplete"))},20)}}stop(){this.isRunning&&(clearInterval(this.timer),this.timer=-1)}reset(){this.stop(),this.currentCount=0,this.microtime=0}addEventListener(t,e){t==="timer"?this.listeners.push(e):t==="timerComplete"&&this.complete.push(e)}dispatchEvent(t){if(t==="timer")for(let e=0;e<this.listeners.length;e++)this.listeners[e]();else if(t==="timerComplete")for(let e=0;e<this.complete.length;e++)this.complete[e]()}};a(E,"Timer");var B=class{constructor(t=()=>Date.now()){this.clock=t;this.reset()}lastTime=0;get elapsed(){return this.clock()-this.lastTime}reset(){this.lastTime=this.clock()}};a(B,"TimeKeeper");var tt=class{static dispatchEvent(t,e,r){let i=this.registeredObjects[t];typeof i=="object"&&i.dispatchEvent&&i.dispatchEvent(e,r)}static hasObject(t){return this.registeredObjects.hasOwnProperty(t)&&this.registeredObjects[t]!==null}static getObject(t){return this.registeredObjects[t]}static registerObject(t){if(!t.getId){h("Cannot register object without getId method.","warn");return}if(tt.hasObject(t.getId())){h("Attempted to re-register object or id collision @ "+t.getId(),"warn");return}else{this.registeredObjects[t.getId()]=t,g("Runtime:RegisterObject",{id:t.getId(),data:t.serialize()}),A("object::("+t.getId()+")",e=>{e.hasOwnProperty("type")&&e.type==="event"&&this.dispatchEvent(t.getId(),e.event,e.data)}),this.objCount++;return}}static eregisterObject(t){let e=t.getId();this.deregisterObjectById(e)}static deregisterObjectById(t){if(tt.hasObject(t)){if(t.substr(0,2)==="__"){h("Runtime.deregisterObject cannot de-register a MetaObject","warn");return}g("Runtime:DeregisterObject",{id:t}),typeof this.registeredObjects[t].unload=="function"&&this.registeredObjects[t].unload(),this.registeredObjects[t]=null,delete this.registeredObjects[t]}}static _makeId(t="obj"){return t+":"+Date.now()+"|"+q.random(16)+":"+this.objCount}static generateId(t="obj"){let e=this._makeId(t);for(;this.hasObject(e);)e=this._makeId(t);return e}static reset(){for(let t in this.registeredObjects)t.substr(0,2)!=="__"&&this.deregisterObjectById(t)}static clear(){for(let t in this.registeredObjects)t.substr(0,2)!=="__"&&typeof this.registeredObjects[t].unload=="function"&&this.registeredObjects[t].unload()}static crash(){h("Runtime.crash() : Manual crash","fatal")}static exit(){D("::worker:state","worker","terminated"),self.close()}static alert(t){D("Runtime::alert","::Runtime",t)}static getTimer(){return this.masterTimer}static updateFrameRate(t){if(t>60||t<0){h("Frame rate should be in the range (0, 60]","warn");return}if(t===0){this.internalTimer.stop();return}this.internalTimer.stop(),this.internalTimer=new E(Math.floor(1e3/t)),this.internalTimer.addEventListener("timer",this.enterFrameDispatcher),this.internalTimer.start()}},c=tt;a(c,"Runtime"),o(c,"NotCrypto",q),o(c,"Timer",E),o(c,"TimeKeeper",B),o(c,"_defaultScriptManager",new rt),o(c,"requestPermission",Rt),o(c,"hasPermission",Vt),o(c,"openWindow",Ut),o(c,"injectStyle",Lt),o(c,"privilegedCode",Gt),o(c,"supports",Yt),o(c,"requestLibrary",Xt),o(c,"objCount",0),o(c,"registeredObjects",{__self:new H("__self"),__player:new H("__player"),__root:new H("__root")}),o(c,"masterTimer",new nt),o(c,"internalTimer",new E(40)),o(c,"enterFrameDispatcher",()=>{for(let t in tt.registeredObjects)if(!(t.substring(0,2)==="__"&&t!=="__root"))try{tt.registeredObjects[t].dispatchEvent("enterFrame")}catch{}});c.masterTimer.start();c.internalTimer.start();c.internalTimer.addEventListener("timer",c.enterFrameDispatcher);var j=class extends Array{_readPosition=0;constructor(...t){super(...t);try{Object.setPrototypeOf(this,j.prototype)}catch{}}get bytesAvailable(){return this.length-this._readPosition}set bytesAvailable(t){h("ByteArray.bytesAvailable is read-only","warn")}get position(){return this._readPosition}set position(t){this._readPosition=t}clear(){this.length=0,this._readPosition=0}compress(t="zlib"){h("ByteArray.compress["+t+"] not implemented","warn"),this._readPosition=0}uncompress(t="zlib"){h("ByteArray.uncompress["+t+"] not implemented","warn"),this._readPosition=0}deflate(){h("ByteArray.deflate not implemented","warn")}inflate(){h("ByteArray.inflate not implemented","warn")}readUTFBytes(t){let e=this.slice(this._readPosition,t);return this._readPosition+=Math.min(t,this.length-this._readPosition),e.reduce((r,i)=>(r+=String.fromCharCode(i),r),"")}readUnsignedByte(){return this[this._readPosition]&255}readUnsignedShort(){let t=this.readUnsignedByte(),e=this.readUnsignedByte();return(t<<8)+e&65535}readUnsignedInt(){let t=this.readUnsignedByte(),e=this.readUnsignedByte(),r=this.readUnsignedByte(),i=this.readUnsignedByte();return(t<<24)+(e<<16)+(r<<8)+i&4294967295}readByte(){return this.readUnsignedByte()-128}readShort(){return this.readUnsignedShort()-32767}readBoolean(){return this.readUnsignedByte()!==0}readFloat(){let t=this.readUnsignedInt(),e=t&2147483648?-1:1,r=t>>23&255,i=t&8388607;switch(e){case 0:break;case 255:return r?NaN:i>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;default:return e-=127,r+=8388608,i*(r/8388608)*Math.pow(2,e)}}writeByte(t){this.push(t&255)}writeBytes(t,e=0,r=0){for(let i=e;i<Math.min(t.length-e,r);i++)this.writeByte(t[i])}writeUTFBytes(t){let e=unescape(encodeURIComponent(t));for(let r=0;r<t.length;r++)this.push(e.charCodeAt(r))}clone(){let t=new j;return this.forEach(function(e){t.push(e)}),t}};a(j,"ByteArray");var x=class{constructor(t=0,e=0){this.x=t;this.y=e}set length(t){h("Point.length is read-only","err")}get length(){return Math.sqrt(this.x*this.x+this.y*this.y)}add(t){return new x(t.x+this.x,t.y+this.y)}subtract(t){return new x(this.x-t.x,this.y-t.y)}static interpolate(t,e,r){return new x((e.x-t.x)*r+t.x,(e.y-t.y)*r+t.y)}offset(t,e){this.x+=t,this.y+=e}normalize(t){let e=t/this.length;this.x*=e,this.y*=e}static polar(t,e){return new x(t*Math.cos(e),t*Math.sin(e))}setTo(t,e){this.x=t,this.y=e}equals(t){return t.x===this.x&&t.y===this.y}toString(){return"(x="+this.x+", y="+this.y+")"}clone(){return new x(this.x,this.y)}};a(x,"Point");var C=class{_data;constructor(t=1,e=0,r=0,i=1,s=0,l=0){this._data=[t,r,s,e,i,l,0,0,1]}dotProduct(t){if(t.length<9)throw new Error("Matrix dot product expects a 3x3 Matrix");let e=[0,0,0,0,0,0,0,0,0];for(let r=0;r<3;r++)for(let i=0;i<3;i++)for(let s=0;s<3;s++)e[r*3+i]+=this._data[r*3+s]*t[s*3+i];return e}setTo(t=1,e=0,r=0,i=1,s=0,l=0){this._data=[t,r,s,e,i,l,0,0,1]}translate(t,e){this._data[2]+=t,this._data[5]+=e}rotate(t){this._data=this.dotProduct([Math.cos(t),-Math.sin(t),0,Math.sin(t),Math.cos(t),0,0,0,1])}scale(t,e){this._data=this.dotProduct([t,0,0,0,e,0,0,0,1])}identity(){this.setTo(1,0,0,1,0,0)}createGradientBox(t,e,r,i,s){this.createBox(t,e,r,i,s)}createBox(t,e,r,i,s){this.identity(),this.rotate(r),this.scale(t,e),this.translate(i,s)}clone(){let t=this._data[0],e=this._data[3],r=this._data[1],i=this._data[4],s=this._data[2],l=this._data[5];return new C(t,e,r,i,s,l)}serialize(){return this._data}};a(C,"Matrix");var v=class{_data;constructor(t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){t.length===16?this._data=t:t.length===0?this.identity():(h("Matrix3D initialization vector invalid","warn"),this.identity())}dotProduct(t,e){if(t.length!==16||e.length!==16)throw new Error("Matrix3D dot product expects a 4xr Matrix3D");let r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(let i=0;i<4;i++)for(let s=0;s<4;s++)for(let l=0;l<4;l++)r[i*4+s]+=t[i*4+l]*e[l*4+s];return r}rotationMatrix(t,e){let r=Math.sin(t),i=Math.cos(t);return[i+e.x*e.x*(1-i),e.x*e.y*(1-i)-e.z*r,e.x*e.z*(1-i)+e.y*r,0,e.x*e.y*(1-i)+e.z*r,i+e.y*e.y*(1-i),e.y*e.z*(1-i)-e.x*r,0,e.z*e.x*(1-i)-e.y*r,e.z*e.y*(1-i)+e.x*r,i+e.z*e.z*(1-i),0,0,0,0,1]}identity(){this._data=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}append(t){this._data=this.dotProduct(t._data,this._data)}appendRotation(t,e,r){r&&this.appendTranslation(r.x,r.y,r.z),this._data=this.dotProduct(this.rotationMatrix(t*Math.PI/180,e),this._data),r&&this.appendTranslation(-r.x,-r.y,-r.z)}appendTranslation(t,e,r){this._data=this.dotProduct([1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1],this._data)}appendScale(t=1,e=1,r=1){this._data=this.dotProduct([t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1],this._data)}prepend(t){this._data=this.dotProduct(this._data,t._data)}prependRotation(t,e,r){r&&this.prependTranslation(r.x,r.y,r.z),this._data=this.dotProduct(this._data,this.rotationMatrix(t*Math.PI/180,e)),r&&this.prependTranslation(-r.x,-r.y,-r.z)}prependTranslation(t,e,r){this._data=this.dotProduct(this._data,[1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1])}prependScale(t,e,r){this._data=this.dotProduct(this._data,[t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1])}transformVector(t){let e=this._data[0]*t.x+this._data[1]*t.y+this._data[2]*t.z+this._data[3]*t.w,r=this._data[4]*t.x+this._data[5]*t.y+this._data[6]*t.z+this._data[7]*t.w,i=this._data[8]*t.x+this._data[9]*t.y+this._data[10]*t.z+this._data[11]*t.w,s=this._data[12]*t.x+this._data[13]*t.y+this._data[14]*t.z+this._data[15]*t.w;return new M(e,r,i,s)}transformVectors(t,e){if(t.length%3!==0){h("Matrix3D.transformVectors expects input size to be multiple of 3.","err");return}for(let r=0;r<t.length/3;r++){let i=t[r*3],s=t[r*3+1],l=t[r*3+2],m=this._data[0]*i+this._data[1]*s+this._data[2]*l,d=this._data[4]*i+this._data[5]*s+this._data[6]*l,p=this._data[8]*i+this._data[9]*s+this._data[10]*l;e.push(m,d,p)}}transpose(){this._data=[this._data[0],this._data[4],this._data[8],this._data[12],this._data[1],this._data[5],this._data[9],this._data[13],this._data[2],this._data[6],this._data[10],this._data[14],this._data[3],this._data[7],this._data[11],this._data[15]]}clone(){return new v(this._data)}serialize(){return this._data}};a(v,"Matrix3D");var st=class{constructor(t=0,e=0,r=0,i=0){this.x=t;this.y=e;this.z=r;this.w=i}toString(){return"(x="+this.x+", y="+this.y+", z="+this.z+", w="+this.w+")"}},M=st;a(M,"Vector3D"),o(M,"X_AXIS",new st(1,0,0)),o(M,"Y_AXIS",new st(0,1,0)),o(M,"Z_AXIS",new st(0,0,1));function qt(n,t,e,r,i,s){return new C(n,t,e,r,i,s)}a(qt,"createMatrix");function Ht(n){return new v(n)}a(Ht,"createMatrix3D");function Wt(n,t,e,r,i){let s=new C;return s.createGradientBox(n/1638.4,t/1638.4,e,r+n/2,i+t/2),s}a(Wt,"createGradientBox");function Kt(n=0,t=0,e=0,r=0){return new M(n,t,e,r)}a(Kt,"createVector3D");function Zt(n,t){return n.transformVector(t)}a(Zt,"projectVector");function Jt(n,t,e,r){for(;e.length>0;)e.pop();if(t.length%3!==0){h("Display.projectVectors input vertex Vector must be a multiple of 3.","err");return}let i=[];n.transformVectors(t,i);for(let s=0;s<i.length/3;s++){let l=i[s*3],m=i[s*3+1];e.push(l,m)}}a(Jt,"projectVectors");function dt(n=0,t=0){return new x(n,t)}a(dt,"createPoint");function \$t(n){return Object.defineProperty(n,"as3Type",{get:function(){return"Vector<int>"},set:function(t){h("as3Type should not be set.","warn")}}),n.map(Math.floor)}a(\$t,"toIntVector");function Qt(n){return Object.defineProperty(n,"as3Type",{get:function(){return"Vector<number>"},set:function(t){h("as3Type should not be set.","warn")}}),n}a(Qt,"toNumberVector");var G=class{constructor(t=1,e=1,r=1,i=1,s=0,l=0,m=0,d=0){this.redMultiplier=t;this.greenMultiplier=e;this.blueMultiplier=r;this.alphaMultiplier=i;this.redOffset=s;this.greenOffset=l;this.blueOffset=m;this.alphaOffset=d}get color(){return this.redOffset<<16|this.greenOffset<<8|this.blueOffset}set color(t){this.redOffset=t>>16&255,this.greenOffset=t>>8&255,this.blueOffset=t&255,this.redMultiplier=0,this.greenMultiplier=0,this.blueMultiplier=0}concat(t){this.redMultiplier*=t.redMultiplier,this.greenMultiplier*=t.greenMultiplier,this.blueMultiplier*=t.blueMultiplier,this.alphaMultiplier*=t.alphaMultiplier,this.redOffset+=t.redOffset,this.greenOffset+=t.greenOffset,this.blueOffset+=t.blueOffset,this.alphaOffset+=t.alphaOffset}serialize(){return{class:"ColorTransform",red:{offset:this.redOffset,multiplier:this.redMultiplier},green:{offset:this.greenOffset,multiplier:this.greenMultiplier},blue:{offset:this.blueOffset,multiplier:this.blueMultiplier},alpha:{offset:this.alphaOffset,multiplier:this.alphaMultiplier}}}};a(G,"ColorTransform");function te(n=1,t=1,e=1,r=1,i=0,s=0,l=0,m=0){return new G(n,t,e,r,i,s,l,m)}a(te,"createColorTransform");var N=class{fieldOfView=55;projectionCenter=new x(0,0);focalLength=0;constructor(t){t&&(this.projectionCenter=new x(t.width/2,t.height/2),this.fieldOfView=55,this.focalLength=t.width/2/Math.tan(this.fieldOfView/2))}toMatrix3D(){return new v}clone(){let t=new N;return t.fieldOfView=this.fieldOfView,t.projectionCenter=this.projectionCenter,t.focalLength=this.focalLength,t}};a(N,"PerspectiveProjection");var R=class{constructor(t){this.parent=t}_matrix=new C;_matrix3d;_perspectiveProjection;_colorTransform;set perspectiveProjection(t){this._perspectiveProjection=t}get perspectiveProjection(){return typeof this._perspectiveProjection>"u"&&(this._perspectiveProjection=new N(this.parent)),this._perspectiveProjection}set colorTransform(t){this._colorTransform=t}get colorTransform(){return typeof this._colorTransform>"u"&&(this._colorTransform=new G),this._colorTransform}set matrix3D(t){if(t===null){if(this._matrix3d===null)return;this._matrix3d=null,this._matrix=new C}else this._matrix=null,this._matrix3d=t;this.update()}set matrix(t){if(t===null){if(this._matrix===null)return;this._matrix=null,this._matrix3d=new v}else this._matrix3d=null,this._matrix=t;this.update()}get matrix3D(){return this._matrix3d}get matrix(){return this._matrix}box3d(t=1,e=1,r=1,i=0,s=0,l=0,m=0,d=0,p=0){(this._matrix||!this._matrix3d)&&(this._matrix=void 0,this._matrix3d=new v),this._matrix3d.identity(),this._matrix3d.appendRotation(i,M.X_AXIS),this._matrix3d.appendRotation(s,M.Y_AXIS),this._matrix3d.appendRotation(l,M.Z_AXIS),this._matrix3d.appendScale(t,e,r),this._matrix3d.appendTranslation(m,d,p)}box(t=1,e=1,r=0,i=0,s=0){this._matrix?this._matrix.createBox(t,e,r,i,s):this.box3d(t,e,1,0,0,r,i,s,0)}update(){this.parent&&(this.parent.transform=this)}getRelativeMatrix3D(t){return h("Transform.getRelativeMatrix3D not implemented","warn"),new v}getMatrix(){return this._matrix?this._matrix:this._matrix3d}getMatrixType(){return this._matrix?"2d":"3d"}clone(){let t=new R;return t._matrix=this._matrix,t._matrix3d=this._matrix3d,t}serialize(){return{mode:this.getMatrixType(),matrix:this.getMatrix()?.serialize()}}};a(R,"Transform");var It=(_=>(_.ADD="add",_.ALPHA="alpha",_.DARKEN="darken",_.DIFFERENCE="difference",_.ERASE="erase",_.HARDLIGHT="hardlight",_.INVERT="invert",_.LAYER="layer",_.LIGHTEN="lighten",_.MULTIPLY="multiply",_.NORMAL="normal",_.OVERLAY="overlay",_.SCREEN="screen",_.SHADER="shader",_.SUBTRACT="subtract",_))(It||{}),O=class{constructor(t=0,e=0,r=0,i=0){this.x=t;this.y=e;this.width=r;this.height=i}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}get size(){return dt(this.width,this.height)}contains(t,e){return t>=this.left&&e>=this.top&&t<=this.right&&e<=this.bottom}containsPoint(t){return this.contains(t.x,t.y)}containsRect(t){return this.contains(t.left,t.top)&&this.contains(t.right,t.bottom)}copyFrom(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}equals(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}inflate(t=0,e=0){this.x-=t,this.width+=2*t,this.y-=e,this.height+=2*e}inflatePoint(t){this.inflate(t.x,t.y)}isEmpty(){return this.width<=0||this.height<=0}setTo(t=0,e=0,r=0,i=0){this.x=t,this.y=e,this.width=r,this.height=i}offset(t=0,e=0){this.x+=t,this.y+=e}offsetPoint(t){this.offset(t.x,t.y)}setEmpty(){this.setTo(0,0,0,0)}unionCoord(t,e){let r=t-this.x,i=e-this.y;r>=0?this.width=Math.max(this.width,r):(this.x+=r,this.width-=r),i>=0?this.height=Math.max(this.height,i):(this.y+=i,this.height-=i)}unionPoint(t){this.unionCoord(t.x,t.y)}union(t){let e=this.clone();return e.unionCoord(t.left,t.top),e.unionCoord(t.right,t.bottom),e}toString(){return"(x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+")"}clone(){return new O(this.x,this.y,this.width,this.height)}serialize(){return{x:this.x,y:this.y,width:this.width,height:this.height}}};a(O,"Rectangle");var ft=class{constructor(t=c.generateId(),e=!0){this.id=t;this._visible=e}_alpha=1;_anchor=new x;_boundingBox=new O;_z=0;_scaleX=1;_scaleY=1;_scaleZ=1;_rotationX=0;_rotationY=0;_rotationZ=0;_filters=[];_blendMode="normal";_listeners={};_parent;_name="";_children=[];_transform=new R(this);_hasSetDefaults=!1;setDefaults(t={}){if(this._hasSetDefaults){h("DisplayObject.setDefaults called more than once.","warn");return}this._hasSetDefaults=!0;try{if(t.hasOwnProperty("motion")){let e=t.motion;e.hasOwnProperty("alpha")&&(this._alpha=e.alpha.fromValue),e.hasOwnProperty("x")&&(this._anchor.x=e.x.fromValue),e.hasOwnProperty("y")&&(this._anchor.y=e.y.fromValue)}else if(t.hasOwnProperty("motionGroup")&&t.motionGroup&&t.motionGroup.length>0){let e=t.motionGroup[0];e.hasOwnProperty("alpha")&&(this._alpha=e.alpha.fromValue),e.hasOwnProperty("x")&&(this._anchor.x=e.x.fromValue),e.hasOwnProperty("y")&&(this._anchor.y=e.y.fromValue)}}catch{}t.hasOwnProperty("alpha")&&(this._alpha=t.alpha),t.hasOwnProperty("x")&&(this._anchor.x=t.x),t.hasOwnProperty("y")&&(this._anchor.y=t.y)}eventToggle(t,e="enable"){ft.SANDBOX_EVENTS.indexOf(t)>-1||g("Runtime:ManageEvent",{id:this.id,name:t,mode:e})}propertyUpdate(t,e){g("Runtime:UpdateProperty",{id:this.id,name:t,value:e})}methodCall(t,e){g("Runtime:CallMethod",{id:this.id,method:t,params:e})}set alpha(t){this._alpha=t,this.propertyUpdate("alpha",t)}get alpha(){return this._alpha}set anchor(t){this._anchor=t,this.propertyUpdate("x",t.x),this.propertyUpdate("y",t.y)}get anchor(){return this._anchor}set boundingBox(t){this._boundingBox=t,this.propertyUpdate("boundingBox",t.serialize())}get boundingBox(){return this._boundingBox}set cacheAsBitmap(t){h("DisplayObject.cacheAsBitmap is not supported","warn")}get cacheAsBitmap(){return!1}set filters(t){this._filters=t||[];let e=[];for(let r=0;r<this._filters.length;r++)this.filters[r]&&e.push(this._filters[r].serialize());this.propertyUpdate("filters",e)}get filters(){return this._filters}get root(){return u.root}set root(t){h("DisplayObject.root is read-only.","warn")}get stage(){return u.root}set stage(t){h("DisplayObject.stage is read-only.","warn")}_updateBox(t=this._transform.getMatrixType()){t==="3d"?this._transform.box3d(this._scaleX,this._scaleY,this._scaleZ,this._rotationX,this._rotationY,this._rotationZ,0,0,this._z):this._transform.box(this._scaleX,this._scaleY,this._rotationZ*Math.PI/180),this.transform=this._transform}set rotationX(t){this._rotationX=t,this._updateBox("3d")}set rotationY(t){this._rotationY=t,this._updateBox("3d")}set rotationZ(t){this._rotationZ=t,this._updateBox()}set rotation(t){this._rotationZ=t,this._updateBox()}set scaleX(t){this._scaleX=t,this._updateBox()}set scaleY(t){this._scaleY=t,this._updateBox()}set scaleZ(t){this._scaleZ=t,this._updateBox("3d")}set x(t){this._anchor.x=t,this.propertyUpdate("x",t)}set y(t){this._anchor.y=t,this.propertyUpdate("y",t)}set z(t){this._z=t,this._updateBox("3d")}get rotationX(){return this._rotationX}get rotationY(){return this._rotationY}get rotationZ(){return this._rotationZ}get rotation(){return this._rotationZ}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get scaleZ(){return this._scaleZ}get x(){return this._anchor.x}get y(){return this._anchor.y}get z(){return this._z}set width(t){this._boundingBox.width=t,this.propertyUpdate("width",t)}get width(){return this._boundingBox.width}set height(t){this._boundingBox.height=t,this.propertyUpdate("height",t)}get height(){return this._boundingBox.height}set visible(t){this._visible=t,this.propertyUpdate("visible",t)}get visible(){return this._visible}set blendMode(t){this._blendMode=t,this.propertyUpdate("blendMode",t)}get blendMode(){return this._blendMode}set transform(t){this._transform=t,this._transform.parent!==this&&(this._transform.parent=this),this.propertyUpdate("transform",this._transform.serialize())}get transform(){return this._transform}set name(t){this._name=t,this.propertyUpdate("name",t)}get name(){return this._name}set loaderInfo(t){h("DisplayObject.loaderInfo is read-only","warn")}get loaderInfo(){return h("DisplayObject.loaderInfo is not supported","warn"),{}}set parent(t){h("DisplayObject.parent is read-only","warn")}get parent(){return this._parent??u.root}dispatchEvent(t,e){if(this._listeners.hasOwnProperty(t)&&this._listeners[t])for(let r=0;r<this._listeners[t].length;r++)try{this._listeners[t][r](e)}catch(i){i.hasOwnProperty("stack")?h(i.stack?.toString(),"err"):h(i.toString(),"err")}}addEventListener(t,e){this._listeners.hasOwnProperty(t)||(this._listeners[t]=[]),this._listeners[t].push(e),this._listeners[t].length===1&&this.eventToggle(t,"enable")}removeEventListener(t,e){if(!this._listeners.hasOwnProperty(t)||this._listeners[t].length===0)return;let r=this._listeners[t].indexOf(e);r>=0&&this._listeners[t].splice(r,1),this._listeners[t].length===0&&this.eventToggle(t,"disable")}get numChildren(){return this._children.length}addChild(t){if(typeof t>"u"||t===null)throw new Error("Cannot add an empty child!");if(t.contains(this))throw new Error("Attempting to add an ancestor of this DisplayObject as a child!");this._children.push(t),this._boundingBox.unionCoord(t._anchor.x+t._boundingBox.left,t._anchor.y+t._boundingBox.top),this._boundingBox.unionCoord(t._anchor.x+t._boundingBox.right,t._anchor.y+t._boundingBox.bottom),t._parent=this,this.methodCall("addChild",t.id)}removeChild(t){let e=this._children.indexOf(t);e>=0&&this.removeChildAt(e)}getChildAt(t){if(t<0||t>this._children.length)throw new RangeError("No child at index "+t);return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}removeChildAt(t){let e=this.getChildAt(t);this._children.splice(t,1),e._parent=null,this.methodCall("removeChild",e.id)}removeChildren(t,e=this._children.length){let r=this._children.splice(t,e-t),i=[];for(let s=0;s<r.length;s++)r[s]._parent=null,i.push(r[s].id);this.methodCall("removeChildren",i)}contains(t){if(t===this||this._children.indexOf(t)>=0)return!0;for(let e=0;e<this._children.length;e++)if(this._children[e].contains(t))return!0;return!1}remove(){this._parent?this._parent.removeChild(this):this.root.removeChild(this)}toString(){return"["+(this._name.length>0?this._name:"displayObject")+" DisplayObject]@"+this.id}clone(){let t=new ft;return t._transform=this._transform.clone(),t._transform.parent=t,t._boundingBox=this._boundingBox.clone(),t._anchor=this._anchor.clone(),t._alpha=this._alpha,t}hasOwnProperty(t){return t==="clone"?!0:Object.prototype.hasOwnProperty.call(this,t)}serialize(){this._hasSetDefaults=!0;let t=[];for(let e=0;e<this._filters.length;e++)t.push(this._filters[e].serialize());return{class:"DisplayObject",x:this._anchor.x,y:this._anchor.y,alpha:this._alpha,filters:t}}unload(){this._visible=!1,this.remove(),this.methodCall("unload",null)}getId(){return this.id}},T=ft;a(T,"DisplayObject"),o(T,"SANDBOX_EVENTS",["enterFrame"]);var gt=class{xBegin;yBegin;xEnd;yEnd;expand(t,e){this.xBegin=this.xBegin===null?t:Math.min(this.xBegin,t),this.xEnd=this.xEnd===null?t:Math.max(this.xEnd,t),this.yBegin=this.yBegin===null?e:Math.min(this.yBegin,e),this.yEnd=this.xEnd===null?e:Math.max(this.yEnd,e)}asRect(){return this.isEmpty()?new O(0,0,0,0):new O(this.xBegin,this.yBegin,this.xEnd-this.xBegin,this.yEnd-this.yBegin)}isEmpty(){return this.xBegin??this.yBegin??this.xEnd??this.yEnd??!0}reset(){delete this.xBegin,delete this.xEnd,delete this.yBegin,delete this.yEnd}};a(gt,"DirtyArea");var at=class extends T{constructor(e){super(c.generateId("obj-bmp"));this.bitmapData=e}get width(){return console.log(this.bitmapData),this.bitmapData?this.bitmapData.width*this.scaleX:0}get height(){return this.bitmapData?this.bitmapData.height*this.scaleY:0}set width(e){this.bitmapData&&this.bitmapData.width>0&&(this.scaleX=e/this.bitmapData.width)}set height(e){this.bitmapData&&this.bitmapData.height>0&&(this.scaleY=e/this.bitmapData.height)}getBitmapData(){return this.bitmapData}setBitmapData(e){typeof e<"u"&&(this.bitmapData=e,this.methodCall("setBitmapData",e.getId()))}serialize(){let e=super.serialize();return e.class="Bitmap",this.bitmapData!==null&&(e.bitmapData=this.bitmapData?.getId()),e}};a(at,"Bitmap");var Y=class{constructor(t,e,r=!0,i=4294967295,s=c.generateId("obj-bmp-data")){this.transparent=r;this.fillColor=i;this.id=s;this.rect=new O(0,0,t,e),this._fill(),c.registerObject(this)}rect;locked=!1;dirtyArea=new gt;byteArray=[];_fill(){this.byteArray=[];for(let t=0;t<this.rect.width*this.rect.height;t++)this.byteArray.push(this.fillColor)}_updateBox(t){if(this.dirtyArea.isEmpty()||this.locked)return;let e=t??this.dirtyArea.asRect();if(!this.rect.containsRect(e))throw h("BitmapData._updateBox box "+e.toString()+" out of bonunds "+this.rect.toString(),"err"),new Error("Rectangle provided was not within image bounds.");let r=[];for(let i=0;i<e.height;i++)for(let s=0;s<e.width;s++)r.push(this.byteArray[(e.y+i)*this.rect.width+e.x+s]);this._methodCall("updateBox",{box:e.serialize(),values:r}),this.dirtyArea.reset()}_methodCall(t,e){g("Runtime:CallMethod",{id:this.id,method:t,params:e})}get height(){return this.rect.height}get width(){return this.rect.width}set height(t){h("BitmapData.height is read-only","warn")}set width(t){h("BitmapData.height is read-only","warn")}draw(t,e,r,i,s,l=!1){if(!(t instanceof Y)){h("Drawing non BitmapData is not supported!","err");return}e&&h("Matrix transforms not supported yet.","warn"),r&&h("Color transforms not supported yet.","warn"),i&&i!=="normal"&&h("Blend mode ["+i+"] not supported yet.","warn"),l!==!1&&h("Smoothign not supported!","warn"),this.lock(),s&&(s=new O(0,0,t.width,t.height)),this.setPixels(s,t.getPixels(s)),this.unlock()}getPixel(t,e){return this.getPixel32(t,e)&16777215}getPixel32(t,e){if(t>=this.rect.width||e>=this.rect.height||t<0||e<0)throw new Error("Coordinates out of bounds");try{return this.transparent?this.byteArray[e*this.rect.width+t]:(this.byteArray[e*this.rect.width+t]&16777215)+4278190080}catch{return this.fillColor}}getPixels(t){if(typeof t>"u"||t===null)throw new Error("Expected a region to acquire pixels.");if(t.width===0||t.height===0)return new j;let e=new j;for(let r=0;r<t.height;r++)this.byteArray.slice((t.y+r)*this.rect.width+t.x,(t.y+r)*this.rect.width+t.x+t.width).forEach(function(i){e.push(i)});return e}setPixel(t,e,r){this.setPixel32(t,e,(r&16777215)+4278190080)}setPixel32(t,e,r){this.transparent||(r=(r&16777215)+4278190080),this.byteArray[e*this.rect.width+t]=r,this.dirtyArea.expand(t,e),this._updateBox()}setPixels(t,e){if(!(t.width===0||t.height===0)){if(e.length!==t.width*t.height)throw new Error("setPixels expected "+t.width*t.height+" pixels, but actually got "+e.length);this.transparent||(e=e.map(function(r){return(r&16777215)+4278190080}));for(let r=0;r<t.width;r++)for(let i=0;i<t.height;i++)this.byteArray[(t.y+i)*this.width+(t.x+r)]=e[i*t.width+r],this.dirtyArea.expand(r,i);this._updateBox()}}getVector(t){if(this.rect.equals(t))return this.byteArray;let e=[];for(let r=t.y;r<t.y+t.height;r++)for(let i=t.x;i<t.x+t.width;i++)e.push(t[r*this.rect.width+i]);return e}lock(){this.locked=!0}unlock(t){this.locked=!1,t?this._updateBox(t):this._updateBox()}dispatchEvent(t,e){}getId(){return this.id}serialize(){return{class:"BitmapData",width:this.rect.width,height:this.rect.height,fill:this.fillColor}}unload(){this._methodCall("unload",void 0)}clone(){let t=new Y(this.width,this.height,this.transparent,this.fillColor);return t.byteArray=this.byteArray.slice(0),t._updateBox(t.rect),t}};a(Y,"BitmapData");function bt(n,t,e,r){return n*e/r+t}a(bt,"linear");function St(n,t,e,r){return n/=r/2,n<1?e/2*n*n+t:(n--,-e/2*(n*(n-2)-1)+t)}a(St,"quadratic");function _t(n,t,e,r){return n/=r/2,n<1?e/2*n*n*n+t:(n-=2,e/2*(n*n*n+2)+t)}a(_t,"cubic");function kt(n,t,e,r){return n/=r/2,n<1?e/2*n*n*n*n+t:(n-=2,-e/2*(n*n*n*n-2)+t)}a(kt,"quartic");function xt(n,t,e,r){return n/=r/2,n<1?e/2*n*n*n*n*n+t:(n-=2,e/2*(n*n*n*n*n+2)+t)}a(xt,"quintic");function yt(n,t,e,r){return n/=r/2,n<1?-e/2*(Math.sqrt(1-n*n)-1)+t:(n-=2,e/2*(Math.sqrt(1-n*n)+1)+t)}a(yt,"circular");function wt(n,t,e,r){return-e/2*(Math.cos(Math.PI*n/r)-1)+t}a(wt,"sine");function Mt(n,t,e,r){return n/=r/2,n<1?e/2*Math.pow(2,10*(n-1))+t:(n--,e/2*(-Math.pow(2,-10*n)+2)+t)}a(Mt,"exponential");function At(n){let t={linear:bt,back:null,bounce:null,circular:yt,cubic:_t,elastic:null,exponential:Mt,sine:wt,quintic:xt};for(let e in t)n[e]=t[e]}a(At,"extendWithEasingFunctions");function ee(n="None"){switch(n=n.toLowerCase(),n){case"none":case"linear":default:return bt;case"exponential":return Mt;case"circular":return yt;case"quadratic":return St;case"cubic":return _t;case"quartic":return kt;case"quintic":return xt;case"sine":return wt}}a(ee,"getEasingFuncByName");var y=class{constructor(t,e=0){this.target=t;this.duration=e;this.timer.addEventListener("timer",()=>{this._onTimerEvent()})}isPlaying=!1;position=0;repeats=0;timeKeeper=new B;timer=new E(40);easing=f.linear;step=()=>{};lastSeek;_onTimerEvent(){this.isPlaying&&(this.position+=this.timeKeeper.elapsed,this.timeKeeper.reset(),this.step(this.target,this.position,this.duration),this.position>=this.duration&&(this.repeats--,this.repeats<0?(this.stop(),this.position=this.duration):this.position=0,this.step(this.target,this.position,this.duration)))}clone(){let t=new y(this.target,this.duration);return t.easing=this.easing,t.step=this.step,t}scale(t){this.position*=t,this.duration*=t}play(){this.isPlaying||this.gotoAndPlay(this.position)}stop(){this.isPlaying&&this.gotoAndStop(this.position)}gotoAndStop(t){this.position=t,this.isPlaying&&(this.isPlaying=!1,this.timer.stop()),this.step(this.target,this.position,this.duration)}gotoAndPlay(t){this.position=t,this.isPlaying||(this.isPlaying=!0,this.timer.start()),this.step(this.target,this.position,this.duration)}togglePause(){this.isPlaying?this.stop():this.play()}};a(y,"ITween");function ve(n,t,e,r){for(let i in t)e.hasOwnProperty(i)||(e[i]=n[i]);for(let i in e)t.hasOwnProperty(i)||(t[i]=e[i]);return function(i,s,l){for(let m in e)e.hasOwnProperty(m)&&(i[m]=r.easing(s,e[m],t[m]-e[m],l))}}a(ve,"createStepFunction");var Dt=class{static tween(t,e={},r={},i=0,s){let l=new y(t,i*1e3);return l.step=ve(t,e,r,l),s&&(l.easing=s),l}static to(t,e={},r=0,i){let s={};for(let l in e)e.hasOwnProperty(l)&&(typeof t[l]<"u"?s[l]=t[l]:s[l]=0);return Dt.tween(t,e,s,r,i)}static bezier(t,e,r,i,s=1,l){let m=new y(t,s*1e3);l&&typeof l=="function"&&(m.easing=l);let d={};for(let p in i)Array.isArray(i[p])&&i[p].length>0&&(d[p]=i[p]);(typeof r>"u"||r===null)&&(r={}),(typeof e>"u"||e===null)&&(e={});for(let p in d)p in r||(r[p]=m.target[p]),p in e||(e[p]=d[p][d[p].length-1]);return m.step=function(p,w,J){let X=Math.min(m.easing(w,0,1,J),1);for(let S in d){let P=d[S],_=P.length,k=Math.floor(X*_),ut=(X-k/_)*_;if(_===1)p[S]=r[S]+2*X*(1-X)*(P[0]-r[S])+X*X*(e[S]-r[S]);else{let \$=0,ct=0;k===0?(\$=r[S],ct=(P[0]+P[1])/2):k===_-1?(\$=(P[k-1]+P[k])/2,ct=e[S]):(\$=(P[k-1]+P[k])/2,ct=(P[k]+P[k+1])/2),p[S]=\$+2*ut*(1-ut)*(P[k]-\$)+ut*ut*(ct-\$)}}},m}static scale(t,e){let r=t.clone();return r.scale(e),r}static delay(t,e){let r=new y(t.target,t.duration+e*1e3);return r.step=function(i,s,l){s<=e*1e3||t.step(i,s-e*1e3,l-e*1e3)},r}static reverse(t){let e=new y(t.target,t.duration);return e.step=function(r,i,s){t.step(r,s-i,s)},e}static repeat(t,e){let r=new y(t.target,t.duration*e);return r.step=function(i,s,l){t.step(i,s%t.duration,t.duration)},r}static slice(t,e,r){r===null&&(r=t.duration),r<e&&(r=e),e*=1e3,r*=1e3;let i=new y(t.target,r-e);return i.step=function(s,l,m){t.step(s,e+l,t.duration)},i}static serial(...t){if(t.length===0)return new y({},0);let e=0,r=[],i=[];for(let l=0;l<t.length;l++)i.push(e),e+=t[l].duration,r.push(e);let s=new y({},e);return s.lastSeek=0,s.step=function(l,m,d){if(m<=r[s.lastSeek]){let p=t[s.lastSeek];p.step(p.target,m-i[s.lastSeek],p.duration);return}else{let p=t[s.lastSeek];p.step(p.target,p.duration,p.duration)}for(let p=0;p<r.length;p++)if(m<r[p]){s.lastSeek=p;let w=t[s.lastSeek];w.step(w.target,m-i[s.lastSeek],w.duration);return}},s}static parallel(...t){let e=0;for(let s=0;s<t.length;s++)e=Math.max(t[s].duration,e);let r=t,i=new y({},e);return i.step=function(s,l,m){for(let d=0;d<r.length;d++)r[d].step(r[d].target,Math.min(l,r[d].duration),r[d].duration)},i}},f=Dt;a(f,"Tween"),o(f,"linear",bt),o(f,"quadratic",St),o(f,"cubic",_t),o(f,"quartic",kt),o(f,"quintic",xt),o(f,"circular",yt),o(f,"sine",wt),o(f,"exponential",Mt),o(f,"extendWithEasingFunctions",At),o(f,"getEasingFuncByName",ee),o(f,"ITween",y);At(self);var F=class{_isRunning=!1;_ttl;_dur;_parent;_timer;_timeKeeper;_independentTimer;_tween;oncomplete;constructor(t,e=1e3,r=!1){if(typeof t>"u"||t===null)throw new Error("MotionManager must be bound to a DisplayObject.");this._ttl=e,this._dur=e,this._parent=t,this._independentTimer=r,this._timeKeeper=new B;let i=this;this._independentTimer?(this._timer=new E(41,0),this._timer.addEventListener("timer",()=>{i._onTimerEvent()}),this._timer.start()):this._parent.addEventListener("enterFrame",()=>{i._onTimerEvent()})}set dur(t){this._timeKeeper.reset(),this._ttl=t,this._dur=t}get dur(){return this._dur}get running(){return this._isRunning}_onTimerEvent(){this._isRunning&&this._dur!==0&&(this._ttl-=this._timeKeeper.elapsed,this._timeKeeper.reset(),this._ttl<=0&&(this.stop(),typeof this.oncomplete=="function"&&this.oncomplete(),this._parent.unload()))}reset(){this._ttl=this._dur,this._timeKeeper.reset()}play(){this._isRunning||this._dur===0||this._ttl<=0||(this._isRunning=!0,this._timeKeeper.reset(),this._tween&&this._tween.play())}stop(){this._isRunning&&(this._isRunning=!1,this._timeKeeper.reset(),this._tween&&this._tween.stop())}forecasting(t){return h("MotionManager.forecasting always returns false","warn"),!1}setPlayTime(t){this._ttl=this._dur-t,this._tween&&(this._isRunning?this._tween.gotoAndPlay(t):this._tween.gotoAndStop(t))}motionSetToTween(t){let e=[];for(let r in t){if(!t.hasOwnProperty(r))continue;let i=t[r];if(!i.hasOwnProperty("fromValue"))continue;i.hasOwnProperty("toValue")||(i.toValue=i.fromValue),i.hasOwnProperty("lifeTime")||(i.lifeTime=this._dur);let s={},l={};s[r]=i.fromValue,l[r]=i.toValue,typeof i.easing=="string"&&(i.easing=f.getEasingFuncByName(i.easing)),i.hasOwnProperty("startDelay")?e.push(f.delay(f.tween(this._parent,l,s,i.lifeTime,i.easing),i.startDelay/1e3)):e.push(f.tween(this._parent,l,s,i.lifeTime,i.easing))}return f.parallel.apply(f,e)}initTween(t,e){this._tween=this.motionSetToTween(t)}initTweenGroup(t,e){let r=[];for(let i=0;i<t.length;i++)r.push(this.motionSetToTween(t[i]));this._tween=f.serial.apply(f,r)}setCompleteListener(t){this.oncomplete=t}};a(F,"MotionManager");var V=class{constructor(t){this.parent=t}lineWidth=1;_evaluateBoundingBox(t,e){this.parent.boundingBox.unionCoord(t+this.lineWidth/2,e+this.lineWidth/2)}_callDrawMethod(t,e){g("Runtime:CallMethod",{id:this.parent.getId(),context:"graphics",method:t,params:e})}lineTo(t,e){this._evaluateBoundingBox(t,e),this._callDrawMethod("lineTo",[t,e])}moveTo(t,e){this._evaluateBoundingBox(t,e),this._callDrawMethod("moveTo",[t,e])}curveTo(t,e,r,i){this._evaluateBoundingBox(r,i),this._evaluateBoundingBox(t,e),this._callDrawMethod("curveTo",[t,e,r,i])}cubicCurveTo(t,e,r,i,s,l){this._evaluateBoundingBox(t,e),this._evaluateBoundingBox(r,i),this._evaluateBoundingBox(s,l),this._callDrawMethod("cubicCurveTo",[t,e,r,i,s,l])}lineStyle(t,e=0,r=1,i=!1,s="normal",l="none",m="round",d=3){this.lineWidth=t,this._callDrawMethod("lineStyle",[t,e,r,l,m,d])}drawRect(t,e,r,i){this._evaluateBoundingBox(t,e),this._evaluateBoundingBox(t+r,e+i),this._callDrawMethod("drawRect",[t,e,r,i])}drawCircle(t,e,r){this._evaluateBoundingBox(t-r,e-r),this._evaluateBoundingBox(t+r,e+r),this._callDrawMethod("drawCircle",[t,e,r])}drawEllipse(t,e,r,i){this._evaluateBoundingBox(t-r/2,e-i/2),this._evaluateBoundingBox(t+r/2,e+i/2),this._callDrawMethod("drawEllipse",[t+r/2,e+i/2,r/2,i/2])}drawRoundRect(t,e,r,i,s,l){this._evaluateBoundingBox(t,e),this._evaluateBoundingBox(t+r,e+i),this._callDrawMethod("drawRoundRect",[t,e,r,i,s,l])}drawPath(t,e,r="evenOdd"){this._callDrawMethod("drawPath",[t,e,r])}beginFill(t,e=1){this._callDrawMethod("beginFill",[t,e])}beginGradientFill(t,e,r,i,s,l="pad",m="rgb",d=0){if(h("Graphics.beginGradientFill still needs work.","warn"),t!=="linear"&&t!=="radial"){h("Graphics.beginGradientFill unsupported fill type : "+t,"warn");return}this._callDrawMethod("beginGradientFill",[t,e,r,i,s?s.serialize:null,l,m,d])}beginShaderFill(t,e){h("Graphics.beginShaderFill not supported.","warn")}endFill(){this._callDrawMethod("endFill",[])}drawTriangles(t,e,r,i="none"){if(e)e=e.slice(0);else{e=[];for(let s=0;s<t.length;s+=2)e.push(s/2)}if(e.length%3!==0){h("Graphics.drawTriangles malformed indices count. Must be multiple of 3.","err");return}if(i!=="none")for(let s=0;s<e.length/3;s++){let l=t[2*e[s*3+1]]-t[2*e[s*3]],m=t[2*e[s*3+1]+1]-t[2*e[s*3]+1],d=t[2*e[s*3+2]]-t[2*e[s*3+1]],p=t[2*e[s*3+2]+1]-t[2*e[s*3+1]+1],w=l*p-d*m;(w<0&&i==="positive"||w>0&&i==="negative")&&(e.splice(s*3,3),s--)}for(let s=0;s<e.length;s++)this._evaluateBoundingBox(t[2*e[s]],t[2*e[s]+1]);this._callDrawMethod("drawTriangles",[t,e,i])}clear(){this.parent.boundingBox.setEmpty(),this._callDrawMethod("clear",[])}};a(V,"Graphics");var U=class extends T{_graphics;_mouseEnabled=!0;_mousePosition=new x(0,0);_useHandCursor=!1;constructor(t){super(t),this._graphics=new V(this)}get graphics(){return this._graphics}set graphics(t){h("Sprite.graphics is read-only.","warn")}get mouseEnabled(){return this._mouseEnabled}set mouseEnabled(t){this._mouseEnabled=t,this.propertyUpdate("mouseEnabled",t)}get useHandCursor(){return this._useHandCursor}set useHandCursor(t){this._useHandCursor=t,this.propertyUpdate("useHandCursor",t)}serialize(){let t=super.serialize();return t.class="Sprite",t}};a(U,"Sprite");var et=class extends U{_metaRoot;constructor(){super("__root"),this._metaRoot=c.getObject("__root")}get parent(){return h("SecurityError: No access above root sprite.","err"),null}addEventListener(t,e){h("Listener["+t+"] on root sprite inadvisible","warn"),this._metaRoot.addEventListener(t,e)}removeEventListener(t,e){this._metaRoot.removeEventListener(t,e,!1)}};a(et,"RootSprite");var W=class extends U{_styles={};constructor(t){super(t)}clearStyle(t){delete this._styles[t]}getStyle(t){return this._styles[t]}setStyle(t,e){h("UIComponent.setStyle not implemented","warn"),this._styles[t]=e}setFocus(){this.methodCall("setFocus",null)}setSize(t,e){this.width=t,this.height=e}move(t,e){this.x=t,this.y=e}};a(W,"UIComponent");var Tt=class extends W{mM=new F(this);label="";constructor(t){super(),this.setDefaults(t),this.initStyle(t),c.registerObject(this),this.bindParent(t),this.mM.play()}get motionManager(){return this.mM}set motionManager(t){h("IComment.motionManager is read-only","warn")}bindParent(t){t.hasOwnProperty("parent")&&t.parent?.addChild(this)}initStyle(t){(typeof t>"u"||t===null)&&(t={}),"lifeTime"in t?this.mM.dur=t.lifeTime*1e3:this.mM.dur=4e3,t.hasOwnProperty("text")&&(this.label=t.text),t.hasOwnProperty("motionGroup")?this.mM.initTweenGroup(t.motionGroup,this.mM.dur):t.hasOwnProperty("motion")&&this.mM.initTween(t.motion,!1)}serialize(){let t=super.serialize();return t.class="Button",t.text=this.label,t}};a(Tt,"CommentButton");function re(n){return new Tt(n)}a(re,"createButton");var vt=class extends U{mM=new F(this);constructor(t){super(),this.setDefaults(t),this.initStyle(t),c.registerObject(this),this.bindParent(t),this.mM.play()}get motionManager(){return this.mM}set motionManager(t){h("IComment.motionManager is read-only","warn")}bindParent(t){t.hasOwnProperty("parent")&&t.parent?.addChild(this)}initStyle(t){t.lifeTime&&(this.mM.dur=t.lifeTime*1e3),t.hasOwnProperty("motionGroup")?this.mM.initTweenGroup(t.motionGroup,this.mM.dur):t.hasOwnProperty("motion")&&this.mM.initTween(t.motion,!1)}};a(vt,"CommentCanvas");function ie(n){return new vt(n)}a(ie,"createCanvas");var ot=class{constructor(t="SimHei",e=25,r=16777215,i=!1,s=!1,l=!1,m="",d="",p="left",w=0,J=0,X=0,S=0){this.font=t;this.size=e;this.color=r;this.bold=i;this.italic=s;this.underline=l}align;fontsize;serialize(){return{class:"TextFormat",font:this.font,size:this.size,color:this.color,bold:this.bold,underline:this.underline,italic:this.italic}}};a(ot,"TextFormat");var K=class extends T{constructor(e="",r=0){super(c.generateId("obj-textfield"));this._text=e;this._textFormat.color=r,this.boundingBox.width=this.textWidth,this.boundingBox.height=this.textHeight}_textFormat=new ot;_background=!1;_backgroundColor=16777215;_border=!1;_borderColor=0;get text(){return this._text}set text(e){this._text=e,this.boundingBox.width=this.textWidth,this.boundingBox.height=this.textHeight,this.propertyUpdate("text",this._text)}get length(){return this.text.length}set length(e){h("TextField.length is read-only.","warn")}get htmlText(){return this.text}set htmlText(e){h("TextField.htmlText is restricted due to security policy.","warn"),this.text=e.replace(/<\\/?[^>]+(>|\$)/g,"")}set textWidth(e){h("TextField.textWidth is read-only","warn")}set textHeight(e){h("TextField.textHeight is read-only","warn")}get textWidth(){return this._text.length*this._textFormat.size}get textHeight(){return this._textFormat.size}get color(){return this._textFormat.color}set color(e){this._textFormat.color=e,this.setTextFormat(this._textFormat)}get background(){return this._background}set background(e){this._background=e,this.propertyUpdate("background",e)}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){this._backgroundColor=e,this.propertyUpdate("backgroundColor",e)}get border(){return this._border}set border(e){this._border=e,this.propertyUpdate("border",e)}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e,this.propertyUpdate("borderColor",e)}getTextFormat(){return this._textFormat}setTextFormat(e){this._textFormat=e,this.methodCall("setTextFormat",e.serialize())}appendText(e){this.text=this.text+e}serialize(){let e=super.serialize();return e.class="TextField",e.text=this._text,e.textFormat=this._textFormat.serialize(),e}};a(K,"TextField");function ne(){return new ot}a(ne,"createTextFormat");var ht=class extends K{mM=new F(this);constructor(t,e={}){super(t,16777215),this.setDefaults(e),this.initStyle(e),c.registerObject(this),this.bindParent(e),this.mM.play()}set fontsize(t){var e=this.getTextFormat();e.size=t,this.setTextFormat(e)}get fontsize(){return this.getTextFormat().fontsize}set font(t){var e=this.getTextFormat();e.font=t,this.setTextFormat(e)}get font(){return this.getTextFormat().font}set align(t){var e=this.getTextFormat();e.align=t,this.setTextFormat(e)}get align(){return this.getTextFormat().align}set bold(t){var e=this.getTextFormat();e.bold=t,this.setTextFormat(e)}get bold(){return this.getTextFormat().bold}get motionManager(){return this.mM}set motionManager(t){h("IComment.motionManager is read-only","warn")}bindParent(t){t.hasOwnProperty("parent")&&t.parent?.addChild(this)}initStyle(t={}){"lifeTime"in t&&(this.mM.dur=t.lifeTime*1e3),"fontsize"in t&&(this.getTextFormat().size=t.fontsize),"font"in t&&(this.getTextFormat().font=t.font),"color"in t&&(this.getTextFormat().color=t.color),"bold"in t&&(this.getTextFormat().bold=t.bold),t.hasOwnProperty("motionGroup")?this.mM.initTweenGroup(t.motionGroup,this.mM.dur):t.hasOwnProperty("motion")&&this.mM.initTween(t.motion,!1)}};a(ht,"CommentField");function se(n,t){return new ht(n,t)}a(se,"createComment");function ae(){return new ht("",{})}a(ae,"createTextField");var Z=class extends T{_graphics;constructor(){super(),this._graphics=new V(this)}get graphics(){return this._graphics}serialize(){var t=super.serialize();return t.class="Shape",t}};a(Z,"Shape");var Ot=class extends Z{_mM=new F(this);constructor(t){super(),this.setDefaults(t),this.initStyle(t),c.registerObject(this),this.bindParent(t),this._mM.play()}get motionManager(){return this._mM}set motionManager(t){h("IComment.motionManager is read-only","warn")}bindParent(t){t.hasOwnProperty("parent")&&t.parent?.addChild(this)}initStyle(t={}){t.lifeTime&&(this._mM.dur=t.lifeTime*1e3),t.hasOwnProperty("motionGroup")?this._mM.initTweenGroup(t.motionGroup,this._mM.dur):t.hasOwnProperty("motion")&&this._mM.initTween(t.motion,!1)}};a(Ot,"CommentShape");function oe(n){return new Ot(n)}a(oe,"createShape");var L=class{serialize(){return{class:"Filter",type:"nullfilter"}}};a(L,"Filter");var Ft=class extends L{constructor(e=4,r=4){super();this.blurX=e;this.blurY=r}serialize(){let e=super.serialize();return e.type="blur",e.params={blurX:this.blurX,blurY:this.blurY},e}};a(Ft,"BlurFilter");var Ct=class extends L{constructor(e=16711680,r=1,i=6,s=6,l=2,m,d=!1,p=!1){super();this.color=e;this.alpha=r;this.blurX=i;this.blurY=s;this.strength=l;this.quality=m;this.inner=d;this.knockout=p}serialize(){let e=super.serialize();return e.type="glow",e.params={color:this.color,alpha:this.alpha,blurX:this.blurX,blurY:this.blurY,strength:this.strength,inner:this.inner,knockout:this.knockout},e}};a(Ct,"GlowFilter");var Pt=class extends L{constructor(e=4,r=45,i=0,s=1,l=4,m=4,d=1,p=1){super();this.distance=e;this.angle=r;this.color=i;this.alpha=s;this.blurX=l;this.blurY=m;this.strength=d;this.quality=p}inner=!1;knockout=!1;serialize(){let e=super.serialize();return e.type="dropShadow",e.params={distance:this.distance,angle:this.angle,color:this.color,blurY:this.blurY,strength:this.strength,inner:this.inner,knockout:this.knockout},e}};a(Pt,"DropShadowFilter");var Et=class extends L{constructor(e=0,r=0,i,s=1,l=0,m=!0,d=!0,p=0,w=0){super();this.matrixX=e;this.matrixY=r;this.matrix=i;this.divisor=s;this.bias=l;this.preserveAlpha=m;this.clamp=d;this.color=p;this.alpha=w}serialize(){let e=super.serialize();return e.type="convolution",e.matrix={x:this.matrixX,y:this.matrixY,data:this.matrix},e.divisor=this.divisor,e.preserveAlpha=this.preserveAlpha,e.clamp=this.clamp,e.color=this.color,e.alpha=this.alpha,e}};a(Et,"ConvolutionFilter");function he(n=4,t=45,e=0,r=1,i=4,s=4,l=1,m=1){return new Pt(n,t,e,r,i,s,l,m)}a(he,"createDropShadowFilter");function le(n=16711680,t=1,e=6,r=6,i=2,s,l=!1,m=!1){return new Ct(n,t,e,r,i,s,l,m)}a(le,"createGlowFilter");function ue(n=6,t=6,e=2){return new Ft(n,t)}a(ue,"createBlurFilter");function ce(){throw new Error("Display.createBevelFilter not implemented")}a(ce,"createBevelFilter");function me(n=0,t=0,e,r=1,i=0,s=!0,l=!0,m=0,d=0){return new Et(n,t,e,r,i,s,l,m,d)}a(me,"createConvolutionFilter");function pe(){throw new Error("Display.createDisplacementMapFilter not implemented")}a(pe,"createDisplacementMapFilter");function de(){throw new Error("Display.createGradientBevelFilter not implemented")}a(de,"createGradientBevelFilter");function fe(){throw new Error("Display.createGradientGlowFilter not implemented")}a(fe,"createGradientGlowFilter");function ge(){throw new Error("Display.createColorMatrixFilter not implemented")}a(ge,"createColorMatrixFilter");var u=class{static get stage(){return this.root}static get frameRate(){return this._frameRate}static set frameRate(t){this._frameRate=t,g("Display:SetFrameRate",t)}static toString(){return"[display Display]"}};a(u,"Display"),o(u,"Point",x),o(u,"Matrix",C),o(u,"Matrix3D",v),o(u,"Vector3D",M),o(u,"createMatrix",qt),o(u,"createMatrix3D",Ht),o(u,"createGradientBox",Wt),o(u,"createVector3D",Kt),o(u,"projectVector",Zt),o(u,"projectVectors",Jt),o(u,"createPoint",dt),o(u,"toIntVector",\$t),o(u,"toNumberVector",Qt),o(u,"ColorTransform",G),o(u,"createColorTransform",te),o(u,"PerspectiveProjection",N),o(u,"Transform",R),o(u,"Filter",L),o(u,"createDropShadowFilter",he),o(u,"createGlowFilter",le),o(u,"createBlurFilter",ue),o(u,"createBevelFilter",ce),o(u,"createConvolutionFilter",me),o(u,"createDisplacementMapFilter",pe),o(u,"createGradientBevelFilter",de),o(u,"createGradientGlowFilter",fe),o(u,"createColorMatrixFilter",ge),o(u,"BlendMode",It),o(u,"Rectangle",O),o(u,"DisplayObject",T),o(u,"Graphics",V),o(u,"Sprite",U),o(u,"RootSprite",et),o(u,"UIComponent",W),o(u,"ByteArray",j),o(u,"Bitmap",at),o(u,"BitmapData",Y),o(u,"MotionManager",F),o(u,"createButton",re),o(u,"createCanvas",ie),o(u,"Shape",Z),o(u,"createShape",oe),o(u,"TextField",K),o(u,"createTextFormat",ne),o(u,"createComment",se),o(u,"createTextField",ae),o(u,"root",new et),o(u,"loaderInfo"),o(u,"version",""),o(u,"width",0),o(u,"height",0),o(u,"fullScreenWidth",0),o(u,"fullScreenHeight",0),o(u,"_frameRate",24);A("Update:DimensionUpdate",n=>{u.width=n.stageWidth,u.height=n.stageHeight,n.hasOwnProperty("screenWidth")&&n.hasOwnProperty("screenHeight")&&(u.fullScreenWidth=n.screenWidth,u.fullScreenHeight=n.screenHeight)});function Oe(n,t,e){let r=1,i=1,s=1;if(t){let l=n%360/60,m=l|0,d=l-m,p=1-t,w=1-t*d,J=1-t*(1-d);switch(m){case 0:r=1,i=J,s=p;break;case 1:r=w,i=1,s=p;break;case 2:r=p,i=1,s=J;break;case 3:r=p,i=w,s=1;break;case 4:r=J,i=p,s=1;break;case 5:r=1,i=p,s=w;break}}return r*=255*e,i*=255*e,s*=255*e,r<<16|i<<8|s}a(Oe,"HSV2RGB");var I=class{static rgb(t,e,r){return t<<16|e<<8|r}static hue(t,e=1,r=1){return Oe(t,e,r)}static formatTimes(t){return Math.floor(t/60)+":"+(t%60>9?"":"0")+t%60}static distance(t,e,r,i){return Math.sqrt((t-r)*(t-r)+(e-i)*(e-i))}static rand(t,e){return t+Math.floor(Math.random()*(e-t))}static getTimer(){return Date.now()-this.startTime}static timer(t,e=1e3){return c.getTimer().setTimeout(t,e)}static interval(t,e=1e3,r=1){if(r===0)return c.getTimer().setInterval(t,e);let i=c.getTimer().setInterval(function(){r--,r<0?c.getTimer().clearInterval(i):t()},e);return i}static clearTimeout(t){c.getTimer().clearTimeout(t)}static clearInterval(t){c.getTimer().clearInterval(t)}};a(I,"Utils"),o(I,"startTime",Date.now());var Bt=class{constructor(t,e){this.source=t;this.onload=e}id=c.generateId("obj-snd");isPlaying=!1;createFromURL(t){this.source=t}play(){this.isPlaying}remove(){}stop(){this.isPlaying}loadPercent(){return 0}getId(){return this.id}dispatchEvent(t,e){}unload(){this.stop()}serialize(){return{class:"Sound",url:this.source}}};a(Bt,"Sound");function Fe(n,t){return new Bt(n,t)}a(Fe,"createSound");var b=class{static get time(){return this.state!=="playing"?this._time:this._time+this.lastUpdate.elapsed}static play(){g("Player::action",{action:"play"})}static pause(){g("Player::action",{action:"pause"})}static seek(t){g("Player::action",{action:"seek",params:t})}static jump(t,e=1,r=!1){g("Player::action",{action:"jump",params:{vid:t,page:e,window:r}})}static commentTrigger(t,e){if(!c.hasObject("__player")){h("Your environment does not support player triggers.","err");return}if(e<0)return;c.getObject("__player").addEventListener("comment",i=>t(i))}static keyTrigger(t,e=1e3,r=!1){if(!c.hasObject("__player")){h("Your environment does not support key triggers.","err");return}if(e<0)return;let i="key"+(r?"up":"down");c.getObject("__player").addEventListener(i,l=>t(l.key))}static setMask(t){h("Masking not supported yet","warn")}static toString(){return"[player Player]"}};a(b,"Player"),o(b,"createSound",Fe),o(b,"state",""),o(b,"_time",""),o(b,"commentList",[]),o(b,"refreshRate",0),o(b,"width",0),o(b,"height",0),o(b,"videoWidth",0),o(b,"videoHeight",0),o(b,"version",0),o(b,"lastUpdate",new B);A("Update:DimensionUpdate",n=>{b.width=n.stageWidth,b.height=n.stageHeight,n.hasOwnProperty("videoWidth")&&n.hasOwnProperty("videoHeight")&&(b.videoWidth=n.videoWidth,b.videoHeight=n.videoHeight)});A("Update:TimeUpdate",n=>{b.state=n.state,b._time=n.time,b.lastUpdate.reset()});var lt=class{},z=lt;a(z,"Global"),o(z,"_store",{}),o(z,"_set",(t,e)=>{lt._store[t]=e}),o(z,"_get",t=>lt._store[t]),o(z,"_",t=>lt._get(t));function be(n){typeof n=="object"?h(JSON.stringify(n),"log"):h(n,"log")}a(be,"trace");function _e(n,t){typeof t=="function"&&t()}a(_e,"load");function xe(n){if(n===null||typeof n!="object")return n;if(typeof n.clone=="function")return n.clone();if(Array.isArray(n))return n.slice(0);let t={};t.constructor=t.constructor,t.prototype=t.prototype;for(let e in n)t[e]=n[e];return t}a(xe,"clone");function ye(n,t){if(!(n===null||typeof n!="object")&&!(n instanceof u.DisplayObject))for(let e in n)n.hasOwnProperty(e)&&t(e,n[e])}a(ye,"foreach");function we(){throw new Error("stopExecution")}a(we,"stopExecution");Q.createChannel("::eval",1,Math.round(Math.random()*1e5));Q.createChannel("::debug",1,Math.round(Math.random()*1e5));function Me(n){try{new Function("Runtime","Display","\$","Player","Tween","Utils","getTimer","interval","timer","Global","\$G","clearTimeout","clearInterval","trace","load","clone","foreach","stopExecution","importScripts","postMessage","addEventListener","self",n)(c,u,u,b,f,I,I.getTimer,I.interval,I.timer,z,z,I.clearTimeout,I.clearInterval,be,_e,xe,ye,we,void 0,void 0,void 0,void 0)}catch(t){if(t.message==="stopExecution")return;throw t}}a(Me,"EVAL");A("::eval",function(n){Me(n.replace(/(\\/n|\\\\n|\\n|\\r\\n)/g,\`
\`).replace(/\`/g,"\\\\\`").replace(/'|"/g,"\`").replace(/(&amp;)|(&lt;)|(&gt;)|(&apos;)|(&quot;)/g,t=>({"&amp;":"&","&lt;":"<","&gt;":">","&apos;":"'","&quot;":'"'})[t]))});A("::debug",function(n){if(typeof n>"u"||n===null||!n.hasOwnProperty("action")){D("::worker:debug","worker","Malformed request");return}if(n.action==="list-channels")D("::worker:debug","worker",Q.listChannels());else if(n.action==="raw-eval")try{D("::worker:debug","worker",Me(n.code))}catch(t){D("::worker:debug","worker","Error: "+t)}else D("::worker:debug","worker","Unrecognized action")});D("::worker:state","worker","running");})();
`, "Worker", undefined, undefined);
}
