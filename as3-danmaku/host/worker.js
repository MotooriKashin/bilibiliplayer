import worker from '@jsc/danmaku/worker-loader/inline';

// 运行在work中的弹幕解析器，须提前构建
export default function () {
  return worker(`(()=>{var Gt=Object.defineProperty;var Pe=(i,t,e)=>t in i?Gt(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var a=(i,t)=>Gt(i,"name",{value:t,configurable:!0});var o=(i,t,e)=>(Pe(i,typeof t!="symbol"?t+"":t,e),e);function z(...i){setTimeout(console.log.bind(console,"%c[AS3 parser]","color: blue;",...i))}a(z,"debug");z.log=function(...i){setTimeout(console.log.bind(console,"%c[AS3 parser]","color: blue;",...i))};z.debug=function(...i){setTimeout(console.debug.bind(console,"[AS3 parser]",...i))};z.warn=function(...i){setTimeout(console.warn.bind(console,"[AS3 parser]",...i))};z.error=function(...i){setTimeout(console.error.bind(console,"[AS3 parser]",...i))};var dt=class{channels={};constructor(){self.addEventListener("message",t=>{if(t)try{let e=JSON.parse(t.data);e.hasOwnProperty("channel")&&typeof e.channel=="string"?this.dispatchMessage(e):h(e,"warn")}catch(e){h(e,"err")}})}dispatchMessage(t){t.channel in this.channels&&this.channels[t.channel]?.listeners.forEach(e=>{try{e(t.payload)}catch(r){r.stack?h(r.stack?.toString(),"err"):h(r.toString(),"err")}})}listChannels=()=>{let t={};for(let e in this.channels)t[e]={max:this.channels[e].max,listeners:this.channels[e].listeners.length};return t};deleteChannel=(t,e)=>t in this.channels?e||this.channels[t].auth?e===this.channels[t].auth?(delete this.channels[t],!0):!1:(delete this.channels[t],!0):!0;createChannel=(t,e,r)=>t in this.channels?!1:(this.channels[t]={max:e||0,auth:r,listeners:[]},!0);addListenerChannel=(t,e)=>(t in this.channels||(this.channels[t]={max:0,listeners:[]}),this.channels[t].max>0&&this.channels[t].listeners.length>=this.channels[t].max?!1:(this.channels[t].listeners.push(e),!0))};a(dt,"OOAPI");var it=new dt;function h(i,t){switch(t){case"warn":z.warn(i);break;case"err":z.error(i);break;case"fatal":z.error(i),self.postMessage(JSON.stringify({channel:"fatal",obj:i}));break;default:z(i);break}}a(h,"__trace");function jt(i,t,e){self.postMessage(JSON.stringify({channel:i,payload:t,callback:!0})),it.addListenerChannel(i,e)}a(jt,"__channel");function A(i,t){it.addListenerChannel(i,t)}a(A,"__schannel");function b(i,t){self.postMessage(JSON.stringify({channel:i,payload:t,callback:!1}))}a(b,"__pchannel");function D(i,t,e){self.postMessage(JSON.stringify({channel:i,auth:t,payload:e,callback:!1}))}a(D,"__achannel");var W=class{static xorshift128p(){var t=this._rngState[1],e=this._rngState[0];this._rngState[0]=t,e^=e<<23,e^=e>>17,e^=t,e^=t>>26,this._rngState[1]=e}static random(t=16){if(t===void 0&&(t=16),t>32)throw new Error("NotCrypto.random expects 32 bits or less");if(Math&&Math.random){for(var e=0,r=0;r<t;r++)e=(e<<1)+(Math.random()<.5?0:1);return e}else return this.fallbackRandom(Date.now()%1024,t)}static fallbackRandom(t,e=16){if(e===void 0&&(e=16),e>32)throw new Error("NotCrypto.fallbackRandom expects 32 bits or less");for(var r=0;r<t;r++)this.xorshift128p();for(var n=0,r=0;r<e;r++)n=(n<<1)+1;return this._rngState[0]+this._rngState[1]&n}static toHex(t,e){if(e===void 0&&(e=0),e<=0)return t.toString(16);for(var r=t.toString(16);r.length<e;)r="0"+r;return r}};a(W,"NotCrypto"),o(W,"_rngState",[Math.floor(Date.now()/1024)%1024,Date.now()%1024]);var K=class{name;listeners={};constructor(t){if(t.slice(0,2)!=="__")throw new Error("MetaObject names must start with two underscores.");this.name=t}addEventListener(t,e,r=!1,n=0){t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push(e)}removeEventListener(t,e,r=!1){if(!(t in this.listeners))return;let n=this.listeners[t].indexOf(e);n>=0&&this.listeners[t].splice(n,1)}hasEventListener(t){return t in this.listeners&&this.listeners[t].length>0}dispatchEvent(t,e){if(t in this.listeners)for(let r=0;r<this.listeners[t].length;r++)this.listeners[t][r](e)}getId(){return this.name}serialize(){return{class:this.name}}unload(){throw new Error("Meta objects should not be unloaded!")}};a(K,"MetaObject");var ft={};function Nt(i,t){jt("Runtime:RequestPermission",{name:i},e=>{e===!0?ft[i]=!0:ft[i]=!1,typeof t=="function"&&t(e)})}a(Nt,"requestPermission");function Yt(i){return!!(ft.hasOwnProperty(i)&&ft[i])}a(Yt,"hasPermission");function Xt(i,t,e){jt("Runtime:PrivilegedAPI",{method:"openWindow",params:[i,t]},function(r){e?.({moveTo:function(s,l){b("Runtime:PrivilegedAPI",{method:"window",params:[r,"moveTo",[s,l]]})},resizeTo:function(s,l){b("Runtime:PrivilegedAPI",{method:"window",params:[r,"resizeTo",[s,l]]})},focus:function(){b("Runtime:PrivilegedAPI",{method:"window",params:[r,"focus"]})},close:function(){b("Runtime:PrivilegedAPI",{method:"window",params:[r,"close"]})}})})}a(Xt,"openWindow");function qt(i,t){b("Runtime:PrivilegedAPI",{method:"injectStyle",params:[i,t]})}a(qt,"injectStyle");function Ht(){h("Runtime.privilegedCode not available.","warn")}a(Ht,"privilegedCode");var N=class{static _registerElement(t,e){this.managedElements[t]=e}static clearTimer(){c.getTimer().clearAll("interval")}static clearEl(){h("ScriptManager.clearEl may not be properly implemented.","warn"),c.clear()}static clearTrigger(){h("ScriptManager.clearTrigger not implemented.","warn")}static pushEl(t){h("ScriptManager.pushEl is not properly implemented.","warn"),t.motionManager&&t.motionManager.start(),t.visible=!0}static popEl(t){h("ScriptManager.popEl is not properly implemented.","warn"),t.motionManager&&t.motionManager.play(),t.visible=!1}static pushTimer(t){h("ScriptManager.pushTimer not implemented.","warn")}static popTimer(t){h("ScriptManager.popTimer not implemented.","warn")}toString(){return"[scriptManager ScriptManager]"}};a(N,"ScriptManager"),o(N,"managedElements",{});var Wt={js:["*"],Runtime:["*","openWindow","injectStyle"],Display:["*"],Player:["*"],Tween:["*"],Utils:["*"]};function Kt(i,t="*"){if(Wt.hasOwnProperty(i)){if(Wt[i].indexOf(t)>=0)return!0}else return!1;return!1}a(Kt,"supports");function Zt(i,t){i==="libBitmap"?t(null,{type:"noop"}):t(new Error("Could not load unknown library ["+i+"]"),null)}a(Zt,"requestLibrary");var at=class{constructor(t,e,r,n){this.type=t;this.dur=e;this.key=r;this.callback=n;this.ttl=e}ttl};a(at,"RuntimeTimer");var ot=class{constructor(t=10){this.precision=t}timer=-1;timers=[];lastToken=0;key=0;set isRunning(t){t==!1?this.stop():this.start()}get isRunning(){return this.timer>-1}start(){this.timer<0&&(this.lastToken=Date.now(),this.timer=setInterval(()=>{let t=Date.now()-this.lastToken;for(let e=0;e<this.timers.length;e++){let r=this.timers[e];if(r.type==="timeout"){if(r.ttl-=t,r.ttl<=0){try{r.callback()}catch(n){h(n.stack?.toString(),"err")}this.timers.splice(e,1),e--}}else if(r.type==="interval"&&(r.ttl-=t,r.ttl<=0)){try{r.callback()}catch(n){h(n.stack?.toString(),"err")}r.ttl+=r.dur}}this.lastToken=Date.now()},this.precision))}stop(){this.timer>-1&&(clearInterval(this.timer),this.timer=-1)}setInterval(t,e){let r=this.key++;return this.timers.push(new at("interval",e,r,t)),r}setTimeout(t,e){let r=this.key++;return this.timers.push(new at("timeout",e,r,t)),r}clearInterval(t){for(let e=0;e<this.timers.length;e++)if(this.timers[e].type==="interval"&&this.timers[e].key===t){this.timers.splice(e,1);return}}clearTimeout(t){for(let e=0;e<this.timers.length;e++)if(this.timers[e].type==="timeout"&&this.timers[e].key===t){this.timers.splice(e,1);return}}clearAll(t="all"){t==="timer"?this.timers=this.timers.filter(e=>e.type!=="timer"):t==="interval"?this.timers=this.timers.filter(e=>e.type!=="interval"):this.timers=[]}};a(ot,"TimerRuntime");var E=class{constructor(t,e=0){this.delay=t;this.repeatCount=e}microtime=0;timer=-1;listeners=[];complete=[];currentCount=0;set isRunning(t){h("Timer.isRunning is read-only","warn")}get isRunning(){return this.timer>=0}start(){if(!this.isRunning){let t=Date.now(),e=this;this.timer=setInterval(()=>{let r=Date.now()-t;e.microtime+=r,e.microtime>e.delay&&(e.microtime-=e.delay,e.currentCount++,e.dispatchEvent("timer")),t=Date.now(),e.repeatCount>0&&e.repeatCount<=e.currentCount&&(e.stop(),e.dispatchEvent("timerComplete"))},20)}}stop(){this.isRunning&&(clearInterval(this.timer),this.timer=-1)}reset(){this.stop(),this.currentCount=0,this.microtime=0}addEventListener(t,e){t==="timer"?this.listeners.push(e):t==="timerComplete"&&this.complete.push(e)}dispatchEvent(t){if(t==="timer")for(let e=0;e<this.listeners.length;e++)this.listeners[e]();else if(t==="timerComplete")for(let e=0;e<this.complete.length;e++)this.complete[e]()}};a(E,"Timer");var I=class{constructor(t=()=>Date.now()){this.clock=t;this.reset()}lastTime=0;get elapsed(){return this.clock()-this.lastTime}reset(){this.lastTime=this.clock()}};a(I,"TimeKeeper");var nt=class{static dispatchEvent(t,e,r){let n=this.registeredObjects[t];typeof n=="object"&&n.dispatchEvent&&n.dispatchEvent(e,r)}static hasObject(t){return this.registeredObjects.hasOwnProperty(t)&&this.registeredObjects[t]!==null}static getObject(t){return this.registeredObjects[t]}static registerObject(t){if(!t.getId){h("Cannot register object without getId method.","warn");return}if(nt.hasObject(t.getId())){h("Attempted to re-register object or id collision @ "+t.getId(),"warn");return}else{this.registeredObjects[t.getId()]=t,b("Runtime:RegisterObject",{id:t.getId(),data:t.serialize()}),A("object::("+t.getId()+")",e=>{e.hasOwnProperty("type")&&e.type==="event"&&this.dispatchEvent(t.getId(),e.event,e.data)}),this.objCount++;return}}static eregisterObject(t){let e=t.getId();this.deregisterObjectById(e)}static deregisterObjectById(t){if(nt.hasObject(t)){if(t.substr(0,2)==="__"){h("Runtime.deregisterObject cannot de-register a MetaObject","warn");return}b("Runtime:DeregisterObject",{id:t}),typeof this.registeredObjects[t].unload=="function"&&this.registeredObjects[t].unload(),this.registeredObjects[t]=null,delete this.registeredObjects[t]}}static _makeId(t="obj"){return t+":"+Date.now()+"|"+W.random(16)+":"+this.objCount}static generateId(t="obj"){let e=this._makeId(t);for(;this.hasObject(e);)e=this._makeId(t);return e}static reset(){for(let t in this.registeredObjects)t.substr(0,2)!=="__"&&this.deregisterObjectById(t)}static clear(){for(let t in this.registeredObjects)t.substr(0,2)!=="__"&&typeof this.registeredObjects[t].unload=="function"&&this.registeredObjects[t].unload()}static crash(){h("Runtime.crash() : Manual crash","fatal")}static exit(){D("::worker:state","worker","terminated"),self.close()}static alert(t){D("Runtime::alert","::Runtime",t)}static getTimer(){return this.masterTimer}static updateFrameRate(t){if(t>60||t<0){h("Frame rate should be in the range (0, 60]","warn");return}if(t===0){this.internalTimer.stop();return}this.internalTimer.stop(),this.internalTimer=new E(Math.floor(1e3/t)),this.internalTimer.addEventListener("timer",this.enterFrameDispatcher),this.internalTimer.start()}},c=nt;a(c,"Runtime"),o(c,"NotCrypto",W),o(c,"Timer",E),o(c,"TimeKeeper",I),o(c,"_defaultScriptManager",new N),o(c,"requestPermission",Nt),o(c,"hasPermission",Yt),o(c,"openWindow",Xt),o(c,"injectStyle",qt),o(c,"privilegedCode",Ht),o(c,"supports",Kt),o(c,"requestLibrary",Zt),o(c,"objCount",0),o(c,"registeredObjects",{__self:new K("__self"),__player:new K("__player"),__root:new K("__root")}),o(c,"masterTimer",new ot),o(c,"internalTimer",new E(40)),o(c,"enterFrameDispatcher",()=>{for(let t in nt.registeredObjects)if(!(t.substring(0,2)==="__"&&t!=="__root"))try{nt.registeredObjects[t].dispatchEvent("enterFrame")}catch{}});c.masterTimer.start();c.internalTimer.start();c.internalTimer.addEventListener("timer",c.enterFrameDispatcher);var S=class extends Array{_readPosition=0;constructor(...t){super(...t);try{Object.setPrototypeOf(this,S.prototype)}catch{}}get bytesAvailable(){return this.length-this._readPosition}set bytesAvailable(t){h("ByteArray.bytesAvailable is read-only","warn")}get position(){return this._readPosition}set position(t){this._readPosition=t}clear(){this.length=0,this._readPosition=0}compress(t="zlib"){h("ByteArray.compress["+t+"] not implemented","warn"),this._readPosition=0}uncompress(t="zlib"){h("ByteArray.uncompress["+t+"] not implemented","warn"),this._readPosition=0}deflate(){h("ByteArray.deflate not implemented","warn")}inflate(){h("ByteArray.inflate not implemented","warn")}readUTFBytes(t){let e=this.slice(this._readPosition,t);return this._readPosition+=Math.min(t,this.length-this._readPosition),e.reduce((r,n)=>(r+=String.fromCharCode(n),r),"")}readUnsignedByte(){return this[this._readPosition]&255}readUnsignedShort(){let t=this.readUnsignedByte(),e=this.readUnsignedByte();return(t<<8)+e&65535}readUnsignedInt(){let t=this.readUnsignedByte(),e=this.readUnsignedByte(),r=this.readUnsignedByte(),n=this.readUnsignedByte();return(t<<24)+(e<<16)+(r<<8)+n&4294967295}readByte(){return this.readUnsignedByte()-128}readShort(){return this.readUnsignedShort()-32767}readBoolean(){return this.readUnsignedByte()!==0}readFloat(){let t=this.readUnsignedInt(),e=t&2147483648?-1:1,r=t>>23&255,n=t&8388607;switch(e){case 0:break;case 255:return r?NaN:n>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;default:return e-=127,r+=8388608,n*(r/8388608)*Math.pow(2,e)}}writeByte(t){this.push(t&255)}writeBytes(t,e=0,r=0){for(let n=e;n<Math.min(t.length-e,r);n++)this.writeByte(t[n])}writeUTFBytes(t){let e=unescape(encodeURIComponent(t));for(let r=0;r<t.length;r++)this.push(e.charCodeAt(r))}clone(){let t=new S;return this.forEach(function(e){t.push(e)}),t}};a(S,"ByteArray");function Be(i,t,e){let r=1,n=1,s=1;if(t){let l=i%360/60,m=l|0,d=l-m,p=1-t,v=1-t*d,et=1-t*(1-d);switch(m){case 0:r=1,n=et,s=p;break;case 1:r=v,n=1,s=p;break;case 2:r=p,n=1,s=et;break;case 3:r=p,n=v,s=1;break;case 4:r=et,n=p,s=1;break;case 5:r=1,n=p,s=v;break}}return r*=255*e,n*=255*e,s*=255*e,r<<16|n<<8|s}a(Be,"HSV2RGB");var x=class{static rgb(t,e,r){return t<<16|e<<8|r}static hue(t,e=1,r=1){return Be(t,e,r)}static formatTimes(t){return Math.floor(t/60)+":"+(t%60>9?"":"0")+t%60}static distance(t,e,r,n){return Math.sqrt((t-r)*(t-r)+(e-n)*(e-n))}static rand(t,e){return t+Math.floor(Math.random()*(e-t))}static getTimer(){return Date.now()-this.startTime}static timer(t,e=1e3){return c.getTimer().setTimeout(t,e)}static interval(t,e=1e3,r=1){if(r===0)return c.getTimer().setInterval(t,e);let n=c.getTimer().setInterval(function(){r--,r<0?c.getTimer().clearInterval(n):t()},e);return n}static clearTimeout(t){c.getTimer().clearTimeout(t)}static clearInterval(t){c.getTimer().clearInterval(t)}};a(x,"Utils"),o(x,"startTime",Date.now());var gt=class{constructor(t,e){this.source=t;this.onload=e}id=c.generateId("obj-snd");isPlaying=!1;createFromURL(t){this.source=t}play(){this.isPlaying}remove(){}stop(){this.isPlaying}loadPercent(){return 0}getId(){return this.id}dispatchEvent(t,e){}unload(){this.stop()}serialize(){return{class:"Sound",url:this.source}}};a(gt,"Sound");function Ee(i,t){return new gt(i,t)}a(Ee,"createSound");var f=class{static get time(){return this.state!=="playing"?this._time:this._time+this.lastUpdate.elapsed}static play(){b("Player::action",{action:"play"})}static pause(){b("Player::action",{action:"pause"})}static seek(t){b("Player::action",{action:"seek",params:t})}static jump(t,e=1,r=!1){b("Player::action",{action:"jump",params:{vid:t,page:e,window:r}})}static commentTrigger(t,e=1e3){if(!c.hasObject("__player")){h("Your environment does not support player triggers.","err");return}if(e<0)return;let r=c.getObject("__player");function n(s){t(s)}a(n,"temp"),r.addEventListener("comment",n),x.timer(()=>r.removeEventListener("comment",n),e)}static keyTrigger(t,e=1e3,r=!1){if(!c.hasObject("__player")){h("Your environment does not support key triggers.","err");return}if(e<0)return;function n(m){t(m.key)}a(n,"temp");let s="key"+(r?"up":"down"),l=c.getObject("__player");l.addEventListener(s,n),x.timer(()=>l.removeEventListener(s,n),e)}static setMask(t){h("Masking not supported yet","warn")}static toString(){return"[player Player]"}};a(f,"Player"),o(f,"createSound",Ee),o(f,"state",""),o(f,"_time",""),o(f,"commentList",[]),o(f,"refreshRate",0),o(f,"width",0),o(f,"height",0),o(f,"videoWidth",0),o(f,"videoHeight",0),o(f,"version",0),o(f,"lastUpdate",new I);A("Update:DimensionUpdate",i=>{f.width=i.stageWidth,f.height=i.stageHeight,i.hasOwnProperty("videoWidth")&&i.hasOwnProperty("videoHeight")&&(f.videoWidth=i.videoWidth,f.videoHeight=i.videoHeight)});A("Update:TimeUpdate",i=>{f.state=i.state,f._time=i.time,f.lastUpdate.reset()});var y=class{constructor(t=0,e=0){this.x=t;this.y=e}set length(t){h("Point.length is read-only","err")}get length(){return Math.sqrt(this.x*this.x+this.y*this.y)}add(t){return new y(t.x+this.x,t.y+this.y)}subtract(t){return new y(this.x-t.x,this.y-t.y)}static interpolate(t,e,r){return new y((e.x-t.x)*r+t.x,(e.y-t.y)*r+t.y)}offset(t,e){this.x+=t,this.y+=e}normalize(t){let e=t/this.length;this.x*=e,this.y*=e}static polar(t,e){return new y(t*Math.cos(e),t*Math.sin(e))}setTo(t,e){this.x=t,this.y=e}equals(t){return t.x===this.x&&t.y===this.y}toString(){return"(x="+this.x+", y="+this.y+")"}clone(){return new y(this.x,this.y)}};a(y,"Point");var P=class{_data;constructor(t=1,e=0,r=0,n=1,s=0,l=0){this._data=[t,r,s,e,n,l,0,0,1]}dotProduct(t){if(t.length<9)throw new Error("Matrix dot product expects a 3x3 Matrix");let e=[0,0,0,0,0,0,0,0,0];for(let r=0;r<3;r++)for(let n=0;n<3;n++)for(let s=0;s<3;s++)e[r*3+n]+=this._data[r*3+s]*t[s*3+n];return e}setTo(t=1,e=0,r=0,n=1,s=0,l=0){this._data=[t,r,s,e,n,l,0,0,1]}translate(t,e){this._data[2]+=t,this._data[5]+=e}rotate(t){this._data=this.dotProduct([Math.cos(t),-Math.sin(t),0,Math.sin(t),Math.cos(t),0,0,0,1])}scale(t,e){this._data=this.dotProduct([t,0,0,0,e,0,0,0,1])}identity(){this.setTo(1,0,0,1,0,0)}createGradientBox(t,e,r,n,s){this.createBox(t,e,r,n,s)}createBox(t,e,r,n,s){this.identity(),this.rotate(r),this.scale(t,e),this.translate(n,s)}clone(){let t=this._data[0],e=this._data[3],r=this._data[1],n=this._data[4],s=this._data[2],l=this._data[5];return new P(t,e,r,n,s,l)}serialize(){return this._data}};a(P,"Matrix");var C=class{_data;constructor(t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){t.length===16?this._data=t:t.length===0?this.identity():(h("Matrix3D initialization vector invalid","warn"),this.identity())}dotProduct(t,e){if(t.length!==16||e.length!==16)throw new Error("Matrix3D dot product expects a 4xr Matrix3D");let r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(let n=0;n<4;n++)for(let s=0;s<4;s++)for(let l=0;l<4;l++)r[n*4+s]+=t[n*4+l]*e[l*4+s];return r}rotationMatrix(t,e){let r=Math.sin(t),n=Math.cos(t);return[n+e.x*e.x*(1-n),e.x*e.y*(1-n)-e.z*r,e.x*e.z*(1-n)+e.y*r,0,e.x*e.y*(1-n)+e.z*r,n+e.y*e.y*(1-n),e.y*e.z*(1-n)-e.x*r,0,e.z*e.x*(1-n)-e.y*r,e.z*e.y*(1-n)+e.x*r,n+e.z*e.z*(1-n),0,0,0,0,1]}identity(){this._data=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}append(t){this._data=this.dotProduct(t._data,this._data)}appendRotation(t,e,r){r&&this.appendTranslation(r.x,r.y,r.z),this._data=this.dotProduct(this.rotationMatrix(t*Math.PI/180,e),this._data),r&&this.appendTranslation(-r.x,-r.y,-r.z)}appendTranslation(t,e,r){this._data=this.dotProduct([1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1],this._data)}appendScale(t=1,e=1,r=1){this._data=this.dotProduct([t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1],this._data)}prepend(t){this._data=this.dotProduct(this._data,t._data)}prependRotation(t,e,r){r&&this.prependTranslation(r.x,r.y,r.z),this._data=this.dotProduct(this._data,this.rotationMatrix(t*Math.PI/180,e)),r&&this.prependTranslation(-r.x,-r.y,-r.z)}prependTranslation(t,e,r){this._data=this.dotProduct(this._data,[1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1])}prependScale(t,e,r){this._data=this.dotProduct(this._data,[t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1])}transformVector(t){let e=this._data[0]*t.x+this._data[1]*t.y+this._data[2]*t.z+this._data[3]*t.w,r=this._data[4]*t.x+this._data[5]*t.y+this._data[6]*t.z+this._data[7]*t.w,n=this._data[8]*t.x+this._data[9]*t.y+this._data[10]*t.z+this._data[11]*t.w,s=this._data[12]*t.x+this._data[13]*t.y+this._data[14]*t.z+this._data[15]*t.w;return new O(e,r,n,s)}transformVectors(t,e){if(t.length%3!==0){h("Matrix3D.transformVectors expects input size to be multiple of 3.","err");return}for(let r=0;r<t.length/3;r++){let n=t[r*3],s=t[r*3+1],l=t[r*3+2],m=this._data[0]*n+this._data[1]*s+this._data[2]*l,d=this._data[4]*n+this._data[5]*s+this._data[6]*l,p=this._data[8]*n+this._data[9]*s+this._data[10]*l;e.push(m,d,p)}}transpose(){this._data=[this._data[0],this._data[4],this._data[8],this._data[12],this._data[1],this._data[5],this._data[9],this._data[13],this._data[2],this._data[6],this._data[10],this._data[14],this._data[3],this._data[7],this._data[11],this._data[15]]}clone(){return new C(this._data)}serialize(){return this._data}};a(C,"Matrix3D");var ht=class{constructor(t=0,e=0,r=0,n=0){this.x=t;this.y=e;this.z=r;this.w=n}toString(){return"(x="+this.x+", y="+this.y+", z="+this.z+", w="+this.w+")"}},O=ht;a(O,"Vector3D"),o(O,"X_AXIS",new ht(1,0,0)),o(O,"Y_AXIS",new ht(0,1,0)),o(O,"Z_AXIS",new ht(0,0,1));function Jt(i,t,e,r,n,s){return new P(i,t,e,r,n,s)}a(Jt,"createMatrix");function \$t(i){return new C(i)}a(\$t,"createMatrix3D");function Qt(i,t,e,r,n){let s=new P;return s.createGradientBox(i/1638.4,t/1638.4,e,r+i/2,n+t/2),s}a(Qt,"createGradientBox");function te(i=0,t=0,e=0,r=0){return new O(i,t,e,r)}a(te,"createVector3D");function ee(i,t){return i.transformVector(t)}a(ee,"projectVector");function re(i,t,e,r){for(;e.length>0;)e.pop();if(t.length%3!==0){h("Display.projectVectors input vertex Vector must be a multiple of 3.","err");return}let n=[];i.transformVectors(t,n);for(let s=0;s<n.length/3;s++){let l=n[s*3],m=n[s*3+1];e.push(l,m)}}a(re,"projectVectors");function bt(i=0,t=0){return new y(i,t)}a(bt,"createPoint");function ie(i){return Object.defineProperty(i,"as3Type",{get:function(){return"Vector<int>"},set:function(t){h("as3Type should not be set.","warn")}}),i.map(Math.floor)}a(ie,"toIntVector");function ne(i){return Object.defineProperty(i,"as3Type",{get:function(){return"Vector<number>"},set:function(t){h("as3Type should not be set.","warn")}}),i}a(ne,"toNumberVector");var Y=class{constructor(t=1,e=1,r=1,n=1,s=0,l=0,m=0,d=0){this.redMultiplier=t;this.greenMultiplier=e;this.blueMultiplier=r;this.alphaMultiplier=n;this.redOffset=s;this.greenOffset=l;this.blueOffset=m;this.alphaOffset=d}get color(){return this.redOffset<<16|this.greenOffset<<8|this.blueOffset}set color(t){this.redOffset=t>>16&255,this.greenOffset=t>>8&255,this.blueOffset=t&255,this.redMultiplier=0,this.greenMultiplier=0,this.blueMultiplier=0}concat(t){this.redMultiplier*=t.redMultiplier,this.greenMultiplier*=t.greenMultiplier,this.blueMultiplier*=t.blueMultiplier,this.alphaMultiplier*=t.alphaMultiplier,this.redOffset+=t.redOffset,this.greenOffset+=t.greenOffset,this.blueOffset+=t.blueOffset,this.alphaOffset+=t.alphaOffset}serialize(){return{class:"ColorTransform",red:{offset:this.redOffset,multiplier:this.redMultiplier},green:{offset:this.greenOffset,multiplier:this.greenMultiplier},blue:{offset:this.blueOffset,multiplier:this.blueMultiplier},alpha:{offset:this.alphaOffset,multiplier:this.alphaMultiplier}}}};a(Y,"ColorTransform");function se(i=1,t=1,e=1,r=1,n=0,s=0,l=0,m=0){return new Y(i,t,e,r,n,s,l,m)}a(se,"createColorTransform");var X=class{fieldOfView=55;projectionCenter=new y(0,0);focalLength=0;constructor(t){t&&(this.projectionCenter=new y(t.width/2,t.height/2),this.fieldOfView=55,this.focalLength=t.width/2/Math.tan(this.fieldOfView/2))}toMatrix3D(){return new C}clone(){let t=new X;return t.fieldOfView=this.fieldOfView,t.projectionCenter=this.projectionCenter,t.focalLength=this.focalLength,t}};a(X,"PerspectiveProjection");var V=class{constructor(t){this.parent=t}_matrix=new P;_matrix3d;_perspectiveProjection;_colorTransform;set perspectiveProjection(t){this._perspectiveProjection=t}get perspectiveProjection(){return typeof this._perspectiveProjection>"u"&&(this._perspectiveProjection=new X(this.parent)),this._perspectiveProjection}set colorTransform(t){this._colorTransform=t}get colorTransform(){return typeof this._colorTransform>"u"&&(this._colorTransform=new Y),this._colorTransform}set matrix3D(t){if(t===null){if(this._matrix3d===null)return;this._matrix3d=null,this._matrix=new P}else this._matrix=null,this._matrix3d=t;this.update()}set matrix(t){if(t===null){if(this._matrix===null)return;this._matrix=null,this._matrix3d=new C}else this._matrix3d=null,this._matrix=t;this.update()}get matrix3D(){return this._matrix3d}get matrix(){return this._matrix}box3d(t=1,e=1,r=1,n=0,s=0,l=0,m=0,d=0,p=0){(this._matrix||!this._matrix3d)&&(this._matrix=void 0,this._matrix3d=new C),this._matrix3d.identity(),this._matrix3d.appendRotation(n,O.X_AXIS),this._matrix3d.appendRotation(s,O.Y_AXIS),this._matrix3d.appendRotation(l,O.Z_AXIS),this._matrix3d.appendScale(t,e,r),this._matrix3d.appendTranslation(m,d,p)}box(t=1,e=1,r=0,n=0,s=0){this._matrix?this._matrix.createBox(t,e,r,n,s):this.box3d(t,e,1,0,0,r,n,s,0)}update(){this.parent&&(this.parent.transform=this)}getRelativeMatrix3D(t){return h("Transform.getRelativeMatrix3D not implemented","warn"),new C}getMatrix(){return this._matrix?this._matrix:this._matrix3d}getMatrixType(){return this._matrix?"2d":"3d"}clone(){let t=new V;return t._matrix=this._matrix,t._matrix3d=this._matrix3d,t}serialize(){return{mode:this.getMatrixType(),matrix:this.getMatrix()?.serialize()}}};a(V,"Transform");var kt=(_=>(_.ADD="add",_.ALPHA="alpha",_.DARKEN="darken",_.DIFFERENCE="difference",_.ERASE="erase",_.HARDLIGHT="hardlight",_.INVERT="invert",_.LAYER="layer",_.LIGHTEN="lighten",_.MULTIPLY="multiply",_.NORMAL="normal",_.OVERLAY="overlay",_.SCREEN="screen",_.SHADER="shader",_.SUBTRACT="subtract",_))(kt||{}),w=class{constructor(t=0,e=0,r=0,n=0){this.x=t;this.y=e;this.width=r;this.height=n}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}get size(){return bt(this.width,this.height)}contains(t,e){return t>=this.left&&e>=this.top&&t<=this.right&&e<=this.bottom}containsPoint(t){return this.contains(t.x,t.y)}containsRect(t){return this.contains(t.left,t.top)&&this.contains(t.right,t.bottom)}copyFrom(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}equals(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}inflate(t=0,e=0){this.x-=t,this.width+=2*t,this.y-=e,this.height+=2*e}inflatePoint(t){this.inflate(t.x,t.y)}isEmpty(){return this.width<=0||this.height<=0}setTo(t=0,e=0,r=0,n=0){this.x=t,this.y=e,this.width=r,this.height=n}offset(t=0,e=0){this.x+=t,this.y+=e}offsetPoint(t){this.offset(t.x,t.y)}setEmpty(){this.setTo(0,0,0,0)}unionCoord(t,e){let r=t-this.x,n=e-this.y;r>=0?this.width=Math.max(this.width,r):(this.x+=r,this.width-=r),n>=0?this.height=Math.max(this.height,n):(this.y+=n,this.height-=n)}unionPoint(t){this.unionCoord(t.x,t.y)}union(t){let e=this.clone();return e.unionCoord(t.left,t.top),e.unionCoord(t.right,t.bottom),e}toString(){return"(x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+")"}clone(){return new w(this.x,this.y,this.width,this.height)}serialize(){return{x:this.x,y:this.y,width:this.width,height:this.height}}};a(w,"Rectangle");var _t=class{constructor(t=c.generateId(),e=!0){this.id=t;this._visible=e}_alpha=1;_anchor=new y;_boundingBox=new w;_z=0;_scaleX=1;_scaleY=1;_scaleZ=1;_rotationX=0;_rotationY=0;_rotationZ=0;_filters=[];_blendMode="normal";_listeners={};_parent;_name="";_children=[];_transform=new V(this);_hasSetDefaults=!1;setDefaults(t={}){if(this._hasSetDefaults){h("DisplayObject.setDefaults called more than once.","warn");return}this._hasSetDefaults=!0;try{if(t.hasOwnProperty("motion")){let e=t.motion;e.hasOwnProperty("alpha")&&(this._alpha=e.alpha.fromValue),e.hasOwnProperty("x")&&(this._anchor.x=e.x.fromValue),e.hasOwnProperty("y")&&(this._anchor.y=e.y.fromValue)}else if(t.hasOwnProperty("motionGroup")&&t.motionGroup&&t.motionGroup.length>0){let e=t.motionGroup[0];e.hasOwnProperty("alpha")&&(this._alpha=e.alpha.fromValue),e.hasOwnProperty("x")&&(this._anchor.x=e.x.fromValue),e.hasOwnProperty("y")&&(this._anchor.y=e.y.fromValue)}}catch{}t.hasOwnProperty("alpha")&&(this._alpha=t.alpha),t.hasOwnProperty("x")&&(this._anchor.x=t.x),t.hasOwnProperty("y")&&(this._anchor.y=t.y)}eventToggle(t,e="enable"){_t.SANDBOX_EVENTS.indexOf(t)>-1||b("Runtime:ManageEvent",{id:this.id,name:t,mode:e})}propertyUpdate(t,e){b("Runtime:UpdateProperty",{id:this.id,name:t,value:e})}methodCall(t,e){b("Runtime:CallMethod",{id:this.id,method:t,params:e})}set alpha(t){this._alpha=t,this.propertyUpdate("alpha",t)}get alpha(){return this._alpha}set anchor(t){this._anchor=t,this.propertyUpdate("x",t.x),this.propertyUpdate("y",t.y)}get anchor(){return this._anchor}set boundingBox(t){this._boundingBox=t,this.propertyUpdate("boundingBox",t.serialize())}get boundingBox(){return this._boundingBox}set cacheAsBitmap(t){h("DisplayObject.cacheAsBitmap is not supported","warn")}get cacheAsBitmap(){return!1}set filters(t){this._filters=t||[];let e=[];for(let r=0;r<this._filters.length;r++)this.filters[r]&&e.push(this._filters[r].serialize());this.propertyUpdate("filters",e)}get filters(){return this._filters}get root(){return u.root}set root(t){h("DisplayObject.root is read-only.","warn")}get stage(){return u.root}set stage(t){h("DisplayObject.stage is read-only.","warn")}_updateBox(t=this._transform.getMatrixType()){t==="3d"?this._transform.box3d(this._scaleX,this._scaleY,this._scaleZ,this._rotationX,this._rotationY,this._rotationZ,0,0,this._z):this._transform.box(this._scaleX,this._scaleY,this._rotationZ*Math.PI/180),this.transform=this._transform}set rotationX(t){this._rotationX=t,this._updateBox("3d")}set rotationY(t){this._rotationY=t,this._updateBox("3d")}set rotationZ(t){this._rotationZ=t,this._updateBox()}set rotation(t){this._rotationZ=t,this._updateBox()}set scaleX(t){this._scaleX=t,this._updateBox()}set scaleY(t){this._scaleY=t,this._updateBox()}set scaleZ(t){this._scaleZ=t,this._updateBox("3d")}set x(t){this._anchor.x=t,this.propertyUpdate("x",t)}set y(t){this._anchor.y=t,this.propertyUpdate("y",t)}set z(t){this._z=t,this._updateBox("3d")}get rotationX(){return this._rotationX}get rotationY(){return this._rotationY}get rotationZ(){return this._rotationZ}get rotation(){return this._rotationZ}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get scaleZ(){return this._scaleZ}get x(){return this._anchor.x}get y(){return this._anchor.y}get z(){return this._z}set width(t){this._boundingBox.width=t,this.propertyUpdate("width",t)}get width(){return this._boundingBox.width}set height(t){this._boundingBox.height=t,this.propertyUpdate("height",t)}get height(){return this._boundingBox.height}set visible(t){this._visible=t,this.propertyUpdate("visible",t)}get visible(){return this._visible}set blendMode(t){this._blendMode=t,this.propertyUpdate("blendMode",t)}get blendMode(){return this._blendMode}set transform(t){this._transform=t,this._transform.parent!==this&&(this._transform.parent=this),this.propertyUpdate("transform",this._transform.serialize())}get transform(){return this._transform}set name(t){this._name=t,this.propertyUpdate("name",t)}get name(){return this._name}set loaderInfo(t){h("DisplayObject.loaderInfo is read-only","warn")}get loaderInfo(){return h("DisplayObject.loaderInfo is not supported","warn"),{}}set parent(t){h("DisplayObject.parent is read-only","warn")}get parent(){return this._parent??u.root}get video(){return f}dispatchEvent(t,e){if(this._listeners.hasOwnProperty(t)&&this._listeners[t])for(let r=0;r<this._listeners[t].length;r++)try{this._listeners[t][r](e)}catch(n){n.hasOwnProperty("stack")?h(n.stack?.toString(),"err"):h(n.toString(),"err")}}addEventListener(t,e){this._listeners.hasOwnProperty(t)||(this._listeners[t]=[]),this._listeners[t].push(e),this._listeners[t].length===1&&this.eventToggle(t,"enable")}removeEventListener(t,e){if(!this._listeners.hasOwnProperty(t)||this._listeners[t].length===0)return;let r=this._listeners[t].indexOf(e);r>=0&&this._listeners[t].splice(r,1),this._listeners[t].length===0&&this.eventToggle(t,"disable")}get numChildren(){return this._children.length}addChild(t){if(typeof t>"u"||t===null)throw new Error("Cannot add an empty child!");if(t.contains(this))throw new Error("Attempting to add an ancestor of this DisplayObject as a child!");this._children.push(t),this._boundingBox.unionCoord(t._anchor.x+t._boundingBox.left,t._anchor.y+t._boundingBox.top),this._boundingBox.unionCoord(t._anchor.x+t._boundingBox.right,t._anchor.y+t._boundingBox.bottom),t._parent=this,this.methodCall("addChild",t.id)}removeChild(t){let e=this._children.indexOf(t);e>=0&&this.removeChildAt(e)}getChildAt(t){if(t<0||t>this._children.length)throw new RangeError("No child at index "+t);return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}removeChildAt(t){let e=this.getChildAt(t);this._children.splice(t,1),e._parent=null,this.methodCall("removeChild",e.id)}removeChildren(t,e=this._children.length){let r=this._children.splice(t,e-t),n=[];for(let s=0;s<r.length;s++)r[s]._parent=null,n.push(r[s].id);this.methodCall("removeChildren",n)}contains(t){if(t===this||this._children.indexOf(t)>=0)return!0;for(let e=0;e<this._children.length;e++)if(this._children[e].contains(t))return!0;return!1}remove(){this._parent?this._parent.removeChild(this):this.root.removeChild(this)}toString(){return"["+(this._name.length>0?this._name:"displayObject")+" DisplayObject]@"+this.id}clone(){let t=new _t;return t._transform=this._transform.clone(),t._transform.parent=t,t._boundingBox=this._boundingBox.clone(),t._anchor=this._anchor.clone(),t._alpha=this._alpha,t}hasOwnProperty(t){return t==="clone"?!0:Object.prototype.hasOwnProperty.call(this,t)}serialize(){this._hasSetDefaults=!0;let t=[];for(let e=0;e<this._filters.length;e++)t.push(this._filters[e].serialize());return{class:"DisplayObject",x:this._anchor.x,y:this._anchor.y,alpha:this._alpha,filters:t}}unload(){this._visible=!1,this.remove(),this.methodCall("unload",null)}getId(){return this.id}getRect(){return{x:this.x,y:this.y,width:this.width,height:this.height,left:0,right:0,top:0,buttom:0}}},F=_t;a(F,"DisplayObject"),o(F,"SANDBOX_EVENTS",["enterFrame"]);var xt=class{xBegin;yBegin;xEnd;yEnd;expand(t,e){this.xBegin=this.xBegin===null?t:Math.min(this.xBegin,t),this.xEnd=this.xEnd===null?t:Math.max(this.xEnd,t),this.yBegin=this.yBegin===null?e:Math.min(this.yBegin,e),this.yEnd=this.xEnd===null?e:Math.max(this.yEnd,e)}asRect(){return this.isEmpty()?new w(0,0,0,0):new w(this.xBegin,this.yBegin,this.xEnd-this.xBegin,this.yEnd-this.yBegin)}isEmpty(){return this.xBegin??this.yBegin??this.xEnd??this.yEnd??!0}reset(){delete this.xBegin,delete this.xEnd,delete this.yBegin,delete this.yEnd}};a(xt,"DirtyArea");var Z=class extends F{constructor(e){super(c.generateId("obj-bmp"));this.bitmapData=e}get width(){return this.bitmapData?this.bitmapData.width*this.scaleX:0}get height(){return this.bitmapData?this.bitmapData.height*this.scaleY:0}set width(e){this.bitmapData&&this.bitmapData.width>0&&(this.scaleX=e/this.bitmapData.width)}set height(e){this.bitmapData&&this.bitmapData.height>0&&(this.scaleY=e/this.bitmapData.height)}getBitmapData(){return this.bitmapData}setBitmapData(e){typeof e<"u"&&(this.bitmapData=e,this.methodCall("setBitmapData",e.getId()))}serialize(){let e=super.serialize();return e.class="Bitmap",this.bitmapData!==null&&(e.bitmapData=this.bitmapData?.getId()),e}};a(Z,"Bitmap");var q=class{constructor(t,e,r=!0,n=4294967295,s=c.generateId("obj-bmp-data")){this.transparent=r;this.fillColor=n;this.id=s;this.rect=new w(0,0,t,e),this._fill(),c.registerObject(this)}rect;locked=!1;dirtyArea=new xt;byteArray=[];_fill(){this.byteArray=[];for(let t=0;t<this.rect.width*this.rect.height;t++)this.byteArray.push(this.fillColor)}_updateBox(t){if(this.dirtyArea.isEmpty()||this.locked)return;let e=t??this.dirtyArea.asRect();if(!this.rect.containsRect(e))throw h("BitmapData._updateBox box "+e.toString()+" out of bonunds "+this.rect.toString(),"err"),new Error("Rectangle provided was not within image bounds.");let r=[];for(let n=0;n<e.height;n++)for(let s=0;s<e.width;s++)r.push(this.byteArray[(e.y+n)*this.rect.width+e.x+s]);this._methodCall("updateBox",{box:e.serialize(),values:r}),this.dirtyArea.reset()}_methodCall(t,e){b("Runtime:CallMethod",{id:this.id,method:t,params:e})}get height(){return this.rect.height}get width(){return this.rect.width}set height(t){h("BitmapData.height is read-only","warn")}set width(t){h("BitmapData.height is read-only","warn")}draw(t,e,r,n,s,l=!1){if(!(t instanceof q)){h("Drawing non BitmapData is not supported!","err");return}e&&h("Matrix transforms not supported yet.","warn"),r&&h("Color transforms not supported yet.","warn"),n&&n!=="normal"&&h("Blend mode ["+n+"] not supported yet.","warn"),l!==!1&&h("Smoothign not supported!","warn"),this.lock(),s&&(s=new w(0,0,t.width,t.height)),this.setPixels(s,t.getPixels(s)),this.unlock()}getPixel(t,e){return this.getPixel32(t,e)&16777215}getPixel32(t,e){if(t>=this.rect.width||e>=this.rect.height||t<0||e<0)throw new Error("Coordinates out of bounds");try{return this.transparent?this.byteArray[e*this.rect.width+t]:(this.byteArray[e*this.rect.width+t]&16777215)+4278190080}catch{return this.fillColor}}getPixels(t){if(typeof t>"u"||t===null)throw new Error("Expected a region to acquire pixels.");if(t.width===0||t.height===0)return new S;let e=new S;for(let r=0;r<t.height;r++)this.byteArray.slice((t.y+r)*this.rect.width+t.x,(t.y+r)*this.rect.width+t.x+t.width).forEach(function(n){e.push(n)});return e}setPixel(t,e,r){this.setPixel32(t,e,(r&16777215)+4278190080)}setPixel32(t,e,r){this.transparent||(r=(r&16777215)+4278190080),this.byteArray[e*this.rect.width+t]=r,this.dirtyArea.expand(t,e),this._updateBox()}setPixels(t,e){if(!(t.width===0||t.height===0)){if(e.length!==t.width*t.height)throw new Error("setPixels expected "+t.width*t.height+" pixels, but actually got "+e.length);this.transparent||(e=e.map(function(r){return(r&16777215)+4278190080}));for(let r=0;r<t.width;r++)for(let n=0;n<t.height;n++)this.byteArray[(t.y+n)*this.width+(t.x+r)]=e[n*t.width+r],this.dirtyArea.expand(r,n);this._updateBox()}}getVector(t){if(this.rect.equals(t))return this.byteArray;let e=[];for(let r=t.y;r<t.y+t.height;r++)for(let n=t.x;n<t.x+t.width;n++)e.push(t[r*this.rect.width+n]);return e}lock(){this.locked=!0}unlock(t){this.locked=!1,t?this._updateBox(t):this._updateBox()}dispatchEvent(t,e){}getId(){return this.id}serialize(){return{class:"BitmapData",width:this.rect.width,height:this.rect.height,fill:this.fillColor}}unload(){this._methodCall("unload",void 0)}clone(){let t=new q(this.width,this.height,this.transparent,this.fillColor);return t.byteArray=this.byteArray.slice(0),t._updateBox(t.rect),t}};a(q,"BitmapData");function yt(i,t,e,r){return i*e/r+t}a(yt,"linear");function At(i,t,e,r){return i/=r/2,i<1?e/2*i*i+t:(i--,-e/2*(i*(i-2)-1)+t)}a(At,"quadratic");function wt(i,t,e,r){return i/=r/2,i<1?e/2*i*i*i+t:(i-=2,e/2*(i*i*i+2)+t)}a(wt,"cubic");function Dt(i,t,e,r){return i/=r/2,i<1?e/2*i*i*i*i+t:(i-=2,-e/2*(i*i*i*i-2)+t)}a(Dt,"quartic");function Mt(i,t,e,r){return i/=r/2,i<1?e/2*i*i*i*i*i+t:(i-=2,e/2*(i*i*i*i*i+2)+t)}a(Mt,"quintic");function Tt(i,t,e,r){return i/=r/2,i<1?-e/2*(Math.sqrt(1-i*i)-1)+t:(i-=2,e/2*(Math.sqrt(1-i*i)+1)+t)}a(Tt,"circular");function vt(i,t,e,r){return-e/2*(Math.cos(Math.PI*i/r)-1)+t}a(vt,"sine");function Ot(i,t,e,r){return i/=r/2,i<1?e/2*Math.pow(2,10*(i-1))+t:(i--,e/2*(-Math.pow(2,-10*i)+2)+t)}a(Ot,"exponential");function Rt(i){let t={linear:yt,back:null,bounce:null,circular:Tt,cubic:wt,elastic:null,exponential:Ot,sine:vt,quintic:Mt};for(let e in t)i[e]=t[e]}a(Rt,"extendWithEasingFunctions");function ae(i="None"){switch(i=i.toLowerCase(),i){case"none":case"linear":default:return yt;case"exponential":return Ot;case"circular":return Tt;case"quadratic":return At;case"cubic":return wt;case"quartic":return Dt;case"quintic":return Mt;case"sine":return vt}}a(ae,"getEasingFuncByName");var M=class{constructor(t,e=0){this.target=t;this.duration=e;this.timer.addEventListener("timer",()=>{this._onTimerEvent()})}isPlaying=!1;position=0;repeats=0;timeKeeper=new I;timer=new E(40);easing=g.linear;step=()=>{};lastSeek;_onTimerEvent(){this.isPlaying&&(this.position+=this.timeKeeper.elapsed,this.timeKeeper.reset(),this.step(this.target,this.position,this.duration),this.position>=this.duration&&(this.repeats--,this.repeats<0?(this.stop(),this.position=this.duration):this.position=0,this.step(this.target,this.position,this.duration)))}clone(){let t=new M(this.target,this.duration);return t.easing=this.easing,t.step=this.step,t}scale(t){this.position*=t,this.duration*=t}play(){this.isPlaying||this.gotoAndPlay(this.position)}stop(){this.isPlaying&&this.gotoAndStop(this.position)}gotoAndStop(t){this.position=t,this.isPlaying&&(this.isPlaying=!1,this.timer.stop()),this.step(this.target,this.position,this.duration)}gotoAndPlay(t){this.position=t,this.isPlaying||(this.isPlaying=!0,this.timer.start()),this.step(this.target,this.position,this.duration)}togglePause(){this.isPlaying?this.stop():this.play()}addEventListener(t,e){if(t==="complete")return this.timer.addEventListener("timerComplete",e),!0}dispatchEvent(t){return this.timer.dispatchEvent(t),!0}hasEventListener(t){return!0}removeEventListener(t,e){return!0}};a(M,"ITween");function Ie(i,t,e,r){for(let n in t)e.hasOwnProperty(n)||(e[n]=i[n]);for(let n in e)t.hasOwnProperty(n)||(t[n]=e[n]);return function(n,s,l){for(let m in e)e.hasOwnProperty(m)&&(n[m]=r.easing(s,e[m],t[m]-e[m],l))}}a(Ie,"createStepFunction");var zt=class{static tween(t,e={},r={},n=0,s){let l=new M(t,n*1e3);return l.step=Ie(t,e,r,l),s&&(l.easing=s),l}static to(t,e={},r=0,n){let s={};for(let l in e)e.hasOwnProperty(l)&&(typeof t[l]<"u"?s[l]=t[l]:s[l]=0);return zt.tween(t,e,s,r,n)}static bezier(t,e,r,n,s=1,l){let m=new M(t,s*1e3);l&&typeof l=="function"&&(m.easing=l);let d={};for(let p in n)Array.isArray(n[p])&&n[p].length>0&&(d[p]=n[p]);(typeof r>"u"||r===null)&&(r={}),(typeof e>"u"||e===null)&&(e={});for(let p in d)p in r||(r[p]=m.target[p]),p in e||(e[p]=d[p][d[p].length-1]);return m.step=function(p,v,et){let H=Math.min(m.easing(v,0,1,et),1);for(let j in d){let B=d[j],_=B.length,k=Math.floor(H*_),mt=(H-k/_)*_;if(_===1)p[j]=r[j]+2*H*(1-H)*(B[0]-r[j])+H*H*(e[j]-r[j]);else{let rt=0,pt=0;k===0?(rt=r[j],pt=(B[0]+B[1])/2):k===_-1?(rt=(B[k-1]+B[k])/2,pt=e[j]):(rt=(B[k-1]+B[k])/2,pt=(B[k]+B[k+1])/2),p[j]=rt+2*mt*(1-mt)*(B[k]-rt)+mt*mt*(pt-rt)}}},m}static scale(t,e){let r=t.clone();return r.scale(e),r}static delay(t,e){let r=new M(t.target,t.duration+e*1e3);return r.step=function(n,s,l){s<=e*1e3||t.step(n,s-e*1e3,l-e*1e3)},r}static reverse(t){let e=new M(t.target,t.duration);return e.step=function(r,n,s){t.step(r,s-n,s)},e}static repeat(t,e){let r=new M(t.target,t.duration*e);return r.step=function(n,s,l){t.step(n,s%t.duration,t.duration)},r}static slice(t,e,r){r===null&&(r=t.duration),r<e&&(r=e),e*=1e3,r*=1e3;let n=new M(t.target,r-e);return n.step=function(s,l,m){t.step(s,e+l,t.duration)},n}static serial(...t){if(t.length===0)return new M({},0);let e=0,r=[],n=[];for(let l=0;l<t.length;l++)n.push(e),e+=t[l].duration,r.push(e);let s=new M({},e);return s.lastSeek=0,s.step=function(l,m,d){if(m<=r[s.lastSeek]){let p=t[s.lastSeek];p.step(p.target,m-n[s.lastSeek],p.duration);return}else{let p=t[s.lastSeek];p.step(p.target,p.duration,p.duration)}for(let p=0;p<r.length;p++)if(m<r[p]){s.lastSeek=p;let v=t[s.lastSeek];v.step(v.target,m-n[s.lastSeek],v.duration);return}},s}static parallel(...t){let e=0;for(let s=0;s<t.length;s++)e=Math.max(t[s].duration,e);let r=t,n=new M({},e);return n.step=function(s,l,m){for(let d=0;d<r.length;d++)r[d].step(r[d].target,Math.min(l,r[d].duration),r[d].duration)},n}},g=zt;a(g,"Tween"),o(g,"linear",yt),o(g,"quadratic",At),o(g,"cubic",wt),o(g,"quartic",Dt),o(g,"quintic",Mt),o(g,"circular",Tt),o(g,"sine",vt),o(g,"exponential",Ot),o(g,"extendWithEasingFunctions",Rt),o(g,"getEasingFuncByName",ae),o(g,"ITween",M);Rt(self);var T=class{_isRunning=!1;_ttl;_dur;_parent;_timer;_timeKeeper;_independentTimer;_tween;oncomplete;constructor(t,e=1e3,r=!1){if(typeof t>"u"||t===null)throw new Error("MotionManager must be bound to a DisplayObject.");this._ttl=e,this._dur=e,this._parent=t,this._independentTimer=r,this._timeKeeper=new I;let n=this;this._independentTimer?(this._timer=new E(41,0),this._timer.addEventListener("timer",()=>{n._onTimerEvent()}),this._timer.start()):this._parent.addEventListener("enterFrame",()=>{n._onTimerEvent()})}set dur(t){this._timeKeeper.reset(),this._ttl=t,this._dur=t}get dur(){return this._dur}get running(){return this._isRunning}_onTimerEvent(){this._isRunning&&this._dur!==0&&(this._ttl-=this._timeKeeper.elapsed,this._timeKeeper.reset(),this._ttl<=0&&(this.stop(),typeof this.oncomplete=="function"&&this.oncomplete(),this._parent.unload()))}reset(){this._ttl=this._dur,this._timeKeeper.reset()}play(){this._isRunning||this._dur===0||this._ttl<=0||(this._isRunning=!0,this._timeKeeper.reset(),this._tween&&this._tween.play())}stop(){this._isRunning&&(this._isRunning=!1,this._timeKeeper.reset(),this._tween&&this._tween.stop())}forecasting(t){return h("MotionManager.forecasting always returns false","warn"),!1}setPlayTime(t){this._ttl=this._dur-t,this._tween&&(this._isRunning?this._tween.gotoAndPlay(t):this._tween.gotoAndStop(t))}motionSetToTween(t){let e=[];for(let r in t){if(!t.hasOwnProperty(r))continue;let n=t[r];if(!n.hasOwnProperty("fromValue"))continue;n.hasOwnProperty("toValue")||(n.toValue=n.fromValue),n.hasOwnProperty("lifeTime")||(n.lifeTime=this._dur);let s={},l={};s[r]=n.fromValue,l[r]=n.toValue,typeof n.easing=="string"&&(n.easing=g.getEasingFuncByName(n.easing)),n.hasOwnProperty("startDelay")?e.push(g.delay(g.tween(this._parent,l,s,n.lifeTime,n.easing),n.startDelay/1e3)):e.push(g.tween(this._parent,l,s,n.lifeTime,n.easing))}return g.parallel.apply(g,e)}initTween(t,e){this._tween=this.motionSetToTween(t)}initTweenGroup(t,e){let r=[];for(let n=0;n<t.length;n++)r.push(this.motionSetToTween(t[n]));this._tween=g.serial.apply(g,r)}setCompleteListener(t){this.oncomplete=t}};a(T,"MotionManager");var J=class extends Z{_mM=new T(this);constructor(t){super("bitmapData"in t?t.bitmapData:void 0),this.initStyle(t),c.registerObject(this),this.bindParent(t),this._mM.play()}get motionManager(){return this._mM}set motionManager(t){h("IComment.motionManager is read-only","warn")}bindParent(t){"parent"in t&&t.parent?.addChild(this)}initStyle(t){(typeof t>"u"||t===null)&&(t={}),"lifeTime"in t&&(this._mM.dur=t.lifeTime*1e3)}static createBitmap(t){return Vt(t)}static createParticle(t){return Lt(t)}static createBitmapData(t,e,r,n){return r===void 0&&(r=!0),n===void 0&&(n=4294967295),Ut(t,e,r,n)}static createRectangle(t,e,r,n){return new w(t,e,r,n)}};a(J,"CommentBitmap");function Vt(i){return new J(i)}a(Vt,"createBitmap");function Lt(i){return h("Bitmap.createParticle not implemented","warn"),new J(i)}a(Lt,"createParticle");function Ut(i,t,e=!0,r=4294967295){return new u.BitmapData(i,t,e,r)}a(Ut,"createBitmapData");var L=class{constructor(t){this.parent=t}lineWidth=1;_evaluateBoundingBox(t,e){this.parent.boundingBox.unionCoord(t+this.lineWidth/2,e+this.lineWidth/2)}_callDrawMethod(t,e){b("Runtime:CallMethod",{id:this.parent.getId(),context:"graphics",method:t,params:e})}lineTo(t,e){this._evaluateBoundingBox(t,e),this._callDrawMethod("lineTo",[t,e])}moveTo(t,e){this._evaluateBoundingBox(t,e),this._callDrawMethod("moveTo",[t,e])}curveTo(t,e,r,n){this._evaluateBoundingBox(r,n),this._evaluateBoundingBox(t,e),this._callDrawMethod("curveTo",[t,e,r,n])}cubicCurveTo(t,e,r,n,s,l){this._evaluateBoundingBox(t,e),this._evaluateBoundingBox(r,n),this._evaluateBoundingBox(s,l),this._callDrawMethod("cubicCurveTo",[t,e,r,n,s,l])}lineStyle(t,e=0,r=1,n=!1,s="normal",l="none",m="round",d=3){this.lineWidth=t,this._callDrawMethod("lineStyle",[t,e,r,l,m,d])}drawRect(t,e,r,n){this._evaluateBoundingBox(t,e),this._evaluateBoundingBox(t+r,e+n),this._callDrawMethod("drawRect",[t,e,r,n])}drawCircle(t,e,r){this._evaluateBoundingBox(t-r,e-r),this._evaluateBoundingBox(t+r,e+r),this._callDrawMethod("drawCircle",[t,e,r])}drawEllipse(t,e,r,n){this._evaluateBoundingBox(t-r/2,e-n/2),this._evaluateBoundingBox(t+r/2,e+n/2),this._callDrawMethod("drawEllipse",[t+r/2,e+n/2,r/2,n/2])}drawRoundRect(t,e,r,n,s,l){this._evaluateBoundingBox(t,e),this._evaluateBoundingBox(t+r,e+n),this._callDrawMethod("drawRoundRect",[t,e,r,n,s,l])}drawPath(t,e,r="evenOdd"){this._callDrawMethod("drawPath",[t,e,r])}beginFill(t,e=1){this._callDrawMethod("beginFill",[t,e])}beginGradientFill(t,e,r,n,s,l="pad",m="rgb",d=0){if(h("Graphics.beginGradientFill still needs work.","warn"),t!=="linear"&&t!=="radial"){h("Graphics.beginGradientFill unsupported fill type : "+t,"warn");return}this._callDrawMethod("beginGradientFill",[t,e,r,n,s?s.serialize:null,l,m,d])}beginShaderFill(t,e){h("Graphics.beginShaderFill not supported.","warn")}endFill(){this._callDrawMethod("endFill",[])}drawTriangles(t,e,r,n="none"){if(e)e=e.slice(0);else{e=[];for(let s=0;s<t.length;s+=2)e.push(s/2)}if(e.length%3!==0){h("Graphics.drawTriangles malformed indices count. Must be multiple of 3.","err");return}if(n!=="none")for(let s=0;s<e.length/3;s++){let l=t[2*e[s*3+1]]-t[2*e[s*3]],m=t[2*e[s*3+1]+1]-t[2*e[s*3]+1],d=t[2*e[s*3+2]]-t[2*e[s*3+1]],p=t[2*e[s*3+2]+1]-t[2*e[s*3+1]+1],v=l*p-d*m;(v<0&&n==="positive"||v>0&&n==="negative")&&(e.splice(s*3,3),s--)}for(let s=0;s<e.length;s++)this._evaluateBoundingBox(t[2*e[s]],t[2*e[s]+1]);this._callDrawMethod("drawTriangles",[t,e,n])}clear(){this.parent.boundingBox.setEmpty(),this._callDrawMethod("clear",[])}};a(L,"Graphics");var U=class extends F{_graphics;_mouseEnabled=!0;_mousePosition=new y(0,0);_useHandCursor=!1;constructor(t){super(t),this._graphics=new L(this)}get graphics(){return this._graphics}set graphics(t){h("Sprite.graphics is read-only.","warn")}get mouseEnabled(){return this._mouseEnabled}set mouseEnabled(t){this._mouseEnabled=t,this.propertyUpdate("mouseEnabled",t)}get useHandCursor(){return this._useHandCursor}set useHandCursor(t){this._useHandCursor=t,this.propertyUpdate("useHandCursor",t)}serialize(){let t=super.serialize();return t.class="Sprite",t}};a(U,"Sprite");var st=class extends U{_metaRoot;constructor(){super("__root"),this._metaRoot=c.getObject("__root")}get parent(){return h("SecurityError: No access above root sprite.","err"),null}addEventListener(t,e){h("Listener["+t+"] on root sprite inadvisible","warn"),this._metaRoot.addEventListener(t,e)}removeEventListener(t,e){this._metaRoot.removeEventListener(t,e,!1)}};a(st,"RootSprite");var \$=class extends U{_styles={};constructor(t){super(t)}clearStyle(t){delete this._styles[t]}getStyle(t){return this._styles[t]}setStyle(t,e){h("UIComponent.setStyle not implemented","warn"),this._styles[t]=e}setFocus(){this.methodCall("setFocus",null)}setSize(t,e){this.width=t,this.height=e}move(t,e){this.x=t,this.y=e}};a(\$,"UIComponent");var Ft=class extends \${mM=new T(this);label="";constructor(t){super(),this.setDefaults(t),this.initStyle(t),c.registerObject(this),this.bindParent(t),this.mM.play()}get motionManager(){return this.mM}set motionManager(t){h("IComment.motionManager is read-only","warn")}bindParent(t){t.hasOwnProperty("parent")&&t.parent?.addChild(this)}initStyle(t){(typeof t>"u"||t===null)&&(t={}),"lifeTime"in t?this.mM.dur=t.lifeTime*1e3:this.mM.dur=4e3,t.hasOwnProperty("text")&&(this.label=t.text),t.hasOwnProperty("motionGroup")?this.mM.initTweenGroup(t.motionGroup||[],this.mM.dur):t.hasOwnProperty("motion")&&this.mM.initTween(t.motion,!1)}serialize(){let t=super.serialize();return t.class="Button",t.text=this.label,t}};a(Ft,"CommentButton");function oe(i){return new Ft(i)}a(oe,"createButton");var Ct=class extends U{mM=new T(this);constructor(t){super(),this.setDefaults(t),this.initStyle(t),c.registerObject(this),this.bindParent(t),this.mM.play()}get motionManager(){return this.mM}set motionManager(t){h("IComment.motionManager is read-only","warn")}bindParent(t){t.hasOwnProperty("parent")&&t.parent?.addChild(this)}initStyle(t){t.lifeTime&&(this.mM.dur=t.lifeTime*1e3),t.hasOwnProperty("motionGroup")?this.mM.initTweenGroup(t.motionGroup||[],this.mM.dur):t.hasOwnProperty("motion")&&this.mM.initTween(t.motion,!1)}};a(Ct,"CommentCanvas");function he(i){return new Ct(i)}a(he,"createCanvas");var lt=class{constructor(t="SimHei",e=25,r=16777215,n=!1,s=!1,l=!1,m="",d="",p="left",v=0,et=0,H=0,j=0){this.font=t;this.size=e;this.color=r;this.bold=n;this.italic=s;this.underline=l}align;fontsize;serialize(){return{class:"TextFormat",font:this.font,size:this.size,color:this.color,bold:this.bold,underline:this.underline,italic:this.italic}}};a(lt,"TextFormat");var Q=class extends F{constructor(e="",r=0){super(c.generateId("obj-textfield"));this._text=e;this._textFormat.color=r,this.boundingBox.width=this.textWidth,this.boundingBox.height=this.textHeight}_textFormat=new lt;_background=!1;_backgroundColor=16777215;_border=!1;_borderColor=0;get text(){return this._text}set text(e){this._text=e,this.boundingBox.width=this.textWidth,this.boundingBox.height=this.textHeight,this.propertyUpdate("text",this._text)}get length(){return this.text.length}set length(e){h("TextField.length is read-only.","warn")}get htmlText(){return this.text}set htmlText(e){h("TextField.htmlText is restricted due to security policy.","warn"),this.text=e.replace(/<\\/?[^>]+(>|\$)/g,"")}set textWidth(e){h("TextField.textWidth is read-only","warn")}set textHeight(e){h("TextField.textHeight is read-only","warn")}get textWidth(){return this._text.length*this._textFormat.size}get textHeight(){return this._textFormat.size}get color(){return this._textFormat.color}set color(e){this._textFormat.color=e,this.setTextFormat(this._textFormat)}get background(){return this._background}set background(e){this._background=e,this.propertyUpdate("background",e)}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){this._backgroundColor=e,this.propertyUpdate("backgroundColor",e)}get border(){return this._border}set border(e){this._border=e,this.propertyUpdate("border",e)}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e,this.propertyUpdate("borderColor",e)}getTextFormat(){return this._textFormat}setTextFormat(e){this._textFormat=e,this.methodCall("setTextFormat",e.serialize())}appendText(e){this.text=this.text+e}serialize(){let e=super.serialize();return e.class="TextField",e.text=this._text,e.textFormat=this._textFormat.serialize(),e}};a(Q,"TextField");function le(){return new lt}a(le,"createTextFormat");var ut=class extends Q{mM=new T(this);constructor(t,e={}){super(t,16777215),this.setDefaults(e),this.initStyle(e),c.registerObject(this),this.bindParent(e),this.mM.play()}set fontsize(t){var e=this.getTextFormat();e.size=t,this.setTextFormat(e)}get fontsize(){return this.getTextFormat().fontsize}set font(t){var e=this.getTextFormat();e.font=t,this.setTextFormat(e)}get font(){return this.getTextFormat().font}set align(t){var e=this.getTextFormat();e.align=t,this.setTextFormat(e)}get align(){return this.getTextFormat().align}set bold(t){var e=this.getTextFormat();e.bold=t,this.setTextFormat(e)}get bold(){return this.getTextFormat().bold}get motionManager(){return this.mM}set motionManager(t){h("IComment.motionManager is read-only","warn")}bindParent(t){t.hasOwnProperty("parent")&&t.parent?.addChild(this)}initStyle(t={}){"lifeTime"in t&&(this.mM.dur=t.lifeTime*1e3),"fontsize"in t&&(this.getTextFormat().size=t.fontsize),"font"in t&&(this.getTextFormat().font=t.font),"color"in t&&(this.getTextFormat().color=t.color),"bold"in t&&(this.getTextFormat().bold=t.bold),t.hasOwnProperty("motionGroup")?this.mM.initTweenGroup(t.motionGroup||[],this.mM.dur):t.hasOwnProperty("motion")&&this.mM.initTween(t.motion,!1)}};a(ut,"CommentField");function ue(i,t){return new ut(i,t)}a(ue,"createComment");function ce(){return new ut("",{})}a(ce,"createTextField");var tt=class extends F{_graphics;constructor(){super(),this._graphics=new L(this)}get graphics(){return this._graphics}serialize(){var t=super.serialize();return t.class="Shape",t}};a(tt,"Shape");var Pt=class extends tt{_mM=new T(this);constructor(t){super(),this.setDefaults(t),this.initStyle(t),c.registerObject(this),this.bindParent(t),this._mM.play()}get motionManager(){return this._mM}set motionManager(t){h("IComment.motionManager is read-only","warn")}bindParent(t){t.hasOwnProperty("parent")&&t.parent?.addChild(this)}initStyle(t={}){t.lifeTime&&(this._mM.dur=t.lifeTime*1e3),t.hasOwnProperty("motionGroup")?this._mM.initTweenGroup(t.motionGroup||[],this._mM.dur):t.hasOwnProperty("motion")&&this._mM.initTween(t.motion,!1)}};a(Pt,"CommentShape");function me(i){return new Pt(i)}a(me,"createShape");var G=class{serialize(){return{class:"Filter",type:"nullfilter"}}};a(G,"Filter");var Bt=class extends G{constructor(e=4,r=4){super();this.blurX=e;this.blurY=r}serialize(){let e=super.serialize();return e.type="blur",e.params={blurX:this.blurX,blurY:this.blurY},e}};a(Bt,"BlurFilter");var Et=class extends G{constructor(e=16711680,r=1,n=6,s=6,l=2,m,d=!1,p=!1){super();this.color=e;this.alpha=r;this.blurX=n;this.blurY=s;this.strength=l;this.quality=m;this.inner=d;this.knockout=p}serialize(){let e=super.serialize();return e.type="glow",e.params={color:this.color,alpha:this.alpha,blurX:this.blurX,blurY:this.blurY,strength:this.strength,inner:this.inner,knockout:this.knockout},e}};a(Et,"GlowFilter");var It=class extends G{constructor(e=4,r=45,n=0,s=1,l=4,m=4,d=1,p=1){super();this.distance=e;this.angle=r;this.color=n;this.alpha=s;this.blurX=l;this.blurY=m;this.strength=d;this.quality=p}inner=!1;knockout=!1;serialize(){let e=super.serialize();return e.type="dropShadow",e.params={distance:this.distance,angle:this.angle,color:this.color,blurY:this.blurY,strength:this.strength,inner:this.inner,knockout:this.knockout},e}};a(It,"DropShadowFilter");var St=class extends G{constructor(e=0,r=0,n,s=1,l=0,m=!0,d=!0,p=0,v=0){super();this.matrixX=e;this.matrixY=r;this.matrix=n;this.divisor=s;this.bias=l;this.preserveAlpha=m;this.clamp=d;this.color=p;this.alpha=v}serialize(){let e=super.serialize();return e.type="convolution",e.matrix={x:this.matrixX,y:this.matrixY,data:this.matrix},e.divisor=this.divisor,e.preserveAlpha=this.preserveAlpha,e.clamp=this.clamp,e.color=this.color,e.alpha=this.alpha,e}};a(St,"ConvolutionFilter");function pe(i=4,t=45,e=0,r=1,n=4,s=4,l=1,m=1){return new It(i,t,e,r,n,s,l,m)}a(pe,"createDropShadowFilter");function de(i=16711680,t=1,e=6,r=6,n=2,s,l=!1,m=!1){return new Et(i,t,e,r,n,s,l,m)}a(de,"createGlowFilter");function fe(i=6,t=6,e=2){return new Bt(i,t)}a(fe,"createBlurFilter");function ge(){throw new Error("Display.createBevelFilter not implemented")}a(ge,"createBevelFilter");function be(i=0,t=0,e,r=1,n=0,s=!0,l=!0,m=0,d=0){return new St(i,t,e,r,n,s,l,m,d)}a(be,"createConvolutionFilter");function _e(){throw new Error("Display.createDisplacementMapFilter not implemented")}a(_e,"createDisplacementMapFilter");function xe(){throw new Error("Display.createGradientBevelFilter not implemented")}a(xe,"createGradientBevelFilter");function ye(){throw new Error("Display.createGradientGlowFilter not implemented")}a(ye,"createGradientGlowFilter");function we(){throw new Error("Display.createColorMatrixFilter not implemented")}a(we,"createColorMatrixFilter");var u=class{static get stage(){return this.root}static get frameRate(){return this._frameRate}static set frameRate(t){this._frameRate=t,b("Display:SetFrameRate",t)}static toString(){return"[display Display]"}};a(u,"Display"),o(u,"Point",y),o(u,"Matrix",P),o(u,"Matrix3D",C),o(u,"Vector3D",O),o(u,"createMatrix",Jt),o(u,"createMatrix3D",\$t),o(u,"createGradientBox",Qt),o(u,"createVector3D",te),o(u,"projectVector",ee),o(u,"projectVectors",re),o(u,"createPoint",bt),o(u,"toIntVector",ie),o(u,"toNumberVector",ne),o(u,"ColorTransform",Y),o(u,"createColorTransform",se),o(u,"PerspectiveProjection",X),o(u,"Transform",V),o(u,"Filter",G),o(u,"createDropShadowFilter",pe),o(u,"createGlowFilter",de),o(u,"createBlurFilter",fe),o(u,"createBevelFilter",ge),o(u,"createConvolutionFilter",be),o(u,"createDisplacementMapFilter",_e),o(u,"createGradientBevelFilter",xe),o(u,"createGradientGlowFilter",ye),o(u,"createColorMatrixFilter",we),o(u,"BlendMode",kt),o(u,"Rectangle",w),o(u,"DisplayObject",F),o(u,"Graphics",L),o(u,"Sprite",U),o(u,"RootSprite",st),o(u,"UIComponent",\$),o(u,"ByteArray",S),o(u,"Bitmap",Z),o(u,"BitmapData",q),o(u,"MotionManager",T),o(u,"createButton",oe),o(u,"createCanvas",he),o(u,"Shape",tt),o(u,"createShape",me),o(u,"TextField",Q),o(u,"createTextFormat",le),o(u,"createComment",ue),o(u,"createTextField",ce),o(u,"createBitmap",Vt),o(u,"createParticle",Lt),o(u,"createBitmapData",Ut),o(u,"root",new st),o(u,"loaderInfo"),o(u,"version",""),o(u,"width",0),o(u,"height",0),o(u,"fullScreenWidth",0),o(u,"fullScreenHeight",0),o(u,"_frameRate",24);A("Update:DimensionUpdate",i=>{u.width=i.stageWidth,u.height=i.stageHeight,i.hasOwnProperty("screenWidth")&&i.hasOwnProperty("screenHeight")&&(u.fullScreenWidth=i.screenWidth,u.fullScreenHeight=i.screenHeight)});var ct=class{},R=ct;a(R,"Global"),o(R,"_store",{}),o(R,"_set",(t,e)=>{ct._store[t]=e}),o(R,"_get",t=>ct._store[t]),o(R,"_",t=>ct._get(t));function Me(i){typeof i=="object"?h(JSON.stringify(i),"log"):h(i,"log")}a(Me,"trace");function Te(i,t){typeof t=="function"&&t()}a(Te,"load");function ve(i){if(i===null||typeof i!="object")return i;if(typeof i.clone=="function")return i.clone();if(Array.isArray(i))return i.slice(0);let t={};t.constructor=t.constructor,t.prototype=t.prototype;for(let e in i)t[e]=i[e];return t}a(ve,"clone");function Oe(i,t){if(!(i===null||typeof i!="object")&&!(i instanceof u.DisplayObject))for(let e in i)i.hasOwnProperty(e)&&t(e,i[e])}a(Oe,"foreach");function Fe(){throw new Error("stopExecution")}a(Fe,"stopExecution");function Ce(i){let t=i.length,e=i.split(""),r=0,n=[];for(;r<t;)switch(e[r]){case"/":{!n.length&&e[r+1]&&e[r+1]==="n"&&(e[r]=\`
\`,e[r+1]=\`
\`),r++;break}case'"':{n.length&&n[0]===e[r]?n.shift():n.unshift('"'),r++;break}case"'":{n.length&&n[0]===e[r]?n.shift():n.unshift("'"),r++;break}default:r++;break}return e.join("")}a(Ce,"wrap");it.createChannel("::eval",1,Math.round(Math.random()*1e5));it.createChannel("::debug",1,Math.round(Math.random()*1e5));Object.defineProperties(self,{Runtime:{value:c},Display:{value:u},\$:{value:u},Player:{value:f},Tween:{value:g},Utils:{value:x},Global:{value:R},\$G:{value:R},Bitmap:{value:J},trace:{value:Me},load:{value:Te},clone:{value:ve},foreach:{value:Oe},stopExecution:{value:Fe},ScriptManager:{value:N},getTimer:{value:x.getTimer.bind(x)},interval:{value:x.interval.bind(x)},timer:{value:x.timer.bind(x)},clearTimeout:{value:x.clearTimeout.bind(x)},clearInterval:{value:x.clearInterval.bind(x)},none:{value:null},ture:{value:!0},ph:{get:()=>f.height,set:i=>f.height=i},pw:{get:()=>f.width,set:i=>f.width=i}});A("::eval",function(i){try{(0,eval)(\`let importScripts,postMessage,addEventListener,self;
\`+Ce(i).replace(/(&amp;)|(&lt;)|(&gt;)|(&apos;)|(&quot;)/g,t=>({"&amp;":"&","&lt;":"<","&gt;":">","&apos;":"'","&quot;":'"'})[t]))}catch(t){if(t.message==="stopExecution")return;throw t}});A("::debug",function(i){if(typeof i>"u"||i===null||!i.hasOwnProperty("action")){D("::worker:debug","worker","Malformed request");return}if(i.action==="list-channels")D("::worker:debug","worker",it.listChannels());else if(i.action==="raw-eval")try{D("::worker:debug","worker",(0,eval)(i.code))}catch(t){D("::worker:debug","worker","Error: "+t)}else D("::worker:debug","worker","Unrecognized action")});D("::worker:state","worker","running");})();
`, "Worker", undefined, undefined);
}
