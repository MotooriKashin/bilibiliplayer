import worker from '@jsc/danmaku/worker-loader/inline';

// 运行在work中的弹幕解析器，须提前构建
export default function () {
  return worker(`var le=Object.defineProperty;var _r=(i,t,e)=>t in i?le(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var o=(i,t)=>le(i,"name",{value:t,configurable:!0});var f=(i,t)=>()=>(i&&(t=i(i=0)),t);var xr=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports);var a=(i,t,e)=>(_r(i,typeof t!="symbol"?t+"":t,e),e);function h(i,t){self.postMessage(JSON.stringify({channel:"",obj:i,mode:t||"log"}))}function qt(i,t,e){self.postMessage(JSON.stringify({channel:i,payload:t,callback:!0})),ot.addListenerChannel(i,e)}function Q(i,t){ot.addListenerChannel(i,t)}function x(i,t){self.postMessage(JSON.stringify({channel:i,payload:t,callback:!1}))}function V(i,t,e){self.postMessage(JSON.stringify({channel:i,auth:t,payload:e,callback:!1}))}var Mt,ot,_=f(()=>{"use strict";Mt=class{channels={};constructor(){self.addEventListener("message",t=>{if(t)try{let e=JSON.parse(t.data);e.hasOwnProperty("channel")&&typeof e.channel=="string"?this.dispatchMessage(e):h(e,"warn")}catch(e){h(e,"err")}})}dispatchMessage(t){t.channel in this.channels?this.channels[t.channel]?.listeners.forEach(e=>{try{e(t.payload)}catch(r){r.stack?h(r.stack?.toString(),"err"):h(r.toString(),"err")}}):h('Got message on channel "'+t.channel+'" but channel does not exist.',"warn")}listChannels=()=>{let t={};for(let e in this.channels)t[e]={max:this.channels[e].max,listeners:this.channels[e].listeners.length};return t};deleteChannel=(t,e)=>t in this.channels?e||this.channels[t].auth?e===this.channels[t].auth?(delete this.channels[t],!0):!1:(delete this.channels[t],!0):!0;createChannel=(t,e,r)=>t in this.channels?!1:(this.channels[t]={max:e||0,auth:r,listeners:[]},!0);addListenerChannel=(t,e)=>(t in this.channels||(this.channels[t]={max:0,listeners:[]}),this.channels[t].max>0&&this.channels[t].listeners.length>=this.channels[t].max?!1:(this.channels[t].listeners.push(e),!0))};o(Mt,"OOAPI");ot=new Mt;o(h,"__trace");o(qt,"__channel");o(Q,"__schannel");o(x,"__pchannel");o(V,"__achannel")});var H,Ht=f(()=>{"use strict";H=class{static xorshift128p(){var t=this._rngState[1],e=this._rngState[0];this._rngState[0]=t,e^=e<<23,e^=e>>17,e^=t,e^=t>>26,this._rngState[1]=e}static random(t=16){if(t===void 0&&(t=16),t>32)throw new Error("NotCrypto.random expects 32 bits or less");if(Math&&Math.random){for(var e=0,r=0;r<t;r++)e=(e<<1)+(Math.random()<.5?0:1);return e}else return this.fallbackRandom(Date.now()%1024,t)}static fallbackRandom(t,e=16){if(e===void 0&&(e=16),e>32)throw new Error("NotCrypto.fallbackRandom expects 32 bits or less");for(var r=0;r<t;r++)this.xorshift128p();for(var n=0,r=0;r<e;r++)n=(n<<1)+1;return this._rngState[0]+this._rngState[1]&n}static toHex(t,e){if(e===void 0&&(e=0),e<=0)return t.toString(16);for(var r=t.toString(16);r.length<e;)r="0"+r;return r}};o(H,"NotCrypto"),a(H,"_rngState",[Math.floor(Date.now()/1024)%1024,Date.now()%1024])});function yr(i,t,e){let r=T[i];typeof r=="object"&&r.dispatchEvent&&r.dispatchEvent(t,e)}function me(i){return T.hasOwnProperty(i)&&T[i]!==null}function Tt(i){return T[i]}function B(i){if(!i.getId){h("Cannot register object without getId method.","warn");return}if(d.hasObject(i.getId())){h("Attempted to re-register object or id collision @ "+i.getId(),"warn");return}else{T[i.getId()]=i,x("Runtime:RegisterObject",{id:i.getId(),data:i.serialize()}),Q("object::("+i.getId()+")",t=>{t.hasOwnProperty("type")&&t.type==="event"&&yr(i.getId(),t.event,t.data)}),ce++;return}}function pe(i){let t=i.getId();de(t)}function de(i){if(d.hasObject(i)){if(i.substr(0,2)==="__"){h("Runtime.deregisterObject cannot de-register a MetaObject","warn");return}x("Runtime:DeregisterObject",{id:i}),typeof T[i].unload=="function"&&T[i].unload(),T[i]=null,delete T[i]}}function ue(i="obj"){return i+":"+Date.now()+"|"+H.random(16)+":"+ce}function L(i="obj"){let t=ue(i);for(;d.hasObject(t);)t=ue(i);return t}function fe(){for(let i in T)i.substr(0,2)!=="__"&&de(i)}function Ot(){for(let i in T)i.substr(0,2)!=="__"&&typeof T[i].unload=="function"&&T[i].unload()}function ge(){h("Runtime.crash() : Manual crash","fatal")}function be(){V("::worker:state","worker","terminated"),self.close()}function _e(i){V("Runtime::alert","::Runtime",i)}var at,ce,T,Wt,E=f(()=>{"use strict";_();Ht();Kt();at=class{name;listeners={};constructor(t){if(t.slice(0,2)!=="__")throw new Error("MetaObject names must start with two underscores.");this.name=t}addEventListener(t,e,r=!1,n=0){t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push(e)}removeEventListener(t,e,r=!1){if(!(t in this.listeners))return;let n=this.listeners[t].indexOf(e);n>=0&&this.listeners[t].splice(n,1)}hasEventListener(t){return t in this.listeners&&this.listeners[t].length>0}dispatchEvent(t,e){if(t in this.listeners)for(let r=0;r<this.listeners[t].length;r++)this.listeners[t][r](e)}getId(){return this.name}serialize(){return{class:this.name}}unload(){throw new Error("Meta objects should not be unloaded!")}};o(at,"MetaObject");ce=0,T={__self:new at("__self"),__player:new at("__player"),__root:new at("__root")};Object.defineProperty(d,"registeredObjects",{get:function(){return T},set:function(i){h("Runtime.registeredObjects is read-only","warn")}});o(yr,"_dispatchEvent");o(me,"hasObject");o(Tt,"getObject");o(B,"registerObject");o(pe,"deregisterObject");o(de,"deregisterObjectById");o(ue,"_makeId");o(L,"generateId");o(fe,"reset");o(Ot,"clear");o(ge,"crash");o(be,"exit");o(_e,"alert")});function xe(i,t){qt("Runtime:RequestPermission",{name:i},e=>{e===!0?vt[i]=!0:vt[i]=!1,typeof t=="function"&&t(e)})}function ye(i){return!!(vt.hasOwnProperty(i)&&vt[i])}function we(i,t,e){qt("Runtime:PrivilegedAPI",{method:"openWindow",params:[i,t]},function(r){e?.({moveTo:function(s,l){x("Runtime:PrivilegedAPI",{method:"window",params:[r,"moveTo",[s,l]]})},resizeTo:function(s,l){x("Runtime:PrivilegedAPI",{method:"window",params:[r,"resizeTo",[s,l]]})},focus:function(){x("Runtime:PrivilegedAPI",{method:"window",params:[r,"focus"]})},close:function(){x("Runtime:PrivilegedAPI",{method:"window",params:[r,"close"]})}})})}function Me(i,t){x("Runtime:PrivilegedAPI",{method:"injectStyle",params:[i,t]})}function Te(){h("Runtime.privilegedCode not available.","warn")}var vt,Oe=f(()=>{"use strict";_();vt={};o(xe,"requestPermission");o(ye,"hasPermission");o(we,"openWindow");o(Me,"injectStyle");o(Te,"privilegedCode")});function A(){return ve}function Ce(i){if(i>60||i<0){h("Frame rate should be in the range (0, 60]","warn");return}if(i===0){tt.stop();return}tt.stop(),tt=new S(Math.floor(1e3/i)),tt.addEventListener("timer",Fe),tt.start()}var mt,Ft,S,U,ve,tt,Fe,ht=f(()=>{"use strict";_();E();mt=class{constructor(t,e,r,n){this.type=t;this.dur=e;this.key=r;this.callback=n}get ttl(){return this.dur}set ttl(t){this.ttl=t}};o(mt,"RuntimeTimer");Ft=class{constructor(t=10){this.precision=t}timer=-1;timers=[];lastToken=0;key=0;set isRunning(t){t==!1?this.stop():this.start()}get isRunning(){return this.timer>-1}start(){this.timer<0&&(this.lastToken=Date.now(),this.timer=setInterval(()=>{let t=Date.now()-this.lastToken;for(let e=0;e<this.timers.length;e++){let r=this.timers[e];if(r.type==="timeout"){if(r.ttl-=t,r.ttl<=0){try{r.callback()}catch(n){h(n.stack?.toString(),"err")}this.timers.splice(e,1),e--}}else if(r.type==="interval"&&(r.ttl-=t,r.ttl<=0)){try{r.callback()}catch(n){h(n.stack?.toString(),"err")}r.ttl+=r.dur}}this.lastToken=Date.now()},this.precision))}stop(){this.timer>-1&&(clearInterval(this.timer),this.timer=-1)}setInterval(t,e){let r=this.key++;return this.timers.push(new mt("interval",e,r,t)),r}setTimeout(t,e){let r=this.key++;return this.timers.push(new mt("timeout",e,r,t)),r}clearInterval(t){for(let e=0;e<this.timers.length;e++)if(this.timers[e].type==="interval"&&this.timers[e].key===t){this.timers.splice(e,1);return}}clearTimeout(t){for(let e=0;e<this.timers.length;e++)if(this.timers[e].type==="timeout"&&this.timers[e].key===t){this.timers.splice(e,1);return}}clearAll(t="all"){t==="timer"?this.timers=this.timers.filter(e=>e.type!=="timer"):t==="interval"?this.timers=this.timers.filter(e=>e.type!=="interval"):this.timers=[]}};o(Ft,"TimerRuntime");S=class{constructor(t,e=0){this.delay=t;this.repeatCount=e}microtime=0;timer=-1;listeners=[];complete=[];currentCount=0;set isRunning(t){h("Timer.isRunning is read-only","warn")}get isRunning(){return this.timer>=0}start(){if(!this.isRunning){let t=Date.now(),e=this;this.timer=setInterval(()=>{let r=Date.now()-t;e.microtime+=r,e.microtime>e.delay&&(e.microtime-=e.delay,e.currentCount++,e.dispatchEvent("timer")),t=Date.now(),e.repeatCount>0&&e.repeatCount<=e.currentCount&&(e.stop(),e.dispatchEvent("timerComplete"))},20)}}stop(){this.isRunning&&(clearInterval(this.timer),this.timer=-1)}reset(){this.stop(),this.currentCount=0,this.microtime=0}addEventListener(t,e){t==="timer"?this.listeners.push(e):t==="timerComplete"&&this.complete.push(e)}dispatchEvent(t){if(t==="timer")for(let e=0;e<this.listeners.length;e++)this.listeners[e]();else if(t==="timerComplete")for(let e=0;e<this.complete.length;e++)this.complete[e]()}};o(S,"Timer");U=class{constructor(t=()=>Date.now()){this.clock=t;this.reset()}lastTime=0;get elapsed(){return this.clock()-this.lastTime}reset(){this.lastTime=this.clock()}};o(U,"TimeKeeper");ve=new Ft,tt=new S(40),Fe=o(function(){for(let i in Wt)if(!(i.substring(0,2)==="__"&&i!=="__root"))try{Wt[i].dispatchEvent("enterFrame")}catch{}},"enterFrameDispatcher");ve.start();tt.start();tt.addEventListener("timer",Fe);o(A,"getTimer");o(Ce,"updateFrameRate")});var pt,Pe=f(()=>{"use strict";_();E();ht();pt=class{managedElements={};_registerElement(t,e){this.managedElements[t]=e}clearTimer(){A().clearAll("interval")}clearEl(){h("ScriptManager.clearEl may not be properly implemented.","warn"),Ot()}clearTrigger(){h("ScriptManager.clearTrigger not implemented.","warn")}pushEl(t){h("ScriptManager.pushEl is not properly implemented.","warn"),t.motionManager&&t.motionManager.start(),t.visible=!0}popEl(t){h("ScriptManager.popEl is not properly implemented.","warn"),t.motionManager&&t.motionManager.play(),t.visible=!1}pushTimer(t){h("ScriptManager.pushTimer not implemented.","warn")}popTimer(t){h("ScriptManager.popTimer not implemented.","warn")}toString(){return"[scriptManager ScriptManager]"}};o(pt,"ScriptManager")});function Ee(i,t="*"){if(Be.hasOwnProperty(i)){if(Be[i].indexOf(t)>=0)return!0}else return!1;return!1}function je(i,t){i==="libBitmap"?t(null,{type:"noop"}):t(new Error("Could not load unknown library ["+i+"]"),null)}var Be,Ie=f(()=>{"use strict";Be={js:["*"],Runtime:["*","openWindow","injectStyle"],Display:["*"],Player:["*"],Tween:["*"],Utils:["*"]};o(Ee,"supports");o(je,"requestLibrary")});var d,Kt=f(()=>{"use strict";Ht();E();Oe();Pe();Ie();ht();d=class{};o(d,"Runtime"),a(d,"NotCrypto",H),a(d,"Timer",S),a(d,"TimeKeeper",U),a(d,"getTimer",A),a(d,"updateFrameRate",Ce),a(d,"_defaultScriptManager",new pt),a(d,"requestPermission",xe),a(d,"hasPermission",ye),a(d,"openWindow",we),a(d,"injectStyle",Me),a(d,"privilegedCode",Te),a(d,"supports",Ee),a(d,"requestLibrary",je),a(d,"hasObject",me),a(d,"getObject",Tt),a(d,"registerObject",B),a(d,"deregisterObject",pe),a(d,"generateId",L),a(d,"reset",fe),a(d,"clear",Ot),a(d,"crash",ge),a(d,"exit",be),a(d,"alert",_e)});var D,Zt=f(()=>{"use strict";_();D=class extends Array{_readPosition=0;constructor(...t){super(...t);try{Object.setPrototypeOf(this,D.prototype)}catch{}}get bytesAvailable(){return this.length-this._readPosition}set bytesAvailable(t){h("ByteArray.bytesAvailable is read-only","warn")}get position(){return this._readPosition}set position(t){this._readPosition=t}clear(){this.length=0,this._readPosition=0}compress(t="zlib"){h("ByteArray.compress["+t+"] not implemented","warn"),this._readPosition=0}uncompress(t="zlib"){h("ByteArray.uncompress["+t+"] not implemented","warn"),this._readPosition=0}deflate(){h("ByteArray.deflate not implemented","warn")}inflate(){h("ByteArray.inflate not implemented","warn")}readUTFBytes(t){let e=this.slice(this._readPosition,t);return this._readPosition+=Math.min(t,this.length-this._readPosition),e.reduce((r,n)=>(r+=String.fromCharCode(n),r),"")}readUnsignedByte(){return this[this._readPosition]&255}readUnsignedShort(){let t=this.readUnsignedByte(),e=this.readUnsignedByte();return(t<<8)+e&65535}readUnsignedInt(){let t=this.readUnsignedByte(),e=this.readUnsignedByte(),r=this.readUnsignedByte(),n=this.readUnsignedByte();return(t<<24)+(e<<16)+(r<<8)+n&4294967295}readByte(){return this.readUnsignedByte()-128}readShort(){return this.readUnsignedShort()-32767}readBoolean(){return this.readUnsignedByte()!==0}readFloat(){let t=this.readUnsignedInt(),e=t&2147483648?-1:1,r=t>>23&255,n=t&8388607;switch(e){case 0:break;case 255:return r?NaN:n>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;default:return e-=127,r+=8388608,n*(r/8388608)*Math.pow(2,e)}}writeByte(t){this.push(t&255)}writeBytes(t,e=0,r=0){for(let n=e;n<Math.min(t.length-e,r);n++)this.writeByte(t[n])}writeUTFBytes(t){let e=unescape(encodeURIComponent(t));for(let r=0;r<t.length;r++)this.push(e.charCodeAt(r))}clone(){let t=new D;return this.forEach(function(e){t.push(e)}),t}};o(D,"ByteArray")});function Se(i,t,e,r,n,s){return new j(i,t,e,r,n,s)}function Ae(i){return new F(i)}function De(i,t,e,r,n){let s=new j;return s.createGradientBox(i/1638.4,t/1638.4,e,r+i/2,n+t/2),s}function ze(i=0,t=0,e=0,r=0){return new O(i,t,e,r)}function ke(i,t){return i.transformVector(t)}function Re(i,t,e,r){for(;e.length>0;)e.pop();if(t.length%3!==0){h("Display.projectVectors input vertex Vector must be a multiple of 3.","err");return}let n=[];i.transformVectors(t,n);for(let s=0;s<n.length/3;s++){let l=n[s*3],c=n[s*3+1];e.push(l,c)}}function Ct(i=0,t=0){return new y(i,t)}function Ve(i){return Object.defineProperty(i,"as3Type",{get:function(){return"Vector<int>"},set:function(t){h("as3Type should not be set.","warn")}}),i.map(Math.floor)}function Ge(i){return Object.defineProperty(i,"as3Type",{get:function(){return"Vector<number>"},set:function(t){h("as3Type should not be set.","warn")}}),i}var y,j,F,dt,O,ft=f(()=>{"use strict";_();y=class{constructor(t=0,e=0){this.x=t;this.y=e}set length(t){h("Point.length is read-only","err")}get length(){return Math.sqrt(this.x*this.x+this.y*this.y)}add(t){return new y(t.x+this.x,t.y+this.y)}subtract(t){return new y(this.x-t.x,this.y-t.y)}static interpolate(t,e,r){return new y((e.x-t.x)*r+t.x,(e.y-t.y)*r+t.y)}offset(t,e){this.x+=t,this.y+=e}normalize(t){let e=t/this.length;this.x*=e,this.y*=e}static polar(t,e){return new y(t*Math.cos(e),t*Math.sin(e))}setTo(t,e){this.x=t,this.y=e}equals(t){return t.x===this.x&&t.y===this.y}toString(){return"(x="+this.x+", y="+this.y+")"}clone(){return new y(this.x,this.y)}};o(y,"Point");j=class{_data;constructor(t=1,e=0,r=0,n=1,s=0,l=0){this._data=[t,r,s,e,n,l,0,0,1]}dotProduct(t){if(t.length<9)throw new Error("Matrix dot product expects a 3x3 Matrix");let e=[0,0,0,0,0,0,0,0,0];for(let r=0;r<3;r++)for(let n=0;n<3;n++)for(let s=0;s<3;s++)e[r*3+n]+=this._data[r*3+s]*t[s*3+n];return e}setTo(t=1,e=0,r=0,n=1,s=0,l=0){this._data=[t,r,s,e,n,l,0,0,1]}translate(t,e){this._data[2]+=t,this._data[5]+=e}rotate(t){this._data=this.dotProduct([Math.cos(t),-Math.sin(t),0,Math.sin(t),Math.cos(t),0,0,0,1])}scale(t,e){this._data=this.dotProduct([t,0,0,0,e,0,0,0,1])}identity(){this.setTo(1,0,0,1,0,0)}createGradientBox(t,e,r,n,s){this.createBox(t,e,r,n,s)}createBox(t,e,r,n,s){this.identity(),this.rotate(r),this.scale(t,e),this.translate(n,s)}clone(){let t=this._data[0],e=this._data[3],r=this._data[1],n=this._data[4],s=this._data[2],l=this._data[5];return new j(t,e,r,n,s,l)}serialize(){return this._data}};o(j,"Matrix");F=class{_data;constructor(t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){t.length===16?this._data=t:t.length===0?this.identity():(h("Matrix3D initialization vector invalid","warn"),this.identity())}dotProduct(t,e){if(t.length!==16||e.length!==16)throw new Error("Matrix3D dot product expects a 4xr Matrix3D");let r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(let n=0;n<4;n++)for(let s=0;s<4;s++)for(let l=0;l<4;l++)r[n*4+s]+=t[n*4+l]*e[l*4+s];return r}rotationMatrix(t,e){let r=Math.sin(t),n=Math.cos(t);return[n+e.x*e.x*(1-n),e.x*e.y*(1-n)-e.z*r,e.x*e.z*(1-n)+e.y*r,0,e.x*e.y*(1-n)+e.z*r,n+e.y*e.y*(1-n),e.y*e.z*(1-n)-e.x*r,0,e.z*e.x*(1-n)-e.y*r,e.z*e.y*(1-n)+e.x*r,n+e.z*e.z*(1-n),0,0,0,0,1]}identity(){this._data=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}append(t){this._data=this.dotProduct(t._data,this._data)}appendRotation(t,e,r){r&&this.appendTranslation(r.x,r.y,r.z),this._data=this.dotProduct(this.rotationMatrix(t*Math.PI/180,e),this._data),r&&this.appendTranslation(-r.x,-r.y,-r.z)}appendTranslation(t,e,r){this._data=this.dotProduct([1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1],this._data)}appendScale(t=1,e=1,r=1){this._data=this.dotProduct([t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1],this._data)}prepend(t){this._data=this.dotProduct(this._data,t._data)}prependRotation(t,e,r){r&&this.prependTranslation(r.x,r.y,r.z),this._data=this.dotProduct(this._data,this.rotationMatrix(t*Math.PI/180,e)),r&&this.prependTranslation(-r.x,-r.y,-r.z)}prependTranslation(t,e,r){this._data=this.dotProduct(this._data,[1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1])}prependScale(t,e,r){this._data=this.dotProduct(this._data,[t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1])}transformVector(t){let e=this._data[0]*t.x+this._data[1]*t.y+this._data[2]*t.z+this._data[3]*t.w,r=this._data[4]*t.x+this._data[5]*t.y+this._data[6]*t.z+this._data[7]*t.w,n=this._data[8]*t.x+this._data[9]*t.y+this._data[10]*t.z+this._data[11]*t.w,s=this._data[12]*t.x+this._data[13]*t.y+this._data[14]*t.z+this._data[15]*t.w;return new O(e,r,n,s)}transformVectors(t,e){if(t.length%3!==0){h("Matrix3D.transformVectors expects input size to be multiple of 3.","err");return}for(let r=0;r<t.length/3;r++){let n=t[r*3],s=t[r*3+1],l=t[r*3+2],c=this._data[0]*n+this._data[1]*s+this._data[2]*l,p=this._data[4]*n+this._data[5]*s+this._data[6]*l,m=this._data[8]*n+this._data[9]*s+this._data[10]*l;e.push(c,p,m)}}transpose(){this._data=[this._data[0],this._data[4],this._data[8],this._data[12],this._data[1],this._data[5],this._data[9],this._data[13],this._data[2],this._data[6],this._data[10],this._data[14],this._data[3],this._data[7],this._data[11],this._data[15]]}clone(){return new F(this._data)}serialize(){return this._data}};o(F,"Matrix3D");dt=class{constructor(t=0,e=0,r=0,n=0){this.x=t;this.y=e;this.z=r;this.w=n}toString(){return"(x="+this.x+", y="+this.y+", z="+this.z+", w="+this.w+")"}},O=dt;o(O,"Vector3D"),a(O,"X_AXIS",new dt(1,0,0)),a(O,"Y_AXIS",new dt(0,1,0)),a(O,"Z_AXIS",new dt(0,0,1));o(Se,"createMatrix");o(Ae,"createMatrix3D");o(De,"createGradientBox");o(ze,"createVector3D");o(ke,"projectVector");o(Re,"projectVectors");o(Ct,"createPoint");o(Ve,"toIntVector");o(Ge,"toNumberVector")});function Le(i=1,t=1,e=1,r=1,n=0,s=0,l=0,c=0){return new W(i,t,e,r,n,s,l,c)}var W,Jt=f(()=>{"use strict";W=class{constructor(t=1,e=1,r=1,n=1,s=0,l=0,c=0,p=0){this.redMultiplier=t;this.greenMultiplier=e;this.blueMultiplier=r;this.alphaMultiplier=n;this.redOffset=s;this.greenOffset=l;this.blueOffset=c;this.alphaOffset=p}get color(){return this.redOffset<<16|this.greenOffset<<8|this.blueOffset}set color(t){this.redOffset=t>>16&255,this.greenOffset=t>>8&255,this.blueOffset=t&255,this.redMultiplier=0,this.greenMultiplier=0,this.blueMultiplier=0}concat(t){this.redMultiplier*=t.redMultiplier,this.greenMultiplier*=t.greenMultiplier,this.blueMultiplier*=t.blueMultiplier,this.alphaMultiplier*=t.alphaMultiplier,this.redOffset+=t.redOffset,this.greenOffset+=t.greenOffset,this.blueOffset+=t.blueOffset,this.alphaOffset+=t.alphaOffset}serialize(){return{class:"ColorTransform",red:{offset:this.redOffset,multiplier:this.redMultiplier},green:{offset:this.greenOffset,multiplier:this.greenMultiplier},blue:{offset:this.blueOffset,multiplier:this.blueMultiplier},alpha:{offset:this.alphaOffset,multiplier:this.alphaMultiplier}}}};o(W,"ColorTransform");o(Le,"createColorTransform")});var K,N,\$t=f(()=>{"use strict";_();Jt();ft();K=class{fieldOfView=55;projectionCenter=new y(0,0);focalLength=0;constructor(t){t&&(this.projectionCenter=new y(t.width/2,t.height/2),this.fieldOfView=55,this.focalLength=t.width/2/Math.tan(this.fieldOfView/2))}toMatrix3D(){return new F}clone(){let t=new K;return t.fieldOfView=this.fieldOfView,t.projectionCenter=this.projectionCenter,t.focalLength=this.focalLength,t}};o(K,"PerspectiveProjection");N=class{constructor(t){this.parent=t}_matrix=new j;_matrix3d;_perspectiveProjection;_colorTransform;set perspectiveProjection(t){this._perspectiveProjection=t}get perspectiveProjection(){return typeof this._perspectiveProjection>"u"&&(this._perspectiveProjection=new K(this.parent)),this._perspectiveProjection}set colorTransform(t){this._colorTransform=t}get colorTransform(){return typeof this._colorTransform>"u"&&(this._colorTransform=new W),this._colorTransform}set matrix3D(t){if(t===null){if(this._matrix3d===null)return;this._matrix3d=null,this._matrix=new j}else this._matrix=null,this._matrix3d=t;this.update()}set matrix(t){if(t===null){if(this._matrix===null)return;this._matrix=null,this._matrix3d=new F}else this._matrix3d=null,this._matrix=t;this.update()}get matrix3D(){return this._matrix3d}get matrix(){return this._matrix}box3d(t=1,e=1,r=1,n=0,s=0,l=0,c=0,p=0,m=0){(this._matrix||!this._matrix3d)&&(this._matrix=void 0,this._matrix3d=new F),this._matrix3d.identity(),this._matrix3d.appendRotation(n,O.X_AXIS),this._matrix3d.appendRotation(s,O.Y_AXIS),this._matrix3d.appendRotation(l,O.Z_AXIS),this._matrix3d.appendScale(t,e,r),this._matrix3d.appendTranslation(c,p,m)}box(t=1,e=1,r=0,n=0,s=0){this._matrix?this._matrix.createBox(t,e,r,n,s):this.box3d(t,e,1,0,0,r,n,s,0)}update(){this.parent&&(this.parent.transform=this)}getRelativeMatrix3D(t){return h("Transform.getRelativeMatrix3D not implemented","warn"),new F}getMatrix(){return this._matrix?this._matrix:this._matrix3d}getMatrixType(){return this._matrix?"2d":"3d"}clone(){let t=new N;return t._matrix=this._matrix,t._matrix3d=this._matrix3d,t}serialize(){return{mode:this.getMatrixType(),matrix:this.getMatrix()?.serialize()}}};o(N,"Transform")});var Qt,C,Pt,v,lt=f(()=>{"use strict";_();E();Bt();ft();\$t();Qt=(b=>(b.ADD="add",b.ALPHA="alpha",b.DARKEN="darken",b.DIFFERENCE="difference",b.ERASE="erase",b.HARDLIGHT="hardlight",b.INVERT="invert",b.LAYER="layer",b.LIGHTEN="lighten",b.MULTIPLY="multiply",b.NORMAL="normal",b.OVERLAY="overlay",b.SCREEN="screen",b.SHADER="shader",b.SUBTRACT="subtract",b))(Qt||{}),C=class{constructor(t=0,e=0,r=0,n=0){this.x=t;this.y=e;this.width=r;this.height=n}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}get size(){return Ct(this.width,this.height)}contains(t,e){return t>=this.left&&e>=this.top&&t<=this.right&&e<=this.bottom}containsPoint(t){return this.contains(t.x,t.y)}containsRect(t){return this.contains(t.left,t.top)&&this.contains(t.right,t.bottom)}copyFrom(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}equals(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}inflate(t=0,e=0){this.x-=t,this.width+=2*t,this.y-=e,this.height+=2*e}inflatePoint(t){this.inflate(t.x,t.y)}isEmpty(){return this.width<=0||this.height<=0}setTo(t=0,e=0,r=0,n=0){this.x=t,this.y=e,this.width=r,this.height=n}offset(t=0,e=0){this.x+=t,this.y+=e}offsetPoint(t){this.offset(t.x,t.y)}setEmpty(){this.setTo(0,0,0,0)}unionCoord(t,e){let r=t-this.x,n=e-this.y;r>=0?this.width=Math.max(this.width,r):(this.x+=r,this.width-=r),n>=0?this.height=Math.max(this.height,n):(this.y+=n,this.height-=n)}unionPoint(t){this.unionCoord(t.x,t.y)}union(t){let e=this.clone();return e.unionCoord(t.left,t.top),e.unionCoord(t.right,t.bottom),e}toString(){return"(x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+")"}clone(){return new C(this.x,this.y,this.width,this.height)}serialize(){return{x:this.x,y:this.y,width:this.width,height:this.height}}};o(C,"Rectangle");Pt=class{constructor(t=L(),e=!0){this.id=t;this._visible=e}_alpha=1;_anchor=new y;_boundingBox=new C;_z=0;_scaleX=1;_scaleY=1;_scaleZ=1;_rotationX=0;_rotationY=0;_rotationZ=0;_filters=[];_blendMode="normal";_listeners={};_parent;_name="";_children=[];_transform=new N(this);_hasSetDefaults=!1;setDefaults(t={}){if(this._hasSetDefaults){h("DisplayObject.setDefaults called more than once.","warn");return}this._hasSetDefaults=!0;try{if(t.hasOwnProperty("motion")){let e=t.motion;e.hasOwnProperty("alpha")&&(this._alpha=e.alpha.fromValue),e.hasOwnProperty("x")&&(this._anchor.x=e.x.fromValue),e.hasOwnProperty("y")&&(this._anchor.y=e.y.fromValue)}else if(t.hasOwnProperty("motionGroup")&&t.motionGroup&&t.motionGroup.length>0){let e=t.motionGroup[0];e.hasOwnProperty("alpha")&&(this._alpha=e.alpha.fromValue),e.hasOwnProperty("x")&&(this._anchor.x=e.x.fromValue),e.hasOwnProperty("y")&&(this._anchor.y=e.y.fromValue)}}catch{}t.hasOwnProperty("alpha")&&(this._alpha=t.alpha),t.hasOwnProperty("x")&&(this._anchor.x=t.x),t.hasOwnProperty("y")&&(this._anchor.y=t.y)}eventToggle(t,e="enable"){Pt.SANDBOX_EVENTS.indexOf(t)>-1||x("Runtime:ManageEvent",{id:this.id,name:t,mode:e})}propertyUpdate(t,e){x("Runtime:UpdateProperty",{id:this.id,name:t,value:e})}methodCall(t,e){x("Runtime:CallMethod",{id:this.id,method:t,params:e})}set alpha(t){this._alpha=t,this.propertyUpdate("alpha",t)}get alpha(){return this._alpha}set anchor(t){this._anchor=t,this.propertyUpdate("x",t.x),this.propertyUpdate("y",t.y)}get anchor(){return this._anchor}set boundingBox(t){this._boundingBox=t,this.propertyUpdate("boundingBox",t.serialize())}get boundingBox(){return this._boundingBox}set cacheAsBitmap(t){h("DisplayObject.cacheAsBitmap is not supported","warn")}get cacheAsBitmap(){return!1}set filters(t){this._filters=t||[];let e=[];for(let r=0;r<this._filters.length;r++)this.filters[r]&&e.push(this._filters[r].serialize());this.propertyUpdate("filters",e)}get filters(){return this._filters}get root(){return u.root}set root(t){h("DisplayObject.root is read-only.","warn")}get stage(){return u.root}set stage(t){h("DisplayObject.stage is read-only.","warn")}_updateBox(t=this._transform.getMatrixType()){t==="3d"?this._transform.box3d(this._scaleX,this._scaleY,this._scaleZ,this._rotationX,this._rotationY,this._rotationZ,0,0,this._z):this._transform.box(this._scaleX,this._scaleY,this._rotationZ*Math.PI/180),this.transform=this._transform}set rotationX(t){this._rotationX=t,this._updateBox("3d")}set rotationY(t){this._rotationY=t,this._updateBox("3d")}set rotationZ(t){this._rotationZ=t,this._updateBox()}set rotation(t){this._rotationZ=t,this._updateBox()}set scaleX(t){this._scaleX=t,this._updateBox()}set scaleY(t){this._scaleY=t,this._updateBox()}set scaleZ(t){this._scaleZ=t,this._updateBox("3d")}set x(t){this._anchor.x=t,this.propertyUpdate("x",t)}set y(t){this._anchor.y=t,this.propertyUpdate("y",t)}set z(t){this._z=t,this._updateBox("3d")}get rotationX(){return this._rotationX}get rotationY(){return this._rotationY}get rotationZ(){return this._rotationZ}get rotation(){return this._rotationZ}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get scaleZ(){return this._scaleZ}get x(){return this._anchor.x}get y(){return this._anchor.y}get z(){return this._z}set width(t){this._boundingBox.width=t,this.propertyUpdate("width",t)}get width(){return this._boundingBox.width}set height(t){this._boundingBox.height=t,this.propertyUpdate("height",t)}get height(){return this._boundingBox.height}set visible(t){this._visible=t,this.propertyUpdate("visible",t)}get visible(){return this._visible}set blendMode(t){this._blendMode=t,this.propertyUpdate("blendMode",t)}get blendMode(){return this._blendMode}set transform(t){this._transform=t,this._transform.parent!==this&&(this._transform.parent=this),this.propertyUpdate("transform",this._transform.serialize())}get transform(){return this._transform}set name(t){this._name=t,this.propertyUpdate("name",t)}get name(){return this._name}set loaderInfo(t){h("DisplayObject.loaderInfo is read-only","warn")}get loaderInfo(){return h("DisplayObject.loaderInfo is not supported","warn"),{}}set parent(t){h("DisplayObject.parent is read-only","warn")}get parent(){return this._parent??u.root}dispatchEvent(t,e){if(this._listeners.hasOwnProperty(t)&&this._listeners[t])for(let r=0;r<this._listeners[t].length;r++)try{this._listeners[t][r](e)}catch(n){n.hasOwnProperty("stack")?h(n.stack?.toString(),"err"):h(n.toString(),"err")}}addEventListener(t,e){this._listeners.hasOwnProperty(t)||(this._listeners[t]=[]),this._listeners[t].push(e),this._listeners[t].length===1&&this.eventToggle(t,"enable")}removeEventListener(t,e){if(!this._listeners.hasOwnProperty(t)||this._listeners[t].length===0)return;let r=this._listeners[t].indexOf(e);r>=0&&this._listeners[t].splice(r,1),this._listeners[t].length===0&&this.eventToggle(t,"disable")}get numChildren(){return this._children.length}addChild(t){if(typeof t>"u"||t===null)throw new Error("Cannot add an empty child!");if(t.contains(this))throw new Error("Attempting to add an ancestor of this DisplayObject as a child!");this._children.push(t),this._boundingBox.unionCoord(t._anchor.x+t._boundingBox.left,t._anchor.y+t._boundingBox.top),this._boundingBox.unionCoord(t._anchor.x+t._boundingBox.right,t._anchor.y+t._boundingBox.bottom),t._parent=this,this.methodCall("addChild",t.id)}removeChild(t){let e=this._children.indexOf(t);e>=0&&this.removeChildAt(e)}getChildAt(t){if(t<0||t>this._children.length)throw new RangeError("No child at index "+t);return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}removeChildAt(t){let e=this.getChildAt(t);this._children.splice(t,1),e._parent=null,this.methodCall("removeChild",e.id)}removeChildren(t,e=this._children.length){let r=this._children.splice(t,e-t),n=[];for(let s=0;s<r.length;s++)r[s]._parent=null,n.push(r[s].id);this.methodCall("removeChildren",n)}contains(t){if(t===this||this._children.indexOf(t)>=0)return!0;for(let e=0;e<this._children.length;e++)if(this._children[e].contains(t))return!0;return!1}remove(){this._parent?this._parent.removeChild(this):this.root.removeChild(this)}toString(){return"["+(this._name.length>0?this._name:"displayObject")+" DisplayObject]@"+this.id}clone(){let t=new Pt;return t._transform=this._transform.clone(),t._transform.parent=t,t._boundingBox=this._boundingBox.clone(),t._anchor=this._anchor.clone(),t._alpha=this._alpha,t}hasOwnProperty(t){return t==="clone"?!0:Object.prototype.hasOwnProperty.call(this,t)}serialize(){this._hasSetDefaults=!0;let t=[];for(let e=0;e<this._filters.length;e++)t.push(this._filters[e].serialize());return{class:"DisplayObject",x:this._anchor.x,y:this._anchor.y,alpha:this._alpha,filters:t}}unload(){this._visible=!1,this.remove(),this.methodCall("unload",null)}getId(){return this.id}},v=Pt;o(v,"DisplayObject"),a(v,"SANDBOX_EVENTS",["enterFrame"])});var Et,gt,Z,Ue=f(()=>{"use strict";_();E();Zt();lt();Et=class{xBegin;yBegin;xEnd;yEnd;expand(t,e){this.xBegin=this.xBegin===null?t:Math.min(this.xBegin,t),this.xEnd=this.xEnd===null?t:Math.max(this.xEnd,t),this.yBegin=this.yBegin===null?e:Math.min(this.yBegin,e),this.yEnd=this.xEnd===null?e:Math.max(this.yEnd,e)}asRect(){return this.isEmpty()?new C(0,0,0,0):new C(this.xBegin,this.yBegin,this.xEnd-this.xBegin,this.yEnd-this.yBegin)}isEmpty(){return this.xBegin??this.yBegin??this.xEnd??this.yEnd??!0}reset(){delete this.xBegin,delete this.xEnd,delete this.yBegin,delete this.yEnd}};o(Et,"DirtyArea");gt=class extends v{constructor(e){super(L("obj-bmp"));this.bitmapData=e}get width(){return console.log(this.bitmapData),this.bitmapData?this.bitmapData.width*this.scaleX:0}get height(){return this.bitmapData?this.bitmapData.height*this.scaleY:0}set width(e){this.bitmapData&&this.bitmapData.width>0&&(this.scaleX=e/this.bitmapData.width)}set height(e){this.bitmapData&&this.bitmapData.height>0&&(this.scaleY=e/this.bitmapData.height)}getBitmapData(){return this.bitmapData}setBitmapData(e){typeof e<"u"&&(this.bitmapData=e,this.methodCall("setBitmapData",e.getId()))}serialize(){let e=super.serialize();return e.class="Bitmap",this.bitmapData!==null&&(e.bitmapData=this.bitmapData?.getId()),e}};o(gt,"Bitmap");Z=class{constructor(t,e,r=!0,n=4294967295,s=L("obj-bmp-data")){this.transparent=r;this.fillColor=n;this.id=s;this.rect=new C(0,0,t,e),this._fill(),B(this)}rect;locked=!1;dirtyArea=new Et;byteArray=[];_fill(){this.byteArray=[];for(let t=0;t<this.rect.width*this.rect.height;t++)this.byteArray.push(this.fillColor)}_updateBox(t){if(this.dirtyArea.isEmpty()||this.locked)return;let e=t??this.dirtyArea.asRect();if(!this.rect.containsRect(e))throw h("BitmapData._updateBox box "+e.toString()+" out of bonunds "+this.rect.toString(),"err"),new Error("Rectangle provided was not within image bounds.");let r=[];for(let n=0;n<e.height;n++)for(let s=0;s<e.width;s++)r.push(this.byteArray[(e.y+n)*this.rect.width+e.x+s]);this._methodCall("updateBox",{box:e.serialize(),values:r}),this.dirtyArea.reset()}_methodCall(t,e){x("Runtime:CallMethod",{id:this.id,method:t,params:e})}get height(){return this.rect.height}get width(){return this.rect.width}set height(t){h("BitmapData.height is read-only","warn")}set width(t){h("BitmapData.height is read-only","warn")}draw(t,e,r,n,s,l=!1){if(!(t instanceof Z)){h("Drawing non BitmapData is not supported!","err");return}e&&h("Matrix transforms not supported yet.","warn"),r&&h("Color transforms not supported yet.","warn"),n&&n!=="normal"&&h("Blend mode ["+n+"] not supported yet.","warn"),l!==!1&&h("Smoothign not supported!","warn"),this.lock(),s&&(s=new C(0,0,t.width,t.height)),this.setPixels(s,t.getPixels(s)),this.unlock()}getPixel(t,e){return this.getPixel32(t,e)&16777215}getPixel32(t,e){if(t>=this.rect.width||e>=this.rect.height||t<0||e<0)throw new Error("Coordinates out of bounds");try{return this.transparent?this.byteArray[e*this.rect.width+t]:(this.byteArray[e*this.rect.width+t]&16777215)+4278190080}catch{return this.fillColor}}getPixels(t){if(typeof t>"u"||t===null)throw new Error("Expected a region to acquire pixels.");if(t.width===0||t.height===0)return new D;let e=new D;for(let r=0;r<t.height;r++)this.byteArray.slice((t.y+r)*this.rect.width+t.x,(t.y+r)*this.rect.width+t.x+t.width).forEach(function(n){e.push(n)});return e}setPixel(t,e,r){this.setPixel32(t,e,(r&16777215)+4278190080)}setPixel32(t,e,r){this.transparent||(r=(r&16777215)+4278190080),this.byteArray[e*this.rect.width+t]=r,this.dirtyArea.expand(t,e),this._updateBox()}setPixels(t,e){if(!(t.width===0||t.height===0)){if(e.length!==t.width*t.height)throw new Error("setPixels expected "+t.width*t.height+" pixels, but actually got "+e.length);this.transparent||(e=e.map(function(r){return(r&16777215)+4278190080}));for(let r=0;r<t.width;r++)for(let n=0;n<t.height;n++)this.byteArray[(t.y+n)*this.width+(t.x+r)]=e[n*t.width+r],this.dirtyArea.expand(r,n);this._updateBox()}}getVector(t){if(this.rect.equals(t))return this.byteArray;let e=[];for(let r=t.y;r<t.y+t.height;r++)for(let n=t.x;n<t.x+t.width;n++)e.push(t[r*this.rect.width+n]);return e}lock(){this.locked=!0}unlock(t){this.locked=!1,t?this._updateBox(t):this._updateBox()}dispatchEvent(t,e){}getId(){return this.id}serialize(){return{class:"BitmapData",width:this.rect.width,height:this.rect.height,fill:this.fillColor}}unload(){this._methodCall("unload",void 0)}clone(){let t=new Z(this.width,this.height,this.transparent,this.fillColor);return t.byteArray=this.byteArray.slice(0),t._updateBox(t.rect),t}};o(Z,"BitmapData")});function jt(i,t,e,r){return i*e/r+t}function te(i,t,e,r){return i/=r/2,i<1?e/2*i*i+t:(i--,-e/2*(i*(i-2)-1)+t)}function It(i,t,e,r){return i/=r/2,i<1?e/2*i*i*i+t:(i-=2,e/2*(i*i*i+2)+t)}function ee(i,t,e,r){return i/=r/2,i<1?e/2*i*i*i*i+t:(i-=2,-e/2*(i*i*i*i-2)+t)}function St(i,t,e,r){return i/=r/2,i<1?e/2*i*i*i*i*i+t:(i-=2,e/2*(i*i*i*i*i+2)+t)}function At(i,t,e,r){return i/=r/2,i<1?-e/2*(Math.sqrt(1-i*i)-1)+t:(i-=2,e/2*(Math.sqrt(1-i*i)+1)+t)}function Dt(i,t,e,r){return-e/2*(Math.cos(Math.PI*i/r)-1)+t}function zt(i,t,e,r){return i/=r/2,i<1?e/2*Math.pow(2,10*(i-1))+t:(i--,e/2*(-Math.pow(2,-10*i)+2)+t)}function re(i){let t={linear:jt,back:null,bounce:null,circular:At,cubic:It,elastic:null,exponential:zt,sine:Dt,quintic:St};for(let e in t)i[e]=t[e]}function Ne(i="None"){switch(i=i.toLowerCase(),i){case"none":case"linear":default:return jt;case"exponential":return zt;case"circular":return At;case"quadratic":return te;case"cubic":return It;case"quartic":return ee;case"quintic":return St;case"sine":return Dt}}var Xe=f(()=>{"use strict";o(jt,"linear");o(te,"quadratic");o(It,"cubic");o(ee,"quartic");o(St,"quintic");o(At,"circular");o(Dt,"sine");o(zt,"exponential");o(re,"extendWithEasingFunctions");o(Ne,"getEasingFuncByName")});function wr(i,t,e,r){for(let n in t)e.hasOwnProperty(n)||(e[n]=i[n]);for(let n in e)t.hasOwnProperty(n)||(t[n]=e[n]);return function(n,s,l){for(let c in e)e.hasOwnProperty(c)&&(n[c]=r.easing(s,e[c],t[c]-e[c],l))}}var w,ie,g,ne=f(()=>{"use strict";ht();Xe();w=class{constructor(t,e=0){this.target=t;this.duration=e;this.timer.addEventListener("timer",()=>{this._onTimerEvent()})}isPlaying=!1;position=0;repeats=0;timeKeeper=new U;timer=new S(40);easing=g.linear;step=()=>{};lastSeek;_onTimerEvent(){this.isPlaying&&(this.position+=this.timeKeeper.elapsed,this.timeKeeper.reset(),this.step(this.target,this.position,this.duration),this.position>=this.duration&&(this.repeats--,this.repeats<0?(this.stop(),this.position=this.duration):this.position=0,this.step(this.target,this.position,this.duration)))}clone(){let t=new w(this.target,this.duration);return t.easing=this.easing,t.step=this.step,t}scale(t){this.position*=t,this.duration*=t}play(){this.isPlaying||this.gotoAndPlay(this.position)}stop(){this.isPlaying&&this.gotoAndStop(this.position)}gotoAndStop(t){this.position=t,this.isPlaying&&(this.isPlaying=!1,this.timer.stop()),this.step(this.target,this.position,this.duration)}gotoAndPlay(t){this.position=t,this.isPlaying||(this.isPlaying=!0,this.timer.start()),this.step(this.target,this.position,this.duration)}togglePause(){this.isPlaying?this.stop():this.play()}};o(w,"ITween");o(wr,"createStepFunction");ie=class{static tween(t,e={},r={},n=0,s){let l=new w(t,n*1e3);return l.step=wr(t,e,r,l),s&&(l.easing=s),l}static to(t,e={},r=0,n){let s={};for(let l in e)e.hasOwnProperty(l)&&(typeof t[l]<"u"?s[l]=t[l]:s[l]=0);return ie.tween(t,e,s,r,n)}static bezier(t,e,r,n,s=1,l){let c=new w(t,s*1e3);l&&typeof l=="function"&&(c.easing=l);let p={};for(let m in n)Array.isArray(n[m])&&n[m].length>0&&(p[m]=n[m]);(typeof r>"u"||r===null)&&(r={}),(typeof e>"u"||e===null)&&(e={});for(let m in p)m in r||(r[m]=c.target[m]),m in e||(e[m]=p[m][p[m].length-1]);return c.step=function(m,M,nt){let J=Math.min(c.easing(M,0,1,nt),1);for(let k in p){let I=p[k],b=I.length,R=Math.floor(J*b),yt=(J-R/b)*b;if(b===1)m[k]=r[k]+2*J*(1-J)*(I[0]-r[k])+J*J*(e[k]-r[k]);else{let st=0,wt=0;R===0?(st=r[k],wt=(I[0]+I[1])/2):R===b-1?(st=(I[R-1]+I[R])/2,wt=e[k]):(st=(I[R-1]+I[R])/2,wt=(I[R]+I[R+1])/2),m[k]=st+2*yt*(1-yt)*(I[R]-st)+yt*yt*(wt-st)}}},c}static scale(t,e){let r=t.clone();return r.scale(e),r}static delay(t,e){let r=new w(t.target,t.duration+e*1e3);return r.step=function(n,s,l){s<=e*1e3||t.step(n,s-e*1e3,l-e*1e3)},r}static reverse(t){let e=new w(t.target,t.duration);return e.step=function(r,n,s){t.step(r,s-n,s)},e}static repeat(t,e){let r=new w(t.target,t.duration*e);return r.step=function(n,s,l){t.step(n,s%t.duration,t.duration)},r}static slice(t,e,r){r===null&&(r=t.duration),r<e&&(r=e),e*=1e3,r*=1e3;let n=new w(t.target,r-e);return n.step=function(s,l,c){t.step(s,e+l,t.duration)},n}static serial(...t){if(t.length===0)return new w({},0);let e=0,r=[],n=[];for(let l=0;l<t.length;l++)n.push(e),e+=t[l].duration,r.push(e);let s=new w({},e);return s.lastSeek=0,s.step=function(l,c,p){if(c<=r[s.lastSeek]){let m=t[s.lastSeek];m.step(m.target,c-n[s.lastSeek],m.duration);return}else{let m=t[s.lastSeek];m.step(m.target,m.duration,m.duration)}for(let m=0;m<r.length;m++)if(c<r[m]){s.lastSeek=m;let M=t[s.lastSeek];M.step(M.target,c-n[s.lastSeek],M.duration);return}},s}static parallel(...t){let e=0;for(let s=0;s<t.length;s++)e=Math.max(t[s].duration,e);let r=t,n=new w({},e);return n.step=function(s,l,c){for(let p=0;p<r.length;p++)r[p].step(r[p].target,Math.min(l,r[p].duration),r[p].duration)},n}},g=ie;o(g,"Tween"),a(g,"linear",jt),a(g,"quadratic",te),a(g,"cubic",It),a(g,"quartic",ee),a(g,"quintic",St),a(g,"circular",At),a(g,"sine",Dt),a(g,"exponential",zt),a(g,"extendWithEasingFunctions",re),a(g,"getEasingFuncByName",Ne),a(g,"ITween",w);re(self)});var P,ut=f(()=>{"use strict";_();ht();ne();P=class{_isRunning=!1;_ttl;_dur;_parent;_timer;_timeKeeper;_independentTimer;_tween;oncomplete;constructor(t,e=1e3,r=!1){if(typeof t>"u"||t===null)throw new Error("MotionManager must be bound to a DisplayObject.");this._ttl=e,this._dur=e,this._parent=t,this._independentTimer=r,this._timeKeeper=new U;let n=this;this._independentTimer?(this._timer=new S(41,0),this._timer.addEventListener("timer",()=>{n._onTimerEvent()}),this._timer.start()):this._parent.addEventListener("enterFrame",()=>{n._onTimerEvent()})}set dur(t){this._timeKeeper.reset(),this._ttl=t,this._dur=t}get dur(){return this._dur}get running(){return this._isRunning}_onTimerEvent(){this._isRunning&&this._dur!==0&&(this._ttl-=this._timeKeeper.elapsed,this._timeKeeper.reset(),this._ttl<=0&&(this.stop(),typeof this.oncomplete=="function"&&this.oncomplete(),this._parent.unload()))}reset(){this._ttl=this._dur,this._timeKeeper.reset()}play(){this._isRunning||this._dur===0||this._ttl<=0||(this._isRunning=!0,this._timeKeeper.reset(),this._tween&&this._tween.play())}stop(){this._isRunning&&(this._isRunning=!1,this._timeKeeper.reset(),this._tween&&this._tween.stop())}forecasting(t){return h("MotionManager.forecasting always returns false","warn"),!1}setPlayTime(t){this._ttl=this._dur-t,this._tween&&(this._isRunning?this._tween.gotoAndPlay(t):this._tween.gotoAndStop(t))}motionSetToTween(t){let e=[];for(let r in t){if(!t.hasOwnProperty(r))continue;let n=t[r];if(!n.hasOwnProperty("fromValue"))continue;n.hasOwnProperty("toValue")||(n.toValue=n.fromValue),n.hasOwnProperty("lifeTime")||(n.lifeTime=this._dur);let s={},l={};s[r]=n.fromValue,l[r]=n.toValue,typeof n.easing=="string"&&(n.easing=g.getEasingFuncByName(n.easing)),n.hasOwnProperty("startDelay")?e.push(g.delay(g.tween(this._parent,l,s,n.lifeTime,n.easing),n.startDelay/1e3)):e.push(g.tween(this._parent,l,s,n.lifeTime,n.easing))}return g.parallel.apply(g,e)}initTween(t,e){this._tween=this.motionSetToTween(t)}initTweenGroup(t,e){let r=[];for(let n=0;n<t.length;n++)r.push(this.motionSetToTween(t[n]));this._tween=g.serial.apply(g,r)}setCompleteListener(t){this.oncomplete=t}};o(P,"MotionManager")});var X,kt=f(()=>{"use strict";_();X=class{constructor(t){this.parent=t}lineWidth=1;_evaluateBoundingBox(t,e){this.parent.boundingBox.unionCoord(t+this.lineWidth/2,e+this.lineWidth/2)}_callDrawMethod(t,e){x("Runtime:CallMethod",{id:this.parent.getId(),context:"graphics",method:t,params:e})}lineTo(t,e){this._evaluateBoundingBox(t,e),this._callDrawMethod("lineTo",[t,e])}moveTo(t,e){this._evaluateBoundingBox(t,e),this._callDrawMethod("moveTo",[t,e])}curveTo(t,e,r,n){this._evaluateBoundingBox(r,n),this._evaluateBoundingBox(t,e),this._callDrawMethod("curveTo",[t,e,r,n])}cubicCurveTo(t,e,r,n,s,l){this._evaluateBoundingBox(t,e),this._evaluateBoundingBox(r,n),this._evaluateBoundingBox(s,l),this._callDrawMethod("cubicCurveTo",[t,e,r,n,s,l])}lineStyle(t,e=0,r=1,n=!1,s="normal",l="none",c="round",p=3){this.lineWidth=t,this._callDrawMethod("lineStyle",[t,e,r,l,c,p])}drawRect(t,e,r,n){this._evaluateBoundingBox(t,e),this._evaluateBoundingBox(t+r,e+n),this._callDrawMethod("drawRect",[t,e,r,n])}drawCircle(t,e,r){this._evaluateBoundingBox(t-r,e-r),this._evaluateBoundingBox(t+r,e+r),this._callDrawMethod("drawCircle",[t,e,r])}drawEllipse(t,e,r,n){this._evaluateBoundingBox(t-r/2,e-n/2),this._evaluateBoundingBox(t+r/2,e+n/2),this._callDrawMethod("drawEllipse",[t+r/2,e+n/2,r/2,n/2])}drawRoundRect(t,e,r,n,s,l){this._evaluateBoundingBox(t,e),this._evaluateBoundingBox(t+r,e+n),this._callDrawMethod("drawRoundRect",[t,e,r,n,s,l])}drawPath(t,e,r="evenOdd"){this._callDrawMethod("drawPath",[t,e,r])}beginFill(t,e=1){this._callDrawMethod("beginFill",[t,e])}beginGradientFill(t,e,r,n,s,l="pad",c="rgb",p=0){if(h("Graphics.beginGradientFill still needs work.","warn"),t!=="linear"&&t!=="radial"){h("Graphics.beginGradientFill unsupported fill type : "+t,"warn");return}this._callDrawMethod("beginGradientFill",[t,e,r,n,s?s.serialize:null,l,c,p])}beginShaderFill(t,e){h("Graphics.beginShaderFill not supported.","warn")}endFill(){this._callDrawMethod("endFill",[])}drawTriangles(t,e,r,n="none"){if(e)e=e.slice(0);else{e=[];for(let s=0;s<t.length;s+=2)e.push(s/2)}if(e.length%3!==0){h("Graphics.drawTriangles malformed indices count. Must be multiple of 3.","err");return}if(n!=="none")for(let s=0;s<e.length/3;s++){let l=t[2*e[s*3+1]]-t[2*e[s*3]],c=t[2*e[s*3+1]+1]-t[2*e[s*3]+1],p=t[2*e[s*3+2]]-t[2*e[s*3+1]],m=t[2*e[s*3+2]+1]-t[2*e[s*3+1]+1],M=l*m-p*c;(M<0&&n==="positive"||M>0&&n==="negative")&&(e.splice(s*3,3),s--)}for(let s=0;s<e.length;s++)this._evaluateBoundingBox(t[2*e[s]],t[2*e[s]+1]);this._callDrawMethod("drawTriangles",[t,e,n])}clear(){this.parent.boundingBox.setEmpty(),this._callDrawMethod("clear",[])}};o(X,"Graphics")});var Y,ct,et,Rt=f(()=>{"use strict";_();E();lt();kt();ft();Y=class extends v{_graphics;_mouseEnabled=!0;_mousePosition=new y(0,0);_useHandCursor=!1;constructor(t){super(t),this._graphics=new X(this)}get graphics(){return this._graphics}set graphics(t){h("Sprite.graphics is read-only.","warn")}get mouseEnabled(){return this._mouseEnabled}set mouseEnabled(t){this._mouseEnabled=t,this.propertyUpdate("mouseEnabled",t)}get useHandCursor(){return this._useHandCursor}set useHandCursor(t){this._useHandCursor=t,this.propertyUpdate("useHandCursor",t)}serialize(){let t=super.serialize();return t.class="Sprite",t}};o(Y,"Sprite");ct=class extends Y{_metaRoot;constructor(){super("__root"),this._metaRoot=Tt("__root")}get parent(){return h("SecurityError: No access above root sprite.","err"),null}addEventListener(t,e){h("Listener["+t+"] on root sprite inadvisible","warn"),this._metaRoot.addEventListener(t,e)}removeEventListener(t,e){this._metaRoot.removeEventListener(t,e,!1)}};o(ct,"RootSprite");et=class extends Y{_styles={};constructor(t){super(t)}clearStyle(t){delete this._styles[t]}getStyle(t){return this._styles[t]}setStyle(t,e){h("UIComponent.setStyle not implemented","warn"),this._styles[t]=e}setFocus(){this.methodCall("setFocus",null)}setSize(t,e){this.width=t,this.height=e}move(t,e){this.x=t,this.y=e}};o(et,"UIComponent")});function Ye(i){return new Vt(i)}var Vt,qe=f(()=>{"use strict";_();E();ut();Rt();Vt=class extends et{mM=new P(this);label="";constructor(t){super(),this.setDefaults(t),this.initStyle(t),B(this),this.bindParent(t),this.mM.play()}get motionManager(){return this.mM}set motionManager(t){h("IComment.motionManager is read-only","warn")}bindParent(t){t.hasOwnProperty("parent")&&t.parent?.addChild(this)}initStyle(t){(typeof t>"u"||t===null)&&(t={}),"lifeTime"in t?this.mM.dur=t.lifeTime*1e3:this.mM.dur=4e3,t.hasOwnProperty("text")&&(this.label=t.text),t.hasOwnProperty("motionGroup")?this.mM.initTweenGroup(t.motionGroup,this.mM.dur):t.hasOwnProperty("motion")&&this.mM.initTween(t.motion,!1)}serialize(){let t=super.serialize();return t.class="Button",t.text=this.label,t}};o(Vt,"CommentButton");o(Ye,"createButton")});function He(i){return new Gt(i)}var Gt,We=f(()=>{"use strict";_();E();ut();Rt();Gt=class extends Y{mM=new P(this);constructor(t){super(),this.setDefaults(t),this.initStyle(t),B(this),this.bindParent(t),this.mM.play()}get motionManager(){return this.mM}set motionManager(t){h("IComment.motionManager is read-only","warn")}bindParent(t){t.hasOwnProperty("parent")&&t.parent?.addChild(this)}initStyle(t){t.lifeTime&&(this.mM.dur=t.lifeTime*1e3),t.hasOwnProperty("motionGroup")?this.mM.initTweenGroup(t.motionGroup,this.mM.dur):t.hasOwnProperty("motion")&&this.mM.initTween(t.motion,!1)}};o(Gt,"CommentCanvas");o(He,"createCanvas")});function Ke(){return new bt}var bt,rt,se=f(()=>{"use strict";_();E();lt();bt=class{constructor(t="SimHei",e=25,r=16777215,n=!1,s=!1,l=!1,c="",p="",m="left",M=0,nt=0,J=0,k=0){this.font=t;this.size=e;this.color=r;this.bold=n;this.italic=s;this.underline=l}align;fontsize;serialize(){return{class:"TextFormat",font:this.font,size:this.size,color:this.color,bold:this.bold,underline:this.underline,italic:this.italic}}};o(bt,"TextFormat");rt=class extends v{constructor(e="",r=0){super(L("obj-textfield"));this._text=e;this._textFormat.color=r,this.boundingBox.width=this.textWidth,this.boundingBox.height=this.textHeight}_textFormat=new bt;_background=!1;_backgroundColor=16777215;_border=!1;_borderColor=0;get text(){return this._text}set text(e){this._text=e,this.boundingBox.width=this.textWidth,this.boundingBox.height=this.textHeight,this.propertyUpdate("text",this._text)}get length(){return this.text.length}set length(e){h("TextField.length is read-only.","warn")}get htmlText(){return this.text}set htmlText(e){h("TextField.htmlText is restricted due to security policy.","warn"),this.text=e.replace(/<\\/?[^>]+(>|\$)/g,"")}set textWidth(e){h("TextField.textWidth is read-only","warn")}set textHeight(e){h("TextField.textHeight is read-only","warn")}get textWidth(){return this._text.length*this._textFormat.size}get textHeight(){return this._textFormat.size}get color(){return this._textFormat.color}set color(e){this._textFormat.color=e,this.setTextFormat(this._textFormat)}get background(){return this._background}set background(e){this._background=e,this.propertyUpdate("background",e)}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){this._backgroundColor=e,this.propertyUpdate("backgroundColor",e)}get border(){return this._border}set border(e){this._border=e,this.propertyUpdate("border",e)}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e,this.propertyUpdate("borderColor",e)}getTextFormat(){return this._textFormat}setTextFormat(e){this._textFormat=e,this.methodCall("setTextFormat",e.serialize())}appendText(e){this.text=this.text+e}serialize(){let e=super.serialize();return e.class="TextField",e.text=this._text,e.textFormat=this._textFormat.serialize(),e}};o(rt,"TextField");o(Ke,"createTextFormat")});function Ze(i,t){return new _t(i,t)}function Je(){return new _t("",{})}var _t,\$e=f(()=>{"use strict";_();E();ut();se();_t=class extends rt{mM=new P(this);constructor(t,e={}){super(t,16777215),this.setDefaults(e),this.initStyle(e),B(this),this.bindParent(e),this.mM.play()}set fontsize(t){var e=this.getTextFormat();e.size=t,this.setTextFormat(e)}get fontsize(){return this.getTextFormat().fontsize}set font(t){var e=this.getTextFormat();e.font=t,this.setTextFormat(e)}get font(){return this.getTextFormat().font}set align(t){var e=this.getTextFormat();e.align=t,this.setTextFormat(e)}get align(){return this.getTextFormat().align}set bold(t){var e=this.getTextFormat();e.bold=t,this.setTextFormat(e)}get bold(){return this.getTextFormat().bold}get motionManager(){return this.mM}set motionManager(t){h("IComment.motionManager is read-only","warn")}bindParent(t){t.hasOwnProperty("parent")&&t.parent?.addChild(this)}initStyle(t={}){"lifeTime"in t&&(this.mM.dur=t.lifeTime*1e3),"fontsize"in t&&(this.getTextFormat().size=t.fontsize),"font"in t&&(this.getTextFormat().font=t.font),"color"in t&&(this.getTextFormat().color=t.color),"bold"in t&&(this.getTextFormat().bold=t.bold),t.hasOwnProperty("motionGroup")?this.mM.initTweenGroup(t.motionGroup,this.mM.dur):t.hasOwnProperty("motion")&&this.mM.initTween(t.motion,!1)}};o(_t,"CommentField");o(Ze,"createComment");o(Je,"createTextField")});var it,oe=f(()=>{"use strict";lt();kt();it=class extends v{_graphics;constructor(){super(),this._graphics=new X(this)}get graphics(){return this._graphics}serialize(){var t=super.serialize();return t.class="Shape",t}};o(it,"Shape")});function Qe(i){return new Lt(i)}var Lt,tr=f(()=>{"use strict";_();E();ut();oe();Lt=class extends it{_mM=new P(this);constructor(t){super(),this.setDefaults(t),this.initStyle(t),B(this),this.bindParent(t),this._mM.play()}get motionManager(){return this._mM}set motionManager(t){h("IComment.motionManager is read-only","warn")}bindParent(t){t.hasOwnProperty("parent")&&t.parent?.addChild(this)}initStyle(t={}){t.lifeTime&&(this._mM.dur=t.lifeTime*1e3),t.hasOwnProperty("motionGroup")?this._mM.initTweenGroup(t.motionGroup,this._mM.dur):t.hasOwnProperty("motion")&&this._mM.initTween(t.motion,!1)}};o(Lt,"CommentShape");o(Qe,"createShape")});function er(i=4,t=45,e=0,r=1,n=4,s=4,l=1,c=1){return new Xt(i,t,e,r,n,s,l,c)}function rr(i=16711680,t=1,e=6,r=6,n=2,s,l=!1,c=!1){return new Nt(i,t,e,r,n,s,l,c)}function ir(i=6,t=6,e=2){return new Ut(i,t)}function nr(){throw new Error("Display.createBevelFilter not implemented")}function sr(i=0,t=0,e,r=1,n=0,s=!0,l=!0,c=0,p=0){return new Yt(i,t,e,r,n,s,l,c,p)}function or(){throw new Error("Display.createDisplacementMapFilter not implemented")}function ar(){throw new Error("Display.createGradientBevelFilter not implemented")}function hr(){throw new Error("Display.createGradientGlowFilter not implemented")}function lr(){throw new Error("Display.createColorMatrixFilter not implemented")}var q,Ut,Nt,Xt,Yt,ur=f(()=>{"use strict";q=class{serialize(){return{class:"Filter",type:"nullfilter"}}};o(q,"Filter");Ut=class extends q{constructor(e=4,r=4){super();this.blurX=e;this.blurY=r}serialize(){let e=super.serialize();return e.type="blur",e.params={blurX:this.blurX,blurY:this.blurY},e}};o(Ut,"BlurFilter");Nt=class extends q{constructor(e=16711680,r=1,n=6,s=6,l=2,c,p=!1,m=!1){super();this.color=e;this.alpha=r;this.blurX=n;this.blurY=s;this.strength=l;this.quality=c;this.inner=p;this.knockout=m}serialize(){let e=super.serialize();return e.type="glow",e.params={color:this.color,alpha:this.alpha,blurX:this.blurX,blurY:this.blurY,strength:this.strength,inner:this.inner,knockout:this.knockout},e}};o(Nt,"GlowFilter");Xt=class extends q{constructor(e=4,r=45,n=0,s=1,l=4,c=4,p=1,m=1){super();this.distance=e;this.angle=r;this.color=n;this.alpha=s;this.blurX=l;this.blurY=c;this.strength=p;this.quality=m}inner=!1;knockout=!1;serialize(){let e=super.serialize();return e.type="dropShadow",e.params={distance:this.distance,angle:this.angle,color:this.color,blurY:this.blurY,strength:this.strength,inner:this.inner,knockout:this.knockout},e}};o(Xt,"DropShadowFilter");Yt=class extends q{constructor(e=0,r=0,n,s=1,l=0,c=!0,p=!0,m=0,M=0){super();this.matrixX=e;this.matrixY=r;this.matrix=n;this.divisor=s;this.bias=l;this.preserveAlpha=c;this.clamp=p;this.color=m;this.alpha=M}serialize(){let e=super.serialize();return e.type="convolution",e.matrix={x:this.matrixX,y:this.matrixY,data:this.matrix},e.divisor=this.divisor,e.preserveAlpha=this.preserveAlpha,e.clamp=this.clamp,e.color=this.color,e.alpha=this.alpha,e}};o(Yt,"ConvolutionFilter");o(er,"createDropShadowFilter");o(rr,"createGlowFilter");o(ir,"createBlurFilter");o(nr,"createBevelFilter");o(sr,"createConvolutionFilter");o(or,"createDisplacementMapFilter");o(ar,"createGradientBevelFilter");o(hr,"createGradientGlowFilter");o(lr,"createColorMatrixFilter")});var u,Bt=f(()=>{"use strict";_();Ue();Zt();Jt();qe();We();\$e();tr();lt();ur();kt();ft();ut();oe();Rt();se();\$t();u=class{static get stage(){return this.root}static get frameRate(){return this._frameRate}static set frameRate(t){this._frameRate=t,x("Display:SetFrameRate",t)}static toString(){return"[display Display]"}};o(u,"Display"),a(u,"Point",y),a(u,"Matrix",j),a(u,"Matrix3D",F),a(u,"Vector3D",O),a(u,"createMatrix",Se),a(u,"createMatrix3D",Ae),a(u,"createGradientBox",De),a(u,"createVector3D",ze),a(u,"projectVector",ke),a(u,"projectVectors",Re),a(u,"createPoint",Ct),a(u,"toIntVector",Ve),a(u,"toNumberVector",Ge),a(u,"ColorTransform",W),a(u,"createColorTransform",Le),a(u,"PerspectiveProjection",K),a(u,"Transform",N),a(u,"Filter",q),a(u,"createDropShadowFilter",er),a(u,"createGlowFilter",rr),a(u,"createBlurFilter",ir),a(u,"createBevelFilter",nr),a(u,"createConvolutionFilter",sr),a(u,"createDisplacementMapFilter",or),a(u,"createGradientBevelFilter",ar),a(u,"createGradientGlowFilter",hr),a(u,"createColorMatrixFilter",lr),a(u,"BlendMode",Qt),a(u,"Rectangle",C),a(u,"DisplayObject",v),a(u,"Graphics",X),a(u,"Sprite",Y),a(u,"RootSprite",ct),a(u,"UIComponent",et),a(u,"ByteArray",D),a(u,"Bitmap",gt),a(u,"BitmapData",Z),a(u,"MotionManager",P),a(u,"createButton",Ye),a(u,"createCanvas",He),a(u,"Shape",it),a(u,"createShape",Qe),a(u,"TextField",rt),a(u,"createTextFormat",Ke),a(u,"createComment",Ze),a(u,"createTextField",Je),a(u,"root",new ct),a(u,"loaderInfo"),a(u,"version",""),a(u,"width",0),a(u,"height",0),a(u,"fullScreenWidth",0),a(u,"fullScreenHeight",0),a(u,"_frameRate",24);Q("Update:DimensionUpdate",i=>{u.width=i.stageWidth,u.height=i.stageHeight,i.hasOwnProperty("screenWidth")&&i.hasOwnProperty("screenHeight")&&(u.fullScreenWidth=i.screenWidth,u.fullScreenHeight=i.screenHeight)})});function Mr(i,t,e){let r=1,n=1,s=1;if(t){let l=i%360/60,c=l|0,p=l-c,m=1-t,M=1-t*p,nt=1-t*(1-p);switch(c){case 0:r=1,n=nt,s=m;break;case 1:r=M,n=1,s=m;break;case 2:r=m,n=1,s=nt;break;case 3:r=m,n=M,s=1;break;case 4:r=nt,n=m,s=1;break;case 5:r=1,n=m,s=M;break}}return r*=255*e,n*=255*e,s*=255*e,r<<16|n<<8|s}var z,cr=f(()=>{"use strict";ht();o(Mr,"HSV2RGB");z=class{static rgb(t,e,r){return t<<16|e<<8|r}static hue(t,e=1,r=1){return Mr(t,e,r)}static formatTimes(t){return Math.floor(t/60)+":"+(t%60>9?"":"0")+t%60}static distance(t,e,r,n){return Math.sqrt((t-r)*(t-r)+(e-n)*(e-n))}static rand(t,e){return t+Math.floor(Math.random()*(e-t))}static getTimer(){return Date.now()-this.startTime}static timer(t,e=1e3){return A().setTimeout(t,e)}static interval(t,e=1e3,r=1){if(r===0)return A().setInterval(t,e);let n=A().setInterval(function(){r--,r<0?A().clearInterval(n):t()},e);return n}static clearTimeout(t){A().clearTimeout(t)}static clearInterval(t){A().clearInterval(t)}};o(z,"Utils"),a(z,"startTime",Date.now())});var xt,G,mr=f(()=>{"use strict";xt=class{},G=xt;o(G,"Global"),a(G,"_store",{}),a(G,"_set",(t,e)=>{xt._store[t]=e}),a(G,"_get",t=>xt._store[t]),a(G,"_",t=>xt._get(t))});function pr(i){typeof i=="object"?h(JSON.stringify(i),"log"):h(i,"log")}function dr(i,t){typeof t=="function"&&t()}function fr(i){if(i===null||typeof i!="object")return i;if(typeof i.clone=="function")return i.clone();if(Array.isArray(i))return i.slice(0);let t={};t.constructor=t.constructor,t.prototype=t.prototype;for(let e in i)t[e]=i[e];return t}function gr(i,t){if(!(i===null||typeof i!="object")&&!(i instanceof u.DisplayObject))for(let e in i)i.hasOwnProperty(e)&&t(e,i[e])}var br=f(()=>{"use strict";Bt();_();o(pr,"trace");o(dr,"load");o(fr,"clone");o(gr,"foreach")});var Tr=xr((ae,he)=>{_();Kt();Bt();ne();cr();mr();br();ot.createChannel("::eval",1,Math.round(Math.random()*1e5));ot.createChannel("::debug",1,Math.round(Math.random()*1e5));Q("::eval",function(msg){(function(__code,importScripts,postMessage,addEventListener,self){let Runtime=d,Display=u,\$=u,Tween=g,Utils=z,getTimer=z.getTimer,interval=z.interval,timer=z.timer,Global=G,\$G=G,clearTimeout=z.clearTimeout,clearInterval=z.clearInterval,trace=pr,load=dr,clone=fr,foreach=gr;eval(__code)})(msg)});Q("::debug",function(msg){if(typeof msg>"u"||msg===null||!msg.hasOwnProperty("action")){V("::worker:debug","worker","Malformed request");return}if(msg.action==="list-channels")V("::worker:debug","worker",ot.listChannels());else if(msg.action==="raw-eval")try{V("::worker:debug","worker",eval(msg.code))}catch(i){V("::worker:debug","worker","Error: "+i)}else V("::worker:debug","worker","Unrecognized action")});V("::worker:state","worker","running")});export default Tr();
`, "Worker", undefined, undefined);
}
