import worker from '@jsc/danmaku/worker-loader/inline';

// 运行在work中的弹幕解析器，须提前构建
export default function () {
  return worker(`(()=>{var Nt=Object.defineProperty;var Ee=(r,t,e)=>t in r?Nt(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var a=(r,t)=>Nt(r,"name",{value:t,configurable:!0});var o=(r,t,e)=>(Ee(r,typeof t!="symbol"?t+"":t,e),e);function V(...r){setTimeout(console.log.bind(console,"%c[AS3 parser]","color: blue;",...r))}a(V,"debug");V.log=function(...r){setTimeout(console.log.bind(console,"%c[AS3 parser]","color: blue;",...r))};V.debug=function(...r){setTimeout(console.debug.bind(console,"[AS3 parser]",...r))};V.warn=function(...r){setTimeout(console.warn.bind(console,"[AS3 parser]",...r))};V.error=function(...r){setTimeout(console.error.bind(console,"[AS3 parser]",...r))};var bt=class{channels={};constructor(){self.addEventListener("message",t=>{if(t)try{let e=JSON.parse(t.data);e.hasOwnProperty("channel")&&typeof e.channel=="string"?this.dispatchMessage(e):u(e,"warn")}catch(e){u(e,"err")}})}dispatchMessage(t){t.channel in this.channels&&this.channels[t.channel]?.listeners.forEach(e=>{try{e(t.payload)}catch(i){i.stack?u(i.stack?.toString(),"err"):u(i.toString(),"err")}})}listChannels=()=>{let t={};for(let e in this.channels)t[e]={max:this.channels[e].max,listeners:this.channels[e].listeners.length};return t};deleteChannel=(t,e)=>t in this.channels?e||this.channels[t].auth?e===this.channels[t].auth?(delete this.channels[t],!0):!1:(delete this.channels[t],!0):!0;createChannel=(t,e,i)=>t in this.channels?!1:(this.channels[t]={max:e||0,auth:i,listeners:[]},!0);addListenerChannel=(t,e)=>(t in this.channels||(this.channels[t]={max:0,listeners:[]}),this.channels[t].max>0&&this.channels[t].listeners.length>=this.channels[t].max?!1:(this.channels[t].listeners.push(e),!0))};a(bt,"OOAPI");var nt=new bt;function u(r,t){switch(t){case"warn":V.warn(r);break;case"err":V.error(r);break;case"fatal":V.error(r),self.postMessage(JSON.stringify({channel:"fatal",obj:r}));break;default:V(r);break}}a(u,"__trace");function jt(r,t,e){self.postMessage(JSON.stringify({channel:r,payload:t,callback:!0})),nt.addListenerChannel(r,e)}a(jt,"__channel");function D(r,t){nt.addListenerChannel(r,t)}a(D,"__schannel");function g(r,t){self.postMessage(JSON.stringify({channel:r,payload:t,callback:!1}))}a(g,"__pchannel");function R(r,t,e){self.postMessage(JSON.stringify({channel:r,auth:t,payload:e,callback:!1}))}a(R,"__achannel");var K=class{static xorshift128p(){var t=this._rngState[1],e=this._rngState[0];this._rngState[0]=t,e^=e<<23,e^=e>>17,e^=t,e^=t>>26,this._rngState[1]=e}static random(t=16){if(t===void 0&&(t=16),t>32)throw new Error("NotCrypto.random expects 32 bits or less");if(Math&&Math.random){for(var e=0,i=0;i<t;i++)e=(e<<1)+(Math.random()<.5?0:1);return e}else return this.fallbackRandom(Date.now()%1024,t)}static fallbackRandom(t,e=16){if(e===void 0&&(e=16),e>32)throw new Error("NotCrypto.fallbackRandom expects 32 bits or less");for(var i=0;i<t;i++)this.xorshift128p();for(var n=0,i=0;i<e;i++)n=(n<<1)+1;return this._rngState[0]+this._rngState[1]&n}static toHex(t,e){if(e===void 0&&(e=0),e<=0)return t.toString(16);for(var i=t.toString(16);i.length<e;)i="0"+i;return i}};a(K,"NotCrypto"),o(K,"_rngState",[Math.floor(Date.now()/1024)%1024,Date.now()%1024]);var Z=class{name;listeners={};constructor(t){if(t.slice(0,2)!=="__")throw new Error("MetaObject names must start with two underscores.");this.name=t}addEventListener(t,e,i=!1,n=0){t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push(e)}removeEventListener(t,e,i=!1){if(!(t in this.listeners))return;let n=this.listeners[t].indexOf(e);n>=0&&this.listeners[t].splice(n,1)}hasEventListener(t){return t in this.listeners&&this.listeners[t].length>0}dispatchEvent(t,e){if(t in this.listeners)for(let i=0;i<this.listeners[t].length;i++)this.listeners[t][i](e)}getId(){return this.name}serialize(){return{class:this.name}}unload(){throw new Error("Meta objects should not be unloaded!")}};a(Z,"MetaObject");var gt={};function qt(r,t){jt("Runtime:RequestPermission",{name:r},e=>{e===!0?gt[r]=!0:gt[r]=!1,typeof t=="function"&&t(e)})}a(qt,"requestPermission");function Yt(r){return!!(gt.hasOwnProperty(r)&&gt[r])}a(Yt,"hasPermission");function Xt(r,t,e){jt("Runtime:PrivilegedAPI",{method:"openWindow",params:[r,t]},function(i){e?.({moveTo:function(s,h){g("Runtime:PrivilegedAPI",{method:"window",params:[i,"moveTo",[s,h]]})},resizeTo:function(s,h){g("Runtime:PrivilegedAPI",{method:"window",params:[i,"resizeTo",[s,h]]})},focus:function(){g("Runtime:PrivilegedAPI",{method:"window",params:[i,"focus"]})},close:function(){g("Runtime:PrivilegedAPI",{method:"window",params:[i,"close"]})}})})}a(Xt,"openWindow");function Ht(r,t){g("Runtime:PrivilegedAPI",{method:"injectStyle",params:[r,t]})}a(Ht,"injectStyle");function Wt(){u("Runtime.privilegedCode not available.","warn")}a(Wt,"privilegedCode");var q=class{static _registerElement(t,e){this.managedElements[t]=e}static clearTimer(){m.getTimer().clearAll("interval")}static clearEl(){u("ScriptManager.clearEl may not be properly implemented.","warn"),m.clear()}static clearTrigger(){u("ScriptManager.clearTrigger not implemented.","warn")}static pushEl(t){u("ScriptManager.pushEl is not properly implemented.","warn"),t.motionManager&&t.motionManager.start(),t.visible=!0}static popEl(t){u("ScriptManager.popEl is not properly implemented.","warn"),t.motionManager&&t.motionManager.play(),t.visible=!1}static pushTimer(t){u("ScriptManager.pushTimer not implemented.","warn")}static popTimer(t){u("ScriptManager.popTimer not implemented.","warn")}toString(){return"[scriptManager ScriptManager]"}};a(q,"ScriptManager"),o(q,"managedElements",{});var Kt={js:["*"],Runtime:["*","openWindow","injectStyle"],Display:["*"],Player:["*"],Tween:["*"],Utils:["*"]};function Zt(r,t="*"){if(Kt.hasOwnProperty(r)){if(Kt[r].indexOf(t)>=0)return!0}else return!1;return!1}a(Zt,"supports");function Qt(r,t){r==="libBitmap"?t(null,{type:"noop"}):t(new Error("Could not load unknown library ["+r+"]"),null)}a(Qt,"requestLibrary");var ot=class{constructor(t,e,i,n){this.type=t;this.dur=e;this.key=i;this.callback=n;this.ttl=e}ttl};a(ot,"RuntimeTimer");var ht=class{constructor(t=10){this.precision=t}timer=-1;timers=[];lastToken=0;key=0;set isRunning(t){t==!1?this.stop():this.start()}get isRunning(){return this.timer>-1}start(){this.timer<0&&(this.lastToken=Date.now(),this.timer=setInterval(()=>{let t=Date.now()-this.lastToken;for(let e=0;e<this.timers.length;e++){let i=this.timers[e];if(i.type==="timeout"){if(i.ttl-=t,i.ttl<=0){try{i.callback()}catch(n){u(n.stack?.toString(),"err")}this.timers.splice(e,1),e--}}else if(i.type==="interval"&&(i.ttl-=t,i.ttl<=0)){try{i.callback()}catch(n){u(n.stack?.toString(),"err")}i.ttl+=i.dur}}this.lastToken=Date.now()},this.precision))}stop(){this.timer>-1&&(clearInterval(this.timer),this.timer=-1)}setInterval(t,e){let i=this.key++;return this.timers.push(new ot("interval",e,i,t)),i}setTimeout(t,e){let i=this.key++;return this.timers.push(new ot("timeout",e,i,t)),i}clearInterval(t){for(let e=0;e<this.timers.length;e++)if(this.timers[e].type==="interval"&&this.timers[e].key===t){this.timers.splice(e,1);return}}clearTimeout(t){for(let e=0;e<this.timers.length;e++)if(this.timers[e].type==="timeout"&&this.timers[e].key===t){this.timers.splice(e,1);return}}clearAll(t="all"){t==="timer"?this.timers=this.timers.filter(e=>e.type!=="timer"):t==="interval"?this.timers=this.timers.filter(e=>e.type!=="interval"):this.timers=[]}};a(ht,"TimerRuntime");var F=class{constructor(t,e=0){this.delay=t;this.repeatCount=e}microtime=0;timer=-1;listeners=[];complete=[];currentCount=0;set isRunning(t){u("Timer.isRunning is read-only","warn")}get isRunning(){return this.timer>=0}start(){if(!this.isRunning){let t=Date.now(),e=this;this.timer=setInterval(()=>{let i=Date.now()-t;e.microtime+=i,e.microtime>e.delay&&(e.microtime-=e.delay,e.currentCount++,e.dispatchEvent("timer")),t=Date.now(),e.repeatCount>0&&e.repeatCount<=e.currentCount&&(e.stop(),e.dispatchEvent("timerComplete"))},20)}}stop(){this.isRunning&&(clearInterval(this.timer),this.timer=-1)}reset(){this.stop(),this.currentCount=0,this.microtime=0}addEventListener(t,e){t==="timer"?this.listeners.push(e):t==="timerComplete"&&this.complete.push(e)}dispatchEvent(t){if(t==="timer")for(let e=0;e<this.listeners.length;e++)this.listeners[e]();else if(t==="timerComplete")for(let e=0;e<this.complete.length;e++)this.complete[e]()}};a(F,"Timer");var B=class{constructor(t=()=>Date.now()){this.clock=t;this.reset()}lastTime=0;get elapsed(){return this.clock()-this.lastTime}reset(){this.lastTime=this.clock()}};a(B,"TimeKeeper");var st=class{static dispatchEvent(t,e,i){let n=this.registeredObjects[t];typeof n=="object"&&n.dispatchEvent&&n.dispatchEvent(e,i)}static hasObject(t){return this.registeredObjects.hasOwnProperty(t)&&this.registeredObjects[t]!==null}static getObject(t){return this.registeredObjects[t]}static registerObject(t){if(!t.getId){u("Cannot register object without getId method.","warn");return}if(st.hasObject(t.getId())){u("Attempted to re-register object or id collision @ "+t.getId(),"warn");return}else{this.registeredObjects[t.getId()]=t,g("Runtime:RegisterObject",{id:t.getId(),data:t.serialize()}),D("object::("+t.getId()+")",e=>{e.hasOwnProperty("type")&&e.type==="event"&&this.dispatchEvent(t.getId(),e.event,e.data)}),this.objCount++;return}}static eregisterObject(t){let e=t.getId();this.deregisterObjectById(e)}static deregisterObjectById(t){if(st.hasObject(t)){if(t.substr(0,2)==="__"){u("Runtime.deregisterObject cannot de-register a MetaObject","warn");return}g("Runtime:DeregisterObject",{id:t}),typeof this.registeredObjects[t].unload=="function"&&this.registeredObjects[t].unload(),this.registeredObjects[t]=null,delete this.registeredObjects[t]}}static _makeId(t="obj"){return t+":"+Date.now()+"|"+K.random(16)+":"+this.objCount}static generateId(t="obj"){let e=this._makeId(t);for(;this.hasObject(e);)e=this._makeId(t);return e}static reset(){for(let t in this.registeredObjects)t.substr(0,2)!=="__"&&this.deregisterObjectById(t)}static clear(){for(let t in this.registeredObjects)t.substr(0,2)!=="__"&&typeof this.registeredObjects[t].unload=="function"&&this.registeredObjects[t].unload()}static crash(){u("Runtime.crash() : Manual crash","fatal")}static exit(){R("::worker:state","worker","terminated"),self.close()}static alert(t){R("Runtime::alert","::Runtime",t)}static getTimer(){return this.masterTimer}static updateFrameRate(t){if(t>60||t<0){u("Frame rate should be in the range (0, 60]","warn");return}if(t===0){this.internalTimer.stop();return}this.internalTimer.stop(),this.internalTimer=new F(Math.floor(1e3/t)),this.internalTimer.addEventListener("timer",this.enterFrameDispatcher),this.internalTimer.start()}},m=st;a(m,"Runtime"),o(m,"NotCrypto",K),o(m,"Timer",F),o(m,"TimeKeeper",B),o(m,"_defaultScriptManager",new q),o(m,"requestPermission",qt),o(m,"hasPermission",Yt),o(m,"openWindow",Xt),o(m,"injectStyle",Ht),o(m,"privilegedCode",Wt),o(m,"supports",Zt),o(m,"requestLibrary",Qt),o(m,"objCount",0),o(m,"registeredObjects",{__self:new Z("__self"),__player:new Z("__player"),__root:new Z("__root")}),o(m,"masterTimer",new ht),o(m,"internalTimer",new F(40)),o(m,"enterFrameDispatcher",()=>{for(let t in st.registeredObjects)if(!(t.substring(0,2)==="__"&&t!=="__root"))try{st.registeredObjects[t].dispatchEvent("enterFrame")}catch{}});m.masterTimer.start();m.internalTimer.start();m.internalTimer.addEventListener("timer",m.enterFrameDispatcher);var S=class extends Array{_readPosition=0;constructor(...t){super(...t);try{Object.setPrototypeOf(this,S.prototype)}catch{}}get bytesAvailable(){return this.length-this._readPosition}set bytesAvailable(t){u("ByteArray.bytesAvailable is read-only","warn")}get position(){return this._readPosition}set position(t){this._readPosition=t}clear(){this.length=0,this._readPosition=0}compress(t="zlib"){u("ByteArray.compress["+t+"] not implemented","warn"),this._readPosition=0}uncompress(t="zlib"){u("ByteArray.uncompress["+t+"] not implemented","warn"),this._readPosition=0}deflate(){u("ByteArray.deflate not implemented","warn")}inflate(){u("ByteArray.inflate not implemented","warn")}readUTFBytes(t){let e=this.slice(this._readPosition,t);return this._readPosition+=Math.min(t,this.length-this._readPosition),e.reduce((i,n)=>(i+=String.fromCharCode(n),i),"")}readUnsignedByte(){return this[this._readPosition]&255}readUnsignedShort(){let t=this.readUnsignedByte(),e=this.readUnsignedByte();return(t<<8)+e&65535}readUnsignedInt(){let t=this.readUnsignedByte(),e=this.readUnsignedByte(),i=this.readUnsignedByte(),n=this.readUnsignedByte();return(t<<24)+(e<<16)+(i<<8)+n&4294967295}readByte(){return this.readUnsignedByte()-128}readShort(){return this.readUnsignedShort()-32767}readBoolean(){return this.readUnsignedByte()!==0}readFloat(){let t=this.readUnsignedInt(),e=t&2147483648?-1:1,i=t>>23&255,n=t&8388607;switch(e){case 0:break;case 255:return i?NaN:n>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;default:return e-=127,i+=8388608,n*(i/8388608)*Math.pow(2,e)}}writeByte(t){this.push(t&255)}writeBytes(t,e=0,i=0){for(let n=e;n<Math.min(t.length-e,i);n++)this.writeByte(t[n])}writeUTFBytes(t){let e=unescape(encodeURIComponent(t));for(let i=0;i<t.length;i++)this.push(e.charCodeAt(i))}clone(){let t=new S;return this.forEach(function(e){t.push(e)}),t}};a(S,"ByteArray");function Fe(r,t,e){let i=1,n=1,s=1;if(t){let h=r%360/60,c=h|0,d=h-c,p=1-t,v=1-t*d,rt=1-t*(1-d);switch(c){case 0:i=1,n=rt,s=p;break;case 1:i=v,n=1,s=p;break;case 2:i=p,n=1,s=rt;break;case 3:i=p,n=v,s=1;break;case 4:i=rt,n=p,s=1;break;case 5:i=1,n=p,s=v;break}}return i*=255*e,n*=255*e,s*=255*e,i<<16|n<<8|s}a(Fe,"HSV2RGB");var x=class{static rgb(t,e,i){return t<<16|e<<8|i}static hue(t,e=1,i=1){return Fe(t,e,i)}static formatTimes(t){return Math.floor(t/60)+":"+(t%60>9?"":"0")+t%60}static distance(t,e,i,n){return Math.sqrt((t-i)*(t-i)+(e-n)*(e-n))}static rand(t,e){return t+Math.floor(Math.random()*(e-t))}static getTimer(){return Date.now()-this.startTime}static timer(t,e=1e3){return m.getTimer().setTimeout(t,e)}static interval(t,e=1e3,i=1){if(i===0)return m.getTimer().setInterval(t,e);let n=m.getTimer().setInterval(function(){i--,i<0?m.getTimer().clearInterval(n):t()},e);return n}static clearTimeout(t){m.getTimer().clearTimeout(t)}static clearInterval(t){m.getTimer().clearInterval(t)}};a(x,"Utils"),o(x,"startTime",Date.now());var _t=class{constructor(t,e){this.source=t;this.onload=e}id=m.generateId("obj-snd");isPlaying=!1;createFromURL(t){this.source=t}play(){this.isPlaying}remove(){}stop(){this.isPlaying}loadPercent(){return 0}getId(){return this.id}dispatchEvent(t,e){}unload(){this.stop()}serialize(){return{class:"Sound",url:this.source}}};a(_t,"Sound");function Be(r,t){return new _t(r,t)}a(Be,"createSound");var f=class{static get time(){return this.state!=="playing"?this._time:this._time+this.lastUpdate.elapsed}static play(){g("Player::action",{action:"play"})}static pause(){g("Player::action",{action:"pause"})}static seek(t){g("Player::action",{action:"seek",params:t})}static jump(t,e=1,i=!1){g("Player::action",{action:"jump",params:{vid:t,page:e,window:i}})}static commentTrigger(t,e=1e3){if(!m.hasObject("__player")){u("Your environment does not support player triggers.","err");return}if(e<0)return;let i=m.getObject("__player");function n(s){t(s)}a(n,"temp"),i.addEventListener("comment",n),x.timer(()=>i.removeEventListener("comment",n),e)}static keyTrigger(t,e=1e3,i=!1){if(!m.hasObject("__player")){u("Your environment does not support key triggers.","err");return}if(e<0)return;function n(c){t(c.key)}a(n,"temp");let s="key"+(i?"up":"down"),h=m.getObject("__player");h.addEventListener(s,n),x.timer(()=>h.removeEventListener(s,n),e)}static setMask(t){u("Masking not supported yet","warn")}static toString(){return"[player Player]"}};a(f,"Player"),o(f,"createSound",Be),o(f,"state",""),o(f,"_time",""),o(f,"commentList",[]),o(f,"refreshRate",0),o(f,"width",0),o(f,"height",0),o(f,"videoWidth",0),o(f,"videoHeight",0),o(f,"version",0),o(f,"lastUpdate",new B);D("Update:DimensionUpdate",r=>{f.width=r.stageWidth,f.height=r.stageHeight,r.hasOwnProperty("videoWidth")&&r.hasOwnProperty("videoHeight")&&(f.videoWidth=r.videoWidth,f.videoHeight=r.videoHeight)});D("Update:TimeUpdate",r=>{f.state=r.state,f._time=r.time,f.lastUpdate.reset()});var y=class{constructor(t=0,e=0){this.x=t;this.y=e}set length(t){u("Point.length is read-only","err")}get length(){return Math.sqrt(this.x*this.x+this.y*this.y)}add(t){return new y(t.x+this.x,t.y+this.y)}subtract(t){return new y(this.x-t.x,this.y-t.y)}static interpolate(t,e,i){return new y((e.x-t.x)*i+t.x,(e.y-t.y)*i+t.y)}offset(t,e){this.x+=t,this.y+=e}normalize(t){let e=t/this.length;this.x*=e,this.y*=e}static polar(t,e){return new y(t*Math.cos(e),t*Math.sin(e))}setTo(t,e){this.x=t,this.y=e}equals(t){return t.x===this.x&&t.y===this.y}toString(){return"(x="+this.x+", y="+this.y+")"}clone(){return new y(this.x,this.y)}};a(y,"Point");var I=class{_data;constructor(t=1,e=0,i=0,n=1,s=0,h=0){this._data=[t,i,s,e,n,h,0,0,1]}dotProduct(t){if(t.length<9)throw new Error("Matrix dot product expects a 3x3 Matrix");let e=[0,0,0,0,0,0,0,0,0];for(let i=0;i<3;i++)for(let n=0;n<3;n++)for(let s=0;s<3;s++)e[i*3+n]+=this._data[i*3+s]*t[s*3+n];return e}setTo(t=1,e=0,i=0,n=1,s=0,h=0){this._data=[t,i,s,e,n,h,0,0,1]}translate(t,e){this._data[2]+=t,this._data[5]+=e}rotate(t){this._data=this.dotProduct([Math.cos(t),-Math.sin(t),0,Math.sin(t),Math.cos(t),0,0,0,1])}scale(t,e){this._data=this.dotProduct([t,0,0,0,e,0,0,0,1])}identity(){this.setTo(1,0,0,1,0,0)}createGradientBox(t,e,i,n,s){this.createBox(t,e,i,n,s)}createBox(t,e,i,n,s){this.identity(),this.rotate(i),this.scale(t,e),this.translate(n,s)}clone(){let t=this._data[0],e=this._data[3],i=this._data[1],n=this._data[4],s=this._data[2],h=this._data[5];return new I(t,e,i,n,s,h)}serialize(){return this._data}};a(I,"Matrix");var C=class{_data;constructor(t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){t.length===16?this._data=t:t.length===0?this.identity():(u("Matrix3D initialization vector invalid","warn"),this.identity())}dotProduct(t,e){if(t.length!==16||e.length!==16)throw new Error("Matrix3D dot product expects a 4xr Matrix3D");let i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(let n=0;n<4;n++)for(let s=0;s<4;s++)for(let h=0;h<4;h++)i[n*4+s]+=t[n*4+h]*e[h*4+s];return i}rotationMatrix(t,e){let i=Math.sin(t),n=Math.cos(t);return[n+e.x*e.x*(1-n),e.x*e.y*(1-n)-e.z*i,e.x*e.z*(1-n)+e.y*i,0,e.x*e.y*(1-n)+e.z*i,n+e.y*e.y*(1-n),e.y*e.z*(1-n)-e.x*i,0,e.z*e.x*(1-n)-e.y*i,e.z*e.y*(1-n)+e.x*i,n+e.z*e.z*(1-n),0,0,0,0,1]}identity(){this._data=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}append(t){this._data=this.dotProduct(t._data,this._data)}appendRotation(t,e,i){i&&this.appendTranslation(i.x,i.y,i.z),this._data=this.dotProduct(this.rotationMatrix(t*Math.PI/180,e),this._data),i&&this.appendTranslation(-i.x,-i.y,-i.z)}appendTranslation(t,e,i){this._data=this.dotProduct([1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1],this._data)}appendScale(t=1,e=1,i=1){this._data=this.dotProduct([t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1],this._data)}prepend(t){this._data=this.dotProduct(this._data,t._data)}prependRotation(t,e,i){i&&this.prependTranslation(i.x,i.y,i.z),this._data=this.dotProduct(this._data,this.rotationMatrix(t*Math.PI/180,e)),i&&this.prependTranslation(-i.x,-i.y,-i.z)}prependTranslation(t,e,i){this._data=this.dotProduct(this._data,[1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1])}prependScale(t,e,i){this._data=this.dotProduct(this._data,[t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1])}transformVector(t){let e=this._data[0]*t.x+this._data[1]*t.y+this._data[2]*t.z+this._data[3]*t.w,i=this._data[4]*t.x+this._data[5]*t.y+this._data[6]*t.z+this._data[7]*t.w,n=this._data[8]*t.x+this._data[9]*t.y+this._data[10]*t.z+this._data[11]*t.w,s=this._data[12]*t.x+this._data[13]*t.y+this._data[14]*t.z+this._data[15]*t.w;return new O(e,i,n,s)}transformVectors(t,e){if(t.length%3!==0){u("Matrix3D.transformVectors expects input size to be multiple of 3.","err");return}for(let i=0;i<t.length/3;i++){let n=t[i*3],s=t[i*3+1],h=t[i*3+2],c=this._data[0]*n+this._data[1]*s+this._data[2]*h,d=this._data[4]*n+this._data[5]*s+this._data[6]*h,p=this._data[8]*n+this._data[9]*s+this._data[10]*h;e.push(c,d,p)}}transpose(){this._data=[this._data[0],this._data[4],this._data[8],this._data[12],this._data[1],this._data[5],this._data[9],this._data[13],this._data[2],this._data[6],this._data[10],this._data[14],this._data[3],this._data[7],this._data[11],this._data[15]]}clone(){return new C(this._data)}serialize(){return this._data}};a(C,"Matrix3D");var ut=class{constructor(t=0,e=0,i=0,n=0){this.x=t;this.y=e;this.z=i;this.w=n}toString(){return"(x="+this.x+", y="+this.y+", z="+this.z+", w="+this.w+")"}},O=ut;a(O,"Vector3D"),o(O,"X_AXIS",new ut(1,0,0)),o(O,"Y_AXIS",new ut(0,1,0)),o(O,"Z_AXIS",new ut(0,0,1));function Jt(r,t,e,i,n,s){return new I(r,t,e,i,n,s)}a(Jt,"createMatrix");function \$t(r){return new C(r)}a(\$t,"createMatrix3D");function te(r,t,e,i,n){let s=new I;return s.createGradientBox(r/1638.4,t/1638.4,e,i+r/2,n+t/2),s}a(te,"createGradientBox");function ee(r=0,t=0,e=0,i=0){return new O(r,t,e,i)}a(ee,"createVector3D");function re(r,t){return r.transformVector(t)}a(re,"projectVector");function ie(r,t,e,i){for(;e.length>0;)e.pop();if(t.length%3!==0){u("Display.projectVectors input vertex Vector must be a multiple of 3.","err");return}let n=[];r.transformVectors(t,n);for(let s=0;s<n.length/3;s++){let h=n[s*3],c=n[s*3+1];e.push(h,c)}}a(ie,"projectVectors");function xt(r=0,t=0){return new y(r,t)}a(xt,"createPoint");function ne(r){return Object.defineProperty(r,"as3Type",{get:function(){return"Vector<int>"},set:function(t){u("as3Type should not be set.","warn")}}),r.map(Math.floor)}a(ne,"toIntVector");function se(r){return Object.defineProperty(r,"as3Type",{get:function(){return"Vector<number>"},set:function(t){u("as3Type should not be set.","warn")}}),r}a(se,"toNumberVector");var Y=class{constructor(t=1,e=1,i=1,n=1,s=0,h=0,c=0,d=0){this.redMultiplier=t;this.greenMultiplier=e;this.blueMultiplier=i;this.alphaMultiplier=n;this.redOffset=s;this.greenOffset=h;this.blueOffset=c;this.alphaOffset=d}get color(){return this.redOffset<<16|this.greenOffset<<8|this.blueOffset}set color(t){this.redOffset=t>>16&255,this.greenOffset=t>>8&255,this.blueOffset=t&255,this.redMultiplier=0,this.greenMultiplier=0,this.blueMultiplier=0}concat(t){this.redMultiplier*=t.redMultiplier,this.greenMultiplier*=t.greenMultiplier,this.blueMultiplier*=t.blueMultiplier,this.alphaMultiplier*=t.alphaMultiplier,this.redOffset+=t.redOffset,this.greenOffset+=t.greenOffset,this.blueOffset+=t.blueOffset,this.alphaOffset+=t.alphaOffset}serialize(){return{class:"ColorTransform",red:{offset:this.redOffset,multiplier:this.redMultiplier},green:{offset:this.greenOffset,multiplier:this.greenMultiplier},blue:{offset:this.blueOffset,multiplier:this.blueMultiplier},alpha:{offset:this.alphaOffset,multiplier:this.alphaMultiplier}}}};a(Y,"ColorTransform");function ae(r=1,t=1,e=1,i=1,n=0,s=0,h=0,c=0){return new Y(r,t,e,i,n,s,h,c)}a(ae,"createColorTransform");var X=class{fieldOfView=55;projectionCenter=new y(0,0);focalLength=0;constructor(t){t&&(this.projectionCenter=new y(t.width/2,t.height/2),this.fieldOfView=55,this.focalLength=t.width/2/Math.tan(this.fieldOfView/2))}toMatrix3D(){return new C}clone(){let t=new X;return t.fieldOfView=this.fieldOfView,t.projectionCenter=this.projectionCenter,t.focalLength=this.focalLength,t}};a(X,"PerspectiveProjection");var L=class{constructor(t){this.parent=t}_matrix=new I;_matrix3d;_perspectiveProjection;_colorTransform;set perspectiveProjection(t){this._perspectiveProjection=t}get perspectiveProjection(){return typeof this._perspectiveProjection>"u"&&(this._perspectiveProjection=new X(this.parent)),this._perspectiveProjection}set colorTransform(t){this._colorTransform=t}get colorTransform(){return typeof this._colorTransform>"u"&&(this._colorTransform=new Y),this._colorTransform}set matrix3D(t){if(t===null){if(this._matrix3d===null)return;this._matrix3d=null,this._matrix=new I}else this._matrix=null,this._matrix3d=t;this.update()}set matrix(t){if(t===null){if(this._matrix===null)return;this._matrix=null,this._matrix3d=new C}else this._matrix3d=null,this._matrix=t;this.update()}get matrix3D(){return this._matrix3d}get matrix(){return this._matrix}box3d(t=1,e=1,i=1,n=0,s=0,h=0,c=0,d=0,p=0){(this._matrix||!this._matrix3d)&&(this._matrix=void 0,this._matrix3d=new C),this._matrix3d.identity(),this._matrix3d.appendRotation(n,O.X_AXIS),this._matrix3d.appendRotation(s,O.Y_AXIS),this._matrix3d.appendRotation(h,O.Z_AXIS),this._matrix3d.appendScale(t,e,i),this._matrix3d.appendTranslation(c,d,p)}box(t=1,e=1,i=0,n=0,s=0){this._matrix?this._matrix.createBox(t,e,i,n,s):this.box3d(t,e,1,0,0,i,n,s,0)}update(){this.parent&&(this.parent.transform=this)}getRelativeMatrix3D(t){return u("Transform.getRelativeMatrix3D not implemented","warn"),new C}getMatrix(){return this._matrix?this._matrix:this._matrix3d}getMatrixType(){return this._matrix?"2d":"3d"}clone(){let t=new L;return t._matrix=this._matrix,t._matrix3d=this._matrix3d,t}serialize(){return{mode:this.getMatrixType(),matrix:this.getMatrix()?.serialize()}}};a(L,"Transform");var At=(_=>(_.ADD="add",_.ALPHA="alpha",_.DARKEN="darken",_.DIFFERENCE="difference",_.ERASE="erase",_.HARDLIGHT="hardlight",_.INVERT="invert",_.LAYER="layer",_.LIGHTEN="lighten",_.MULTIPLY="multiply",_.NORMAL="normal",_.OVERLAY="overlay",_.SCREEN="screen",_.SHADER="shader",_.SUBTRACT="subtract",_))(At||{}),w=class{constructor(t=0,e=0,i=0,n=0){this.x=t;this.y=e;this.width=i;this.height=n}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}get size(){return xt(this.width,this.height)}contains(t,e){return t>=this.left&&e>=this.top&&t<=this.right&&e<=this.bottom}containsPoint(t){return this.contains(t.x,t.y)}containsRect(t){return this.contains(t.left,t.top)&&this.contains(t.right,t.bottom)}copyFrom(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}equals(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}inflate(t=0,e=0){this.x-=t,this.width+=2*t,this.y-=e,this.height+=2*e}inflatePoint(t){this.inflate(t.x,t.y)}isEmpty(){return this.width<=0||this.height<=0}setTo(t=0,e=0,i=0,n=0){this.x=t,this.y=e,this.width=i,this.height=n}offset(t=0,e=0){this.x+=t,this.y+=e}offsetPoint(t){this.offset(t.x,t.y)}setEmpty(){this.setTo(0,0,0,0)}unionCoord(t,e){let i=t-this.x,n=e-this.y;i>=0?this.width=Math.max(this.width,i):(this.x+=i,this.width-=i),n>=0?this.height=Math.max(this.height,n):(this.y+=n,this.height-=n)}unionPoint(t){this.unionCoord(t.x,t.y)}union(t){let e=this.clone();return e.unionCoord(t.left,t.top),e.unionCoord(t.right,t.bottom),e}toString(){return"(x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+")"}clone(){return new w(this.x,this.y,this.width,this.height)}serialize(){return{x:this.x,y:this.y,width:this.width,height:this.height}}};a(w,"Rectangle");var yt=class{constructor(t=m.generateId(),e=!0){this.id=t;this._visible=e}_alpha=1;_anchor=new y;_boundingBox=new w;_z=0;_scaleX=1;_scaleY=1;_scaleZ=1;_rotationX=0;_rotationY=0;_rotationZ=0;_filters=[];_blendMode="normal";_listeners={};_parent;_name="";_children=[];_transform=new L(this);_hasSetDefaults=!1;setDefaults(t={}){if(this._hasSetDefaults){u("DisplayObject.setDefaults called more than once.","warn");return}this._hasSetDefaults=!0;try{if(t.hasOwnProperty("motion")){let e=t.motion;e.hasOwnProperty("alpha")&&(this._alpha=e.alpha.fromValue),e.hasOwnProperty("x")&&(this._anchor.x=e.x.fromValue),e.hasOwnProperty("y")&&(this._anchor.y=e.y.fromValue)}else if(t.hasOwnProperty("motionGroup")&&t.motionGroup&&t.motionGroup.length>0){let e=t.motionGroup[0];e.hasOwnProperty("alpha")&&(this._alpha=e.alpha.fromValue),e.hasOwnProperty("x")&&(this._anchor.x=e.x.fromValue),e.hasOwnProperty("y")&&(this._anchor.y=e.y.fromValue)}}catch{}t.hasOwnProperty("alpha")&&(this._alpha=t.alpha),t.hasOwnProperty("x")&&(this._anchor.x=t.x),t.hasOwnProperty("y")&&(this._anchor.y=t.y)}eventToggle(t,e="enable"){yt.SANDBOX_EVENTS.indexOf(t)>-1||g("Runtime:ManageEvent",{id:this.id,name:t,mode:e})}propertyUpdate(t,e){g("Runtime:UpdateProperty",{id:this.id,name:t,value:e})}methodCall(t,e){g("Runtime:CallMethod",{id:this.id,method:t,params:e})}set alpha(t){this._alpha=t,this.propertyUpdate("alpha",t)}get alpha(){return this._alpha}set anchor(t){this._anchor=t,this.propertyUpdate("x",t.x),this.propertyUpdate("y",t.y)}get anchor(){return this._anchor}set boundingBox(t){this._boundingBox=t,this.propertyUpdate("boundingBox",t.serialize())}get boundingBox(){return this._boundingBox}set cacheAsBitmap(t){u("DisplayObject.cacheAsBitmap is not supported","warn")}get cacheAsBitmap(){return!1}set filters(t){this._filters=t||[];let e=[];for(let i=0;i<this._filters.length;i++)this.filters[i]&&e.push(this._filters[i].serialize());this.propertyUpdate("filters",e)}get filters(){return this._filters}get root(){return l.root}set root(t){u("DisplayObject.root is read-only.","warn")}get stage(){return l.root}set stage(t){u("DisplayObject.stage is read-only.","warn")}_updateBox(t=this._transform.getMatrixType()){t==="3d"?this._transform.box3d(this._scaleX,this._scaleY,this._scaleZ,this._rotationX,this._rotationY,this._rotationZ,0,0,this._z):this._transform.box(this._scaleX,this._scaleY,this._rotationZ*Math.PI/180),this.transform=this._transform}set rotationX(t){this._rotationX=t,this._updateBox("3d")}set rotationY(t){this._rotationY=t,this._updateBox("3d")}set rotationZ(t){this._rotationZ=t,this._updateBox()}set rotation(t){this._rotationZ=t,this._updateBox()}set scaleX(t){this._scaleX=t,this._updateBox()}set scaleY(t){this._scaleY=t,this._updateBox()}set scaleZ(t){this._scaleZ=t,this._updateBox("3d")}set x(t){this._anchor.x=t,this.propertyUpdate("x",t)}set y(t){this._anchor.y=t,this.propertyUpdate("y",t)}set z(t){this._z=t,this._updateBox("3d")}get rotationX(){return this._rotationX}get rotationY(){return this._rotationY}get rotationZ(){return this._rotationZ}get rotation(){return this._rotationZ}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get scaleZ(){return this._scaleZ}get x(){return this._anchor.x}get y(){return this._anchor.y}get z(){return this._z}set width(t){this._boundingBox.width=t,this.propertyUpdate("width",t)}get width(){return this._boundingBox.width}set height(t){this._boundingBox.height=t,this.propertyUpdate("height",t)}get height(){return this._boundingBox.height}set visible(t){this._visible=t,this.propertyUpdate("visible",t)}get visible(){return this._visible}set blendMode(t){this._blendMode=t,this.propertyUpdate("blendMode",t)}get blendMode(){return this._blendMode}set transform(t){this._transform=t,this._transform.parent!==this&&(this._transform.parent=this),this.propertyUpdate("transform",this._transform.serialize())}get transform(){return this._transform}set name(t){this._name=t,this.propertyUpdate("name",t)}get name(){return this._name}set loaderInfo(t){u("DisplayObject.loaderInfo is read-only","warn")}get loaderInfo(){return u("DisplayObject.loaderInfo is not supported","warn"),{}}set parent(t){u("DisplayObject.parent is read-only","warn")}get parent(){return this._parent??l.root}get video(){return f}dispatchEvent(t,e){if(this._listeners.hasOwnProperty(t)&&this._listeners[t])for(let i=0;i<this._listeners[t].length;i++)try{this._listeners[t][i](e)}catch(n){n.hasOwnProperty("stack")?u(n.stack?.toString(),"err"):u(n.toString(),"err")}}addEventListener(t,e){this._listeners.hasOwnProperty(t)||(this._listeners[t]=[]),this._listeners[t].push(e),this._listeners[t].length===1&&this.eventToggle(t,"enable")}removeEventListener(t,e){if(!this._listeners.hasOwnProperty(t)||this._listeners[t].length===0)return;let i=this._listeners[t].indexOf(e);i>=0&&this._listeners[t].splice(i,1),this._listeners[t].length===0&&this.eventToggle(t,"disable")}get numChildren(){return this._children.length}addChild(t){if(typeof t>"u"||t===null)throw new Error("Cannot add an empty child!");if(t.contains(this))throw new Error("Attempting to add an ancestor of this DisplayObject as a child!");this._children.push(t),this._boundingBox.unionCoord(t._anchor.x+t._boundingBox.left,t._anchor.y+t._boundingBox.top),this._boundingBox.unionCoord(t._anchor.x+t._boundingBox.right,t._anchor.y+t._boundingBox.bottom),t._parent=this,this.methodCall("addChild",t.id)}removeChild(t){let e=this._children.indexOf(t);e>=0&&this.removeChildAt(e)}getChildAt(t){if(t<0||t>this._children.length)throw new RangeError("No child at index "+t);return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}removeChildAt(t){let e=this.getChildAt(t);this._children.splice(t,1),e._parent=null,this.methodCall("removeChild",e.id)}removeChildren(t,e=this._children.length){let i=this._children.splice(t,e-t),n=[];for(let s=0;s<i.length;s++)i[s]._parent=null,n.push(i[s].id);this.methodCall("removeChildren",n)}contains(t){if(t===this||this._children.indexOf(t)>=0)return!0;for(let e=0;e<this._children.length;e++)if(this._children[e].contains(t))return!0;return!1}remove(){this._parent?this._parent.removeChild(this):this.root.removeChild(this)}toString(){return"["+(this._name.length>0?this._name:"displayObject")+" DisplayObject]@"+this.id}clone(){let t=new yt;return t._transform=this._transform.clone(),t._transform.parent=t,t._boundingBox=this._boundingBox.clone(),t._anchor=this._anchor.clone(),t._alpha=this._alpha,t}hasOwnProperty(t){return t==="clone"?!0:Object.prototype.hasOwnProperty.call(this,t)}serialize(){this._hasSetDefaults=!0;let t=[];for(let e=0;e<this._filters.length;e++)t.push(this._filters[e].serialize());return{class:"DisplayObject",x:this._anchor.x,y:this._anchor.y,alpha:this._alpha,filters:t}}unload(){this._visible=!1,this.remove(),this.methodCall("unload",null)}getId(){return this.id}getRect(){return{x:this.x,y:this.y,width:this.width,height:this.height,left:0,right:0,top:0,buttom:0}}},P=yt;a(P,"DisplayObject"),o(P,"SANDBOX_EVENTS",["enterFrame"]);var wt=class{xBegin;yBegin;xEnd;yEnd;expand(t,e){this.xBegin=this.xBegin===null?t:Math.min(this.xBegin,t),this.xEnd=this.xEnd===null?t:Math.max(this.xEnd,t),this.yBegin=this.yBegin===null?e:Math.min(this.yBegin,e),this.yEnd=this.xEnd===null?e:Math.max(this.yEnd,e)}asRect(){return this.isEmpty()?new w(0,0,0,0):new w(this.xBegin??0,this.yBegin??0,this.xEnd-this.xBegin,this.yEnd-this.yBegin)}isEmpty(){return this.xBegin??this.yBegin??this.xEnd??this.yEnd??!0}reset(){delete this.xBegin,delete this.xEnd,delete this.yBegin,delete this.yEnd}};a(wt,"DirtyArea");var Q=class extends P{constructor(e){super(m.generateId("obj-bmp"));this.bitmapData=e}get width(){return this.bitmapData?this.bitmapData.width*this.scaleX:0}get height(){return this.bitmapData?this.bitmapData.height*this.scaleY:0}set width(e){this.bitmapData&&this.bitmapData.width>0&&(this.scaleX=e/this.bitmapData.width)}set height(e){this.bitmapData&&this.bitmapData.height>0&&(this.scaleY=e/this.bitmapData.height)}getBitmapData(){return this.bitmapData}setBitmapData(e){typeof e<"u"&&(this.bitmapData=e,this.methodCall("setBitmapData",e.getId()))}serialize(){let e=super.serialize();return e.class="Bitmap",this.bitmapData!==null&&(e.bitmapData=this.bitmapData?.getId()),e}};a(Q,"Bitmap");var H=class{constructor(t,e,i=!0,n=4294967295,s=m.generateId("obj-bmp-data")){this.transparent=i;this.fillColor=n;this.id=s;this.rect=new w(0,0,t,e),this._fill(),m.registerObject(this)}rect;locked=!1;dirtyArea=new wt;byteArray=[];_fill(){this.byteArray=[];for(let t=0;t<this.rect.width*this.rect.height;t++)this.byteArray.push(this.fillColor)}_updateBox(t){if(this.dirtyArea.isEmpty()||this.locked)return;let e=t??this.dirtyArea.asRect();if(!this.rect.containsRect(e))throw u("BitmapData._updateBox box "+e.toString()+" out of bonunds "+this.rect.toString(),"err"),new Error("Rectangle provided was not within image bounds.");let i=[];for(let n=0;n<e.height;n++)for(let s=0;s<e.width;s++)i.push(this.byteArray[(e.y+n)*this.rect.width+e.x+s]);this._methodCall("updateBox",{box:e.serialize(),values:i}),this.dirtyArea.reset()}_methodCall(t,e){g("Runtime:CallMethod",{id:this.id,method:t,params:e})}get height(){return this.rect.height}get width(){return this.rect.width}set height(t){u("BitmapData.height is read-only","warn")}set width(t){u("BitmapData.height is read-only","warn")}draw(t,e,i,n,s,h=!1){if(!(t instanceof H)){u("Drawing non BitmapData is not supported!","err");return}e&&u("Matrix transforms not supported yet.","warn"),i&&u("Color transforms not supported yet.","warn"),n&&n!=="normal"&&u("Blend mode ["+n+"] not supported yet.","warn"),h!==!1&&u("Smoothign not supported!","warn"),this.lock(),s&&(s=new w(0,0,t.width,t.height)),this.setPixels(s,t.getPixels(s)),this.unlock()}getPixel(t,e){return this.getPixel32(t,e)&16777215}getPixel32(t,e){if(t>=this.rect.width||e>=this.rect.height||t<0||e<0)throw new Error("Coordinates out of bounds");try{return this.transparent?this.byteArray[e*this.rect.width+t]:(this.byteArray[e*this.rect.width+t]&16777215)+4278190080}catch{return this.fillColor}}getPixels(t){if(typeof t>"u"||t===null)throw new Error("Expected a region to acquire pixels.");if(t.width===0||t.height===0)return new S;let e=new S;for(let i=0;i<t.height;i++)this.byteArray.slice((t.y+i)*this.rect.width+t.x,(t.y+i)*this.rect.width+t.x+t.width).forEach(function(n){e.push(n)});return e}setPixel(t,e,i){this.setPixel32(t,e,(i&16777215)+4278190080)}setPixel32(t,e,i){this.transparent||(i=(i&16777215)+4278190080),this.byteArray[e*this.rect.width+t]=i,this.dirtyArea.expand(t,e),this._updateBox()}setPixels(t,e){if(!(t.width===0||t.height===0)){if(e.length!==t.width*t.height)throw new Error("setPixels expected "+t.width*t.height+" pixels, but actually got "+e.length);this.transparent||(e=e.map(function(i){return(i&16777215)+4278190080}));for(let i=0;i<t.width;i++)for(let n=0;n<t.height;n++)this.byteArray[(t.y+n)*this.width+(t.x+i)]=e[n*t.width+i],this.dirtyArea.expand(i,n);this._updateBox()}}getVector(t){if(this.rect.equals(t))return this.byteArray;let e=[];for(let i=t.y;i<t.y+t.height;i++)for(let n=t.x;n<t.x+t.width;n++)e.push(t[i*this.rect.width+n]);return e}lock(){this.locked=!0}unlock(t){this.locked=!1,t?this._updateBox(t):this._updateBox()}dispatchEvent(t,e){}getId(){return this.id}serialize(){return{class:"BitmapData",width:this.rect.width,height:this.rect.height,fill:this.fillColor}}unload(){this._methodCall("unload",void 0)}clone(){let t=new H(this.width,this.height,this.transparent,this.fillColor);return t.byteArray=this.byteArray.slice(0),t._updateBox(t.rect),t}};a(H,"BitmapData");function Mt(r,t,e,i){return r*e/i+t}a(Mt,"linear");function Dt(r,t,e,i){return r/=i/2,r<1?e/2*r*r+t:(r--,-e/2*(r*(r-2)-1)+t)}a(Dt,"quadratic");function Tt(r,t,e,i){return r/=i/2,r<1?e/2*r*r*r+t:(r-=2,e/2*(r*r*r+2)+t)}a(Tt,"cubic");function Rt(r,t,e,i){return r/=i/2,r<1?e/2*r*r*r*r+t:(r-=2,-e/2*(r*r*r*r-2)+t)}a(Rt,"quartic");function vt(r,t,e,i){return r/=i/2,r<1?e/2*r*r*r*r*r+t:(r-=2,e/2*(r*r*r*r*r+2)+t)}a(vt,"quintic");function Ot(r,t,e,i){return r/=i/2,r<1?-e/2*(Math.sqrt(1-r*r)-1)+t:(r-=2,e/2*(Math.sqrt(1-r*r)+1)+t)}a(Ot,"circular");function lt(r,t,e,i){return-e/2*(Math.cos(Math.PI*r/i)-1)+t}a(lt,"sine");function Pt(r,t,e,i){return r/=i/2,r<1?e/2*Math.pow(2,10*(r-1))+t:(r--,e/2*(-Math.pow(2,-10*r)+2)+t)}a(Pt,"exponential");function zt(r){let t={linear:Mt,back:null,bounce:null,circular:Ot,cubic:Tt,elastic:null,exponential:Pt,sine:lt,quintic:vt};for(let e in t)r[e]=t[e]}a(zt,"extendWithEasingFunctions");function oe(r="None"){switch(r=r.toLowerCase(),r){case"none":case"linear":default:return Mt;case"exponential":return Pt;case"circular":return Ot;case"quadratic":return Dt;case"cubic":return Tt;case"quartic":return Rt;case"quintic":return vt;case"sine":return lt}}a(oe,"getEasingFuncByName");var k={Linear:{None:function(r){return r}},Quadratic:{In:function(r){return r*r},Out:function(r){return r*(2-r)},InOut:function(r){return(r*=2)<1?.5*r*r:-.5*(--r*(r-2)-1)}},Cubic:{In:function(r){return r*r*r},Out:function(r){return--r*r*r+1},InOut:function(r){return(r*=2)<1?.5*r*r*r:.5*((r-=2)*r*r+2)}},Quartic:{In:function(r){return r*r*r*r},Out:function(r){return 1- --r*r*r*r},InOut:function(r){return(r*=2)<1?.5*r*r*r*r:-.5*((r-=2)*r*r*r-2)}},Quintic:{In:function(r){return r*r*r*r*r},Out:function(r){return--r*r*r*r*r+1},InOut:function(r){return(r*=2)<1?.5*r*r*r*r*r:.5*((r-=2)*r*r*r*r+2)}},Sinusoidal:{In:function(r){return 1-Math.sin((1-r)*Math.PI/2)},Out:function(r){return Math.sin(r*Math.PI/2)},InOut:function(r){return .5*(1-Math.sin(Math.PI*(.5-r)))}},Exponential:{In:function(r){return r===0?0:Math.pow(1024,r-1)},Out:function(r){return r===1?1:1-Math.pow(2,-10*r)},InOut:function(r){return r===0?0:r===1?1:(r*=2)<1?.5*Math.pow(1024,r-1):.5*(-Math.pow(2,-10*(r-1))+2)}},Circular:{In:function(r){return 1-Math.sqrt(1-r*r)},Out:function(r){return Math.sqrt(1- --r*r)},InOut:function(r){return(r*=2)<1?-.5*(Math.sqrt(1-r*r)-1):.5*(Math.sqrt(1-(r-=2)*r)+1)}},Elastic:{In:function(r){return r===0?0:r===1?1:-Math.pow(2,10*(r-1))*Math.sin((r-1.1)*5*Math.PI)},Out:function(r){return r===0?0:r===1?1:Math.pow(2,-10*r)*Math.sin((r-.1)*5*Math.PI)+1},InOut:function(r){return r===0?0:r===1?1:(r*=2,r<1?-.5*Math.pow(2,10*(r-1))*Math.sin((r-1.1)*5*Math.PI):.5*Math.pow(2,-10*(r-1))*Math.sin((r-1.1)*5*Math.PI)+1)}},Back:{In:function(r){return r===1?1:r*r*((1.70158+1)*r-1.70158)},Out:function(r){return r===0?0:--r*r*((1.70158+1)*r+1.70158)+1},InOut:function(r){let t=2.5949095;return(r*=2)<1?.5*(r*r*((t+1)*r-t)):.5*((r-=2)*r*((t+1)*r+t)+2)}},Bounce:{In:function(r){return 1-k.Bounce.Out(1-r)},Out:function(r){return r<1/2.75?7.5625*r*r:r<2/2.75?7.5625*(r-=1.5/2.75)*r+.75:r<2.5/2.75?7.5625*(r-=2.25/2.75)*r+.9375:7.5625*(r-=2.625/2.75)*r+.984375},InOut:function(r){return r<.5?k.Bounce.In(r*2)*.5:k.Bounce.Out(r*2-1)*.5+.5}},generatePow:function(r=4){return r=r<Number.EPSILON?Number.EPSILON:r,r=r>1e4?1e4:r,{In:function(t){return t**r},Out:function(t){return 1-(1-t)**r},InOut:function(t){return t<.5?(t*2)**r/2:(1-(2-t*2)**r)/2+.5}}}};Object.entries(k).forEach(r=>{Reflect.set(self,...r)});Reflect.set(self,"Circ",k.Circular);Reflect.set(self,"Expo",k.Exponential);Reflect.set(self,"Quad",k.Quadratic);Reflect.set(self,"Quart",k.Quartic);Reflect.set(self,"Quint",k.Quintic);Reflect.set(self,"SIne",lt);var M=class{constructor(t,e=0){this.target=t;this.duration=e;this.timer.addEventListener("timer",()=>{this._onTimerEvent()})}isPlaying=!1;position=0;repeats=0;timeKeeper=new B;timer=new F(40);easing=b.linear;step=()=>{};lastSeek;_onTimerEvent(){this.isPlaying&&(this.position+=this.timeKeeper.elapsed,this.timeKeeper.reset(),this.step(this.target,this.position,this.duration),this.position>=this.duration&&(this.repeats--,this.repeats<0?(this.stop(),this.position=this.duration):this.position=0,this.step(this.target,this.position,this.duration)))}clone(){let t=new M(this.target,this.duration);return t.easing=this.easing,t.step=this.step,t}scale(t){this.position*=t,this.duration*=t}play(){this.isPlaying||this.gotoAndPlay(this.position)}stop(){this.isPlaying&&this.gotoAndStop(this.position)}gotoAndStop(t){this.position=t,this.isPlaying&&(this.isPlaying=!1,this.timer.stop()),this.step(this.target,this.position,this.duration)}gotoAndPlay(t){this.position=t,this.isPlaying||(this.isPlaying=!0,this.timer.start()),this.step(this.target,this.position,this.duration)}togglePause(){this.isPlaying?this.stop():this.play()}addEventListener(t,e){if(t==="complete")return this.timer.addEventListener("timerComplete",e),!0}dispatchEvent(t){return this.timer.dispatchEvent(t),!0}hasEventListener(t){return!0}removeEventListener(t,e){return!0}};a(M,"ITween");function Se(r,t,e,i){for(let n in t)e.hasOwnProperty(n)||(e[n]=r[n]);for(let n in e)t.hasOwnProperty(n)||(t[n]=e[n]);return function(n,s,h){for(let c in e)e.hasOwnProperty(c)&&(n[c]=i.easing(s,e[c],t[c]-e[c],h))}}a(Se,"createStepFunction");var Vt=class{static tween(t,e={},i={},n=0,s){let h=new M(t,n*1e3);return h.step=Se(t,e,i,h),s&&(h.easing=s),h}static to(t,e={},i=0,n){let s={};for(let h in e)e.hasOwnProperty(h)&&(typeof t[h]<"u"?s[h]=t[h]:s[h]=0);return Vt.tween(t,e,s,i,n)}static bezier(t,e,i,n,s=1,h){let c=new M(t,s*1e3);h&&typeof h=="function"&&(c.easing=h);let d={};for(let p in n)Array.isArray(n[p])&&n[p].length>0&&(d[p]=n[p]);(typeof i>"u"||i===null)&&(i={}),(typeof e>"u"||e===null)&&(e={});for(let p in d)p in i||(i[p]=c.target[p]),p in e||(e[p]=d[p][d[p].length-1]);return c.step=function(p,v,rt){let W=Math.min(c.easing(v,0,1,rt),1);for(let j in d){let E=d[j],_=E.length,A=Math.floor(W*_),dt=(W-A/_)*_;if(_===1)p[j]=i[j]+2*W*(1-W)*(E[0]-i[j])+W*W*(e[j]-i[j]);else{let it=0,ft=0;A===0?(it=i[j],ft=(E[0]+E[1])/2):A===_-1?(it=(E[A-1]+E[A])/2,ft=e[j]):(it=(E[A-1]+E[A])/2,ft=(E[A]+E[A+1])/2),p[j]=it+2*dt*(1-dt)*(E[A]-it)+dt*dt*(ft-it)}}},c}static scale(t,e){let i=t.clone();return i.scale(e),i}static delay(t,e){let i=new M(t.target,t.duration+e*1e3);return i.step=function(n,s,h){s<=e*1e3||t.step(n,s-e*1e3,h-e*1e3)},i}static reverse(t){let e=new M(t.target,t.duration);return e.step=function(i,n,s){t.step(i,s-n,s)},e}static repeat(t,e){let i=new M(t.target,t.duration*e);return i.step=function(n,s,h){t.step(n,s%t.duration,t.duration)},i}static slice(t,e,i){i===null&&(i=t.duration),i<e&&(i=e),e*=1e3,i*=1e3;let n=new M(t.target,i-e);return n.step=function(s,h,c){t.step(s,e+h,t.duration)},n}static serial(...t){if(t.length===0)return new M({},0);let e=0,i=[],n=[];for(let h=0;h<t.length;h++)n.push(e),e+=t[h].duration,i.push(e);let s=new M({},e);return s.lastSeek=0,s.step=function(h,c,d){if(c<=i[s.lastSeek]){let p=t[s.lastSeek];p.step(p.target,c-n[s.lastSeek],p.duration);return}else{let p=t[s.lastSeek];p.step(p.target,p.duration,p.duration)}for(let p=0;p<i.length;p++)if(c<i[p]){s.lastSeek=p;let v=t[s.lastSeek];v.step(v.target,c-n[s.lastSeek],v.duration);return}},s}static parallel(...t){let e=0;for(let s=0;s<t.length;s++)e=Math.max(t[s].duration,e);let i=t,n=new M({},e);return n.step=function(s,h,c){for(let d=0;d<i.length;d++)i[d].step(i[d].target,Math.min(h,i[d].duration),i[d].duration)},n}},b=Vt;a(b,"Tween"),o(b,"linear",Mt),o(b,"quadratic",Dt),o(b,"cubic",Tt),o(b,"quartic",Rt),o(b,"quintic",vt),o(b,"circular",Ot),o(b,"sine",lt),o(b,"exponential",Pt),o(b,"extendWithEasingFunctions",zt),o(b,"getEasingFuncByName",oe),o(b,"ITween",M);zt(self);var T=class{_isRunning=!1;_ttl;_dur;_parent;_timer;_timeKeeper;_independentTimer;_tween;oncomplete;constructor(t,e=1e3,i=!1){if(typeof t>"u"||t===null)throw new Error("MotionManager must be bound to a DisplayObject.");this._ttl=e,this._dur=e,this._parent=t,this._independentTimer=i,this._timeKeeper=new B;let n=this;this._independentTimer?(this._timer=new F(41,0),this._timer.addEventListener("timer",()=>{n._onTimerEvent()}),this._timer.start()):this._parent.addEventListener("enterFrame",()=>{n._onTimerEvent()})}set dur(t){this._timeKeeper.reset(),this._ttl=t,this._dur=t}get dur(){return this._dur}get running(){return this._isRunning}_onTimerEvent(){this._isRunning&&this._dur!==0&&(this._ttl-=this._timeKeeper.elapsed,this._timeKeeper.reset(),this._ttl<=0&&(this.stop(),typeof this.oncomplete=="function"&&this.oncomplete(),this._parent.unload()))}reset(){this._ttl=this._dur,this._timeKeeper.reset()}play(){this._isRunning||this._dur===0||this._ttl<=0||(this._isRunning=!0,this._timeKeeper.reset(),this._tween&&this._tween.play())}stop(){this._isRunning&&(this._isRunning=!1,this._timeKeeper.reset(),this._tween&&this._tween.stop())}forecasting(t){return u("MotionManager.forecasting always returns false","warn"),!1}setPlayTime(t){this._ttl=this._dur-t,this._tween&&(this._isRunning?this._tween.gotoAndPlay(t):this._tween.gotoAndStop(t))}motionSetToTween(t){let e=[];for(let i in t){if(!t.hasOwnProperty(i))continue;let n=t[i];if(!n.hasOwnProperty("fromValue"))continue;n.hasOwnProperty("toValue")||(n.toValue=n.fromValue),n.hasOwnProperty("lifeTime")||(n.lifeTime=this._dur);let s={},h={};s[i]=n.fromValue,h[i]=n.toValue,typeof n.easing=="string"&&(n.easing=b.getEasingFuncByName(n.easing)),n.hasOwnProperty("startDelay")?e.push(b.delay(b.tween(this._parent,h,s,n.lifeTime,n.easing),n.startDelay/1e3)):e.push(b.tween(this._parent,h,s,n.lifeTime,n.easing))}return b.parallel.apply(b,e)}initTween(t,e){this._tween=this.motionSetToTween(t)}initTweenGroup(t,e){let i=[];for(let n=0;n<t.length;n++)i.push(this.motionSetToTween(t[n]));this._tween=b.serial.apply(b,i)}setCompleteListener(t){this.oncomplete=t}};a(T,"MotionManager");var J=class extends Q{_mM=new T(this);constructor(t){super("bitmapData"in t?t.bitmapData:void 0),this.initStyle(t),m.registerObject(this),this.bindParent(t),this._mM.play()}get motionManager(){return this._mM}set motionManager(t){u("IComment.motionManager is read-only","warn")}bindParent(t){"parent"in t&&t.parent?.addChild(this)}initStyle(t){(typeof t>"u"||t===null)&&(t={}),"lifeTime"in t&&(this._mM.dur=t.lifeTime*1e3)}static createBitmap(t){return Lt(t)}static createParticle(t){return Ut(t)}static createBitmapData(t,e,i,n){return i===void 0&&(i=!0),n===void 0&&(n=4294967295),Gt(t,e,i,n)}static createRectangle(t,e,i,n){return new w(t,e,i,n)}};a(J,"CommentBitmap");function Lt(r){return new J(r)}a(Lt,"createBitmap");function Ut(r){return u("Bitmap.createParticle not implemented","warn"),new J(r)}a(Ut,"createParticle");function Gt(r,t,e=!0,i=4294967295){return new l.BitmapData(r,t,e,i)}a(Gt,"createBitmapData");var U=class{constructor(t){this.parent=t}lineWidth=1;_evaluateBoundingBox(t,e){this.parent.boundingBox.unionCoord(t+this.lineWidth/2,e+this.lineWidth/2)}_callDrawMethod(t,e){g("Runtime:CallMethod",{id:this.parent.getId(),context:"graphics",method:t,params:e})}lineTo(t,e){this._evaluateBoundingBox(t,e),this._callDrawMethod("lineTo",[t,e])}moveTo(t,e){this._evaluateBoundingBox(t,e),this._callDrawMethod("moveTo",[t,e])}curveTo(t,e,i,n){this._evaluateBoundingBox(i,n),this._evaluateBoundingBox(t,e),this._callDrawMethod("curveTo",[t,e,i,n])}cubicCurveTo(t,e,i,n,s,h){this._evaluateBoundingBox(t,e),this._evaluateBoundingBox(i,n),this._evaluateBoundingBox(s,h),this._callDrawMethod("cubicCurveTo",[t,e,i,n,s,h])}lineStyle(t,e=0,i=1,n=!1,s="normal",h="none",c="round",d=3){this.lineWidth=t,this._callDrawMethod("lineStyle",[t,e,i,h,c,d])}drawRect(t,e,i,n){this._evaluateBoundingBox(t,e),this._evaluateBoundingBox(t+i,e+n),this._callDrawMethod("drawRect",[t,e,i,n])}drawCircle(t,e,i){this._evaluateBoundingBox(t-i,e-i),this._evaluateBoundingBox(t+i,e+i),this._callDrawMethod("drawCircle",[t,e,i])}drawEllipse(t,e,i,n){this._evaluateBoundingBox(t-i/2,e-n/2),this._evaluateBoundingBox(t+i/2,e+n/2),this._callDrawMethod("drawEllipse",[t+i/2,e+n/2,i/2,n/2])}drawRoundRect(t,e,i,n,s,h){this._evaluateBoundingBox(t,e),this._evaluateBoundingBox(t+i,e+n),this._callDrawMethod("drawRoundRect",[t,e,i,n,s,h])}drawPath(t,e,i="evenOdd"){this._callDrawMethod("drawPath",[t,e,i])}beginFill(t,e=1){this._callDrawMethod("beginFill",[t,e])}beginGradientFill(t,e,i,n,s,h="pad",c="rgb",d=0){if(u("Graphics.beginGradientFill still needs work.","warn"),t!=="linear"&&t!=="radial"){u("Graphics.beginGradientFill unsupported fill type : "+t,"warn");return}this._callDrawMethod("beginGradientFill",[t,e,i,n,s?s.serialize:null,h,c,d])}beginShaderFill(t,e){u("Graphics.beginShaderFill not supported.","warn")}endFill(){this._callDrawMethod("endFill",[])}drawTriangles(t,e,i,n="none"){if(e)e=e.slice(0);else{e=[];for(let s=0;s<t.length;s+=2)e.push(s/2)}if(e.length%3!==0){u("Graphics.drawTriangles malformed indices count. Must be multiple of 3.","err");return}if(n!=="none")for(let s=0;s<e.length/3;s++){let h=t[2*e[s*3+1]]-t[2*e[s*3]],c=t[2*e[s*3+1]+1]-t[2*e[s*3]+1],d=t[2*e[s*3+2]]-t[2*e[s*3+1]],p=t[2*e[s*3+2]+1]-t[2*e[s*3+1]+1],v=h*p-d*c;(v<0&&n==="positive"||v>0&&n==="negative")&&(e.splice(s*3,3),s--)}for(let s=0;s<e.length;s++)this._evaluateBoundingBox(t[2*e[s]],t[2*e[s]+1]);this._callDrawMethod("drawTriangles",[t,e,n])}clear(){this.parent.boundingBox.setEmpty(),this._callDrawMethod("clear",[])}};a(U,"Graphics");var G=class extends P{_graphics;_mouseEnabled=!0;_mousePosition=new y(0,0);_useHandCursor=!1;constructor(t){super(t),this._graphics=new U(this)}get graphics(){return this._graphics}set graphics(t){u("Sprite.graphics is read-only.","warn")}get mouseEnabled(){return this._mouseEnabled}set mouseEnabled(t){this._mouseEnabled=t,this.propertyUpdate("mouseEnabled",t)}get useHandCursor(){return this._useHandCursor}set useHandCursor(t){this._useHandCursor=t,this.propertyUpdate("useHandCursor",t)}serialize(){let t=super.serialize();return t.class="Sprite",t}};a(G,"Sprite");var at=class extends G{_metaRoot;constructor(){super("__root"),this._metaRoot=m.getObject("__root")}get parent(){return u("SecurityError: No access above root sprite.","err"),null}addEventListener(t,e){u("Listener["+t+"] on root sprite inadvisible","warn"),this._metaRoot.addEventListener(t,e)}removeEventListener(t,e){this._metaRoot.removeEventListener(t,e,!1)}};a(at,"RootSprite");var \$=class extends G{_styles={};constructor(t){super(t)}clearStyle(t){delete this._styles[t]}getStyle(t){return this._styles[t]}setStyle(t,e){u("UIComponent.setStyle not implemented","warn"),this._styles[t]=e}setFocus(){this.methodCall("setFocus",null)}setSize(t,e){this.width=t,this.height=e}move(t,e){this.x=t,this.y=e}};a(\$,"UIComponent");var Ct=class extends \${mM=new T(this);label="";constructor(t){super(),this.setDefaults(t),this.initStyle(t),m.registerObject(this),this.bindParent(t),this.mM.play()}get motionManager(){return this.mM}set motionManager(t){u("IComment.motionManager is read-only","warn")}bindParent(t){t.hasOwnProperty("parent")&&t.parent?.addChild(this)}initStyle(t){(typeof t>"u"||t===null)&&(t={}),"lifeTime"in t?this.mM.dur=t.lifeTime*1e3:this.mM.dur=4e3,t.hasOwnProperty("text")&&(this.label=t.text),t.hasOwnProperty("motionGroup")?this.mM.initTweenGroup(t.motionGroup||[],this.mM.dur):t.hasOwnProperty("motion")&&this.mM.initTween(t.motion,!1)}serialize(){let t=super.serialize();return t.class="Button",t.text=this.label,t}};a(Ct,"CommentButton");function he(r){return new Ct(r)}a(he,"createButton");var It=class extends G{mM=new T(this);constructor(t){super(),this.setDefaults(t),this.initStyle(t),m.registerObject(this),this.bindParent(t),this.mM.play()}get motionManager(){return this.mM}set motionManager(t){u("IComment.motionManager is read-only","warn")}bindParent(t){t.hasOwnProperty("parent")&&t.parent?.addChild(this)}initStyle(t){t.lifeTime&&(this.mM.dur=t.lifeTime*1e3),t.hasOwnProperty("motionGroup")?this.mM.initTweenGroup(t.motionGroup||[],this.mM.dur):t.hasOwnProperty("motion")&&this.mM.initTween(t.motion,!1)}};a(It,"CommentCanvas");function ue(r){return new It(r)}a(ue,"createCanvas");var ct=class{constructor(t="SimHei",e=25,i=16777215,n=!1,s=!1,h=!1,c="",d="",p="left",v=0,rt=0,W=0,j=0){this.font=t;this.size=e;this.color=i;this.bold=n;this.italic=s;this.underline=h}align;fontsize;serialize(){return{class:"TextFormat",font:this.font,size:this.size,color:this.color,bold:this.bold,underline:this.underline,italic:this.italic}}};a(ct,"TextFormat");var tt=class extends P{constructor(e="",i=0){super(m.generateId("obj-textfield"));this._text=e;this._textFormat.color=i,this.boundingBox.width=this.textWidth,this.boundingBox.height=this.textHeight}_textFormat=new ct;_background=!1;_backgroundColor=16777215;_border=!1;_borderColor=0;get text(){return this._text}set text(e){this._text=e,this.boundingBox.width=this.textWidth,this.boundingBox.height=this.textHeight,this.propertyUpdate("text",this._text)}get length(){return this.text.length}set length(e){u("TextField.length is read-only.","warn")}get htmlText(){return this.text}set htmlText(e){u("TextField.htmlText is restricted due to security policy.","warn"),this.text=e.replace(/<\\/?[^>]+(>|\$)/g,"")}set textWidth(e){u("TextField.textWidth is read-only","warn")}set textHeight(e){u("TextField.textHeight is read-only","warn")}get textWidth(){return this._text.length*this._textFormat.size}get textHeight(){return this._textFormat.size}get color(){return this._textFormat.color}set color(e){this._textFormat.color=e,this.setTextFormat(this._textFormat)}get background(){return this._background}set background(e){this._background=e,this.propertyUpdate("background",e)}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){this._backgroundColor=e,this.propertyUpdate("backgroundColor",e)}get border(){return this._border}set border(e){this._border=e,this.propertyUpdate("border",e)}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e,this.propertyUpdate("borderColor",e)}getTextFormat(){return this._textFormat}setTextFormat(e){this._textFormat=e,this.methodCall("setTextFormat",e.serialize())}appendText(e){this.text=this.text+e}serialize(){let e=super.serialize();return e.class="TextField",e.text=this._text,e.textFormat=this._textFormat.serialize(),e}};a(tt,"TextField");function le(){return new ct}a(le,"createTextFormat");var mt=class extends tt{mM=new T(this);constructor(t,e={}){super(t,16777215),this.setDefaults(e),this.initStyle(e),m.registerObject(this),this.bindParent(e),this.mM.play()}set fontsize(t){var e=this.getTextFormat();e.size=t,this.setTextFormat(e)}get fontsize(){return this.getTextFormat().fontsize}set font(t){var e=this.getTextFormat();e.font=t,this.setTextFormat(e)}get font(){return this.getTextFormat().font}set align(t){var e=this.getTextFormat();e.align=t,this.setTextFormat(e)}get align(){return this.getTextFormat().align}set bold(t){var e=this.getTextFormat();e.bold=t,this.setTextFormat(e)}get bold(){return this.getTextFormat().bold}get motionManager(){return this.mM}set motionManager(t){u("IComment.motionManager is read-only","warn")}bindParent(t){t.hasOwnProperty("parent")&&t.parent?.addChild(this)}initStyle(t={}){"lifeTime"in t&&(this.mM.dur=t.lifeTime*1e3),"fontsize"in t&&(this.getTextFormat().size=t.fontsize),"font"in t&&(this.getTextFormat().font=t.font),"color"in t&&(this.getTextFormat().color=t.color),"bold"in t&&(this.getTextFormat().bold=t.bold),t.hasOwnProperty("motionGroup")?this.mM.initTweenGroup(t.motionGroup||[],this.mM.dur):t.hasOwnProperty("motion")&&this.mM.initTween(t.motion,!1)}};a(mt,"CommentField");function ce(r,t){return new mt(r,t)}a(ce,"createComment");function me(){return new mt("",{})}a(me,"createTextField");var et=class extends P{_graphics;constructor(){super(),this._graphics=new U(this)}get graphics(){return this._graphics}serialize(){var t=super.serialize();return t.class="Shape",t}};a(et,"Shape");var Et=class extends et{_mM=new T(this);constructor(t){super(),this.setDefaults(t),this.initStyle(t),m.registerObject(this),this.bindParent(t),this._mM.play()}get motionManager(){return this._mM}set motionManager(t){u("IComment.motionManager is read-only","warn")}bindParent(t){t.hasOwnProperty("parent")&&t.parent?.addChild(this)}initStyle(t={}){t.lifeTime&&(this._mM.dur=t.lifeTime*1e3),t.hasOwnProperty("motionGroup")?this._mM.initTweenGroup(t.motionGroup||[],this._mM.dur):t.hasOwnProperty("motion")&&this._mM.initTween(t.motion,!1)}};a(Et,"CommentShape");function pe(r){return new Et(r)}a(pe,"createShape");var N=class{serialize(){return{class:"Filter",type:"nullfilter"}}};a(N,"Filter");var Ft=class extends N{constructor(e=4,i=4){super();this.blurX=e;this.blurY=i}serialize(){let e=super.serialize();return e.type="blur",e.params={blurX:this.blurX,blurY:this.blurY},e}};a(Ft,"BlurFilter");var Bt=class extends N{constructor(e=16711680,i=1,n=6,s=6,h=2,c,d=!1,p=!1){super();this.color=e;this.alpha=i;this.blurX=n;this.blurY=s;this.strength=h;this.quality=c;this.inner=d;this.knockout=p}serialize(){let e=super.serialize();return e.type="glow",e.params={color:this.color,alpha:this.alpha,blurX:this.blurX,blurY:this.blurY,strength:this.strength,inner:this.inner,knockout:this.knockout},e}};a(Bt,"GlowFilter");var St=class extends N{constructor(e=4,i=45,n=0,s=1,h=4,c=4,d=1,p=1){super();this.distance=e;this.angle=i;this.color=n;this.alpha=s;this.blurX=h;this.blurY=c;this.strength=d;this.quality=p}inner=!1;knockout=!1;serialize(){let e=super.serialize();return e.type="dropShadow",e.params={distance:this.distance,angle:this.angle,color:this.color,blurY:this.blurY,strength:this.strength,inner:this.inner,knockout:this.knockout},e}};a(St,"DropShadowFilter");var kt=class extends N{constructor(e=0,i=0,n,s=1,h=0,c=!0,d=!0,p=0,v=0){super();this.matrixX=e;this.matrixY=i;this.matrix=n;this.divisor=s;this.bias=h;this.preserveAlpha=c;this.clamp=d;this.color=p;this.alpha=v}serialize(){let e=super.serialize();return e.type="convolution",e.matrix={x:this.matrixX,y:this.matrixY,data:this.matrix},e.divisor=this.divisor,e.preserveAlpha=this.preserveAlpha,e.clamp=this.clamp,e.color=this.color,e.alpha=this.alpha,e}};a(kt,"ConvolutionFilter");function de(r=4,t=45,e=0,i=1,n=4,s=4,h=1,c=1){return new St(r,t,e,i,n,s,h,c)}a(de,"createDropShadowFilter");function fe(r=16711680,t=1,e=6,i=6,n=2,s,h=!1,c=!1){return new Bt(r,t,e,i,n,s,h,c)}a(fe,"createGlowFilter");function be(r=6,t=6,e=2){return new Ft(r,t)}a(be,"createBlurFilter");function ge(){throw new Error("Display.createBevelFilter not implemented")}a(ge,"createBevelFilter");function _e(r=0,t=0,e,i=1,n=0,s=!0,h=!0,c=0,d=0){return new kt(r,t,e,i,n,s,h,c,d)}a(_e,"createConvolutionFilter");function xe(){throw new Error("Display.createDisplacementMapFilter not implemented")}a(xe,"createDisplacementMapFilter");function ye(){throw new Error("Display.createGradientBevelFilter not implemented")}a(ye,"createGradientBevelFilter");function we(){throw new Error("Display.createGradientGlowFilter not implemented")}a(we,"createGradientGlowFilter");function Me(){throw new Error("Display.createColorMatrixFilter not implemented")}a(Me,"createColorMatrixFilter");var l=class{static get stage(){return this.root}static get frameRate(){return this._frameRate}static set frameRate(t){this._frameRate=t,g("Display:SetFrameRate",t)}static toString(){return"[display Display]"}};a(l,"Display"),o(l,"Point",y),o(l,"Matrix",I),o(l,"Matrix3D",C),o(l,"Vector3D",O),o(l,"createMatrix",Jt),o(l,"createMatrix3D",\$t),o(l,"createGradientBox",te),o(l,"createVector3D",ee),o(l,"projectVector",re),o(l,"projectVectors",ie),o(l,"createPoint",xt),o(l,"toIntVector",ne),o(l,"toNumberVector",se),o(l,"ColorTransform",Y),o(l,"createColorTransform",ae),o(l,"PerspectiveProjection",X),o(l,"Transform",L),o(l,"Filter",N),o(l,"createDropShadowFilter",de),o(l,"createGlowFilter",fe),o(l,"createBlurFilter",be),o(l,"createBevelFilter",ge),o(l,"createConvolutionFilter",_e),o(l,"createDisplacementMapFilter",xe),o(l,"createGradientBevelFilter",ye),o(l,"createGradientGlowFilter",we),o(l,"createColorMatrixFilter",Me),o(l,"BlendMode",At),o(l,"Rectangle",w),o(l,"DisplayObject",P),o(l,"Graphics",U),o(l,"Sprite",G),o(l,"RootSprite",at),o(l,"UIComponent",\$),o(l,"ByteArray",S),o(l,"Bitmap",Q),o(l,"BitmapData",H),o(l,"MotionManager",T),o(l,"createButton",he),o(l,"createCanvas",ue),o(l,"Shape",et),o(l,"createShape",pe),o(l,"TextField",tt),o(l,"createTextFormat",le),o(l,"createComment",ce),o(l,"createTextField",me),o(l,"createBitmap",Lt),o(l,"createParticle",Ut),o(l,"createBitmapData",Gt),o(l,"root",new at),o(l,"loaderInfo"),o(l,"version",""),o(l,"width",0),o(l,"height",0),o(l,"fullScreenWidth",0),o(l,"fullScreenHeight",0),o(l,"_frameRate",24);D("Update:DimensionUpdate",r=>{l.width=r.stageWidth,l.height=r.stageHeight,r.hasOwnProperty("screenWidth")&&r.hasOwnProperty("screenHeight")&&(l.fullScreenWidth=r.screenWidth,l.fullScreenHeight=r.screenHeight)});var pt=class{},z=pt;a(z,"Global"),o(z,"_store",{}),o(z,"_set",(t,e)=>{pt._store[t]=e}),o(z,"_get",t=>pt._store[t]),o(z,"_",t=>pt._get(t));function Te(r){typeof r=="object"?u(JSON.stringify(r),"log"):u(r,"log")}a(Te,"trace");function ve(r,t){typeof t=="function"&&t()}a(ve,"load");function Oe(r){if(r===null||typeof r!="object")return r;if(typeof r.clone=="function")return r.clone();if(Array.isArray(r))return r.slice(0);let t={};t.constructor=t.constructor,t.prototype=t.prototype;for(let e in r)t[e]=r[e];return t}a(Oe,"clone");function Pe(r,t){if(!(r===null||typeof r!="object")&&!(r instanceof l.DisplayObject))for(let e in r)r.hasOwnProperty(e)&&t(e,r[e])}a(Pe,"foreach");function Ce(){throw new Error("stopExecution")}a(Ce,"stopExecution");function Ie(r){let t=[],e=r.split(""),i=!1,n=!1;return e.forEach((s,h,c)=>{switch(s){case"/":{if(!t.length&&c[h+1]&&c[h+1]==="*"&&(n=!0),!t.length&&c[h+1]&&c[h+1]==="/"&&(i=!0),c[h-1]==="\\\\")break;c[h+1]&&c[h+1]==="n"&&(c[h]="",c[h+1]=t.length?"\\\\n":\`
\`);break}case"*":{n&&c[h+1]&&c[h+1]==="/"&&(n=!1);break}case\`
\`:{if(n)break;if(i){i=!1;break}t.length&&(c[h]="\\\\n");break}case'"':{if(n||i||c[h-1]==="\\\\")break;t.length&&t[0]===s?t.shift():t.unshift('"');break}case"'":{if(n||i||c[h-1]==="\\\\")break;if(t.length&&t[0]===s)t.shift();else{if(c[h-1]&&/[A-Za-z]/.test(c[h-1])&&c[h+1]&&/[A-Za-z]/.test(c[h+1]))break;t.unshift("'")}break}default:break}}),e.join("")}a(Ie,"wrap");nt.createChannel("::eval",1,Math.round(Math.random()*1e5));nt.createChannel("::debug",1,Math.round(Math.random()*1e5));Object.defineProperties(self,{Runtime:{value:m},Display:{value:l},\$:{value:l},Player:{value:f},Tween:{value:b},TweenEasing:{value:k},Utils:{value:x},Global:{value:z},\$G:{value:z},Bitmap:{value:J},trace:{value:Te},load:{value:ve},clone:{value:Oe},foreach:{value:Pe},stopExecution:{value:Ce},ScriptManager:{value:q},getTimer:{value:x.getTimer.bind(x)},interval:{value:x.interval.bind(x)},timer:{value:x.timer.bind(x)},clearTimeout:{value:x.clearTimeout.bind(x)},clearInterval:{value:x.clearInterval.bind(x)},none:{value:null},ture:{value:!0},Arial:{value:"Arial"},ph:{get:()=>f.height,set:r=>f.height=r},pw:{get:()=>f.width,set:r=>f.width=r}});D("::eval",function(r){try{(0,eval)(\`let importScripts,postMessage,addEventListener,self;
\`+Ie(r).replace(/(&amp;)|(&lt;)|(&gt;)|(&apos;)|(&quot;)/g,t=>({"&amp;":"&","&lt;":"<","&gt;":">","&apos;":"'","&quot;":'"'})[t]))}catch(t){if(t.message==="stopExecution")return;throw t}});D("::debug",function(r){if(typeof r>"u"||r===null||!r.hasOwnProperty("action")){R("::worker:debug","worker","Malformed request");return}if(r.action==="list-channels")R("::worker:debug","worker",nt.listChannels());else if(r.action==="raw-eval")try{R("::worker:debug","worker",(0,eval)(r.code))}catch(t){R("::worker:debug","worker","Error: "+t)}else R("::worker:debug","worker","Unrecognized action")});R("::worker:state","worker","running");})();
`, "Worker", undefined, undefined);
}
